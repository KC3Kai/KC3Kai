var PS={};!function(n){"use strict";n.arrayMap=function(n){return function(e){for(var t=e.length,r=new Array(t),u=0;t>u;u++)r[u]=n(e[u]);return r}},n.arrayBind=function(n){return function(e){for(var t=[],r=0,u=n.length;u>r;r++)Array.prototype.push.apply(t,e(n[r]));return t}},n.concatArray=function(n){return function(e){return n.concat(e)}},n.intAdd=function(n){return function(e){return n+e|0}},n.intMul=function(n){return function(e){return n*e|0}},n.numAdd=function(n){return function(e){return n+e}},n.numMul=function(n){return function(e){return n*e}},n.refEq=function(n){return function(e){return n===e}},n.unsafeCompareImpl=function(n){return function(e){return function(t){return function(r){return function(u){return u>r?n:r>u?t:e}}}}},n.topInt=2147483647,n.bottomInt=-2147483648,n.boolOr=function(n){return function(e){return n||e}},n.boolAnd=function(n){return function(e){return n&&e}},n.boolNot=function(n){return!n},n.showIntImpl=function(n){return n.toString()},n.showNumberImpl=function(n){return n===(0|n)?n+".0":n.toString()},n.showArrayImpl=function(n){return function(e){for(var t=[],r=0,u=e.length;u>r;r++)t[r]=n(e[r]);return"["+t.join(",")+"]"}}}(PS.Prelude=PS.Prelude||{}),function(n){"use strict";var e=PS.Prelude,t=function(){function n(){}return n.value=new n,n}(),r=function(){function n(){}return n.value=new n,n}(),u=function(){function n(){}return n.value=new n,n}(),a=function(n){this.compose=n},o=function(n,e){this["__superclass_Prelude.Semigroupoid_0"]=n,this.id=e},i=function(n){this.map=n},l=function(n,e){this["__superclass_Prelude.Functor_0"]=n,this.apply=e},c=function(n,e){this["__superclass_Prelude.Apply_0"]=n,this.pure=e},f=function(n,e){this["__superclass_Prelude.Apply_0"]=n,this.bind=e},s=function(n,e){this["__superclass_Prelude.Applicative_0"]=n,this["__superclass_Prelude.Bind_1"]=e},v=function(n){this.append=n},m=function(n,e,t,r){this.add=n,this.mul=e,this.one=t,this.zero=r},p=function(n){this.eq=n},d=function(n,e){this["__superclass_Prelude.Eq_0"]=n,this.compare=e},S=function(n,e){this.bottom=n,this.top=e},h=function(n,e,t,r){this["__superclass_Prelude.Bounded_0"]=n,this.conj=e,this.disj=t,this.not=r},y=function(n){this.show=n},P=function(n){return n.zero},g=e.unsafeCompareImpl(t.value)(u.value)(r.value),w={},C=function(n){return n.top},D=new y(e.showNumberImpl),b=new y(e.showIntImpl),A=function(n){return n.show},E=function(n){return new y(e.showArrayImpl(A(n)))},F=new m(e.numAdd,e.numMul,1,0),M=new m(e.intAdd,e.intMul,1,0),_=new a(function(n){return function(e){return function(t){return n(e(t))}}}),I=new v(e.concatArray),T=function(n){return n.pure},N=function(n){return T(n)},x=!0,K=function(n){return n.one},k=function(n){return n.not},B=function(n){return n.mul},R=function(n){return n.map},L=function(n){return R(n)},V=function(n){return n.id},O=new i(e.arrayMap),U=function(n){return function(e){return function(t){return n(t)(e)}}},J=new p(e.refEq),q=new p(e.refEq),H=new d(function(){return q},g),j=new p(e.refEq),W=new d(function(){return j},g),z=function(n){return n.eq},G=function(n){return z(n)},$=function(n){return n.disj},Q=function(n){return function(e){return n}},X=function(n){return function(e){return L(n)(Q(w))(e)}},Y=function(n){return n.conj},Z=function(n){return n.compose},nn=function(n){return n.compare},en=function(n){return function(e){return function(r){var u=nn(n)(e)(r);return u instanceof t?!0:!1}}},tn=function(n){return function(e){return function(r){var u=nn(n)(e)(r);return u instanceof t?!1:!0}}},rn=new o(function(){return _},function(n){return n}),un=new S(e.bottomInt,e.topInt),an=new S(!1,!0),on=function(n){return n.bottom},ln=new h(function(){return an},e.boolAnd,e.boolOr,e.boolNot),cn=function(n){return n.bind},fn=function(n){return n.apply},sn=function(n){return fn(n)},vn=function(n){return function(e){return function(t){return sn(n["__superclass_Prelude.Apply_0"]())(T(n)(e))(t)}}},mn=function(n){return n.append},pn=function(n){return mn(n)},dn=function(n){return mn(n)},Sn=function(n){return function(e){return function(t){return cn(n["__superclass_Prelude.Bind_1"]())(e)(function(e){return cn(n["__superclass_Prelude.Bind_1"]())(t)(function(t){return N(n["__superclass_Prelude.Applicative_0"]())(e(t))})})}}},hn=new s(function(){return gn},function(){return yn}),yn=new f(function(){return Pn},e.arrayBind),Pn=new l(function(){return O},Sn(hn)),gn=new c(function(){return Pn},function(n){return[n]}),wn=function(n){return n.add},Cn=function(n){return wn(n)};n.LT=t,n.GT=r,n.EQ=u,n.Show=y,n.BooleanAlgebra=h,n.Bounded=S,n.Ord=d,n.Eq=p,n.Semiring=m,n.Semigroup=v,n.Monad=s,n.Bind=f,n.Applicative=c,n.Apply=l,n.Functor=i,n.Category=o,n.Semigroupoid=a,n.show=A,n.not=k,n.disj=$,n.conj=Y,n.bottom=on,n.top=C,n.unsafeCompare=g,n[">="]=tn,n["<"]=en,n.compare=nn,n["=="]=G,n.eq=z,n["+"]=Cn,n.one=K,n.mul=B,n.zero=P,n.add=wn,n["++"]=pn,n["<>"]=dn,n.append=mn,n.ap=Sn,n["return"]=N,n.bind=cn,n.liftA1=vn,n.pure=T,n["<*>"]=sn,n.apply=fn,n["void"]=X,n["<$>"]=L,n.map=R,n.id=V,n.compose=Z,n.otherwise=x,n["const"]=Q,n.flip=U,n.unit=w,n.semigroupoidFn=_,n.categoryFn=rn,n.functorArray=O,n.applyArray=Pn,n.applicativeArray=gn,n.bindArray=yn,n.monadArray=hn,n.semigroupArray=I,n.semiringInt=M,n.semiringNumber=F,n.eqInt=j,n.eqNumber=q,n.eqString=J,n.ordInt=W,n.ordNumber=H,n.boundedBoolean=an,n.boundedInt=un,n.booleanAlgebraBoolean=ln,n.showInt=b,n.showNumber=D,n.showArray=E}(PS.Prelude=PS.Prelude||{}),function(n){"use strict";var e=(PS.Prelude,function(n,e){this["__superclass_Prelude.Functor_0"]=n,this.alt=e}),t=function(n){return n.alt};n.Alt=e,n.alt=t}(PS["Control.Alt"]=PS["Control.Alt"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Control.Alt"],function(n,e){this["__superclass_Control.Alt.Alt_0"]=n,this.empty=e}),t=function(n){return n.empty};n.Plus=e,n.empty=t}(PS["Control.Plus"]=PS["Control.Plus"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Control.Plus"],function(n,e){this["__superclass_Control.Plus.Plus_1"]=n,this["__superclass_Prelude.Applicative_0"]=e});n.Alternative=e}(PS["Control.Alternative"]=PS["Control.Alternative"]||{}),function(n){"use strict";var e=PS.Prelude,t=function(n){return function(t){return function(r){return e["<*>"](n)(e["<$>"](n["__superclass_Prelude.Functor_0"]())(e["const"](e.id(e.categoryFn)))(t))(r)}}};n["*>"]=t}(PS["Control.Apply"]=PS["Control.Apply"]||{}),function(n){"use strict";n.returnE=function(n){return function(){return n}},n.bindE=function(n){return function(e){return function(){return e(n())()}}},n.runPure=function(n){return n()}}(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff"],t=PS.Prelude,r=new t.Monad(function(){return o},function(){return u}),u=new t.Bind(function(){return a},e.bindE),a=new t.Apply(function(){return i},t.ap(r)),o=new t.Applicative(function(){return a},e.returnE),i=new t.Functor(t.liftA1(o));n.functorEff=i,n.applyEff=a,n.applicativeEff=o,n.bindEff=u,n.monadEff=r,n.runPure=e.runPure}(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{}),function(n){"use strict";n.log=function(n){return function(){return console.log(n),{}}}}(PS["Control.Monad.Eff.Console"]=PS["Control.Monad.Eff.Console"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff.Console"];PS.Prelude,PS["Control.Monad.Eff"];n.log=e.log}(PS["Control.Monad.Eff.Console"]=PS["Control.Monad.Eff.Console"]||{}),function(n){"use strict";n.catchException=function(n){return function(e){return function(){try{return e()}catch(t){return t instanceof Error||"[object Error]"===Object.prototype.toString.call(t)?n(t)():n(new Error(t.toString()))()}}}}}(PS["Control.Monad.Eff.Exception"]=PS["Control.Monad.Eff.Exception"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Alternative"],PS["Control.Plus"]),r=function(n,e){this["__superclass_Control.Alternative.Alternative_1"]=n,this["__superclass_Prelude.Monad_0"]=e},u=function(n){return function(r){if(r)return e["return"](n["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Prelude.Applicative_0"]())(e.unit);if(!r)return t.empty(n["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Control.Plus.Plus_1"]());throw new Error("Failed pattern match at Control.MonadPlus line 36, column 1 - line 37, column 1: "+[r.constructor.name])}};n.MonadPlus=r,n.guard=u}(PS["Control.MonadPlus"]=PS["Control.MonadPlus"]||{}),function(n){"use strict";var e=PS.Prelude,t=function(n,e){this["__superclass_Prelude.Semigroup_0"]=n,this.mempty=e},r=new t(function(){return e.semigroupArray},[]),u=function(n){return n.mempty};n.Monoid=t,n.mempty=u,n.monoidArray=r}(PS["Data.Monoid"]=PS["Data.Monoid"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Control.Alt"],r=PS["Control.Alternative"],u=(PS["Control.Extend"],PS["Control.MonadPlus"]),a=PS["Control.Plus"],o=(PS["Data.Functor.Invariant"],PS["Data.Monoid"],function(){function n(){}return n.value=new n,n}()),i=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),l=function(n){return function(e){return function(t){if(t instanceof o)return n;if(t instanceof i)return e(t.value0);throw new Error("Failed pattern match at Data.Maybe line 27, column 1 - line 28, column 1: "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},c=l(!0)(e["const"](!1)),f=l(!1)(e["const"](!0)),s=new e.Functor(function(n){return function(e){return e instanceof i?new i(n(e.value0)):o.value}}),v=function(n){return l(n)(e.id(e.categoryFn))},m=new e.Apply(function(){return s},function(n){return function(t){if(n instanceof i)return e["<$>"](s)(n.value0)(t);if(n instanceof o)return o.value;throw new Error("Failed pattern match at Data.Maybe line 122, column 3 - line 123, column 3: "+[n.constructor.name,t.constructor.name])}}),p=new e.Bind(function(){return m},function(n){return function(e){if(n instanceof i)return e(n.value0);if(n instanceof o)return o.value;throw new Error("Failed pattern match at Data.Maybe line 181, column 3 - line 182, column 3: "+[n.constructor.name,e.constructor.name])}}),d=new e.Applicative(function(){return m},i.create),S=new e.Monad(function(){return d},function(){return p}),h=new t.Alt(function(){return s},function(n){return function(e){return n instanceof o?e:n}}),y=new a.Plus(function(){return h},o.value),P=new r.Alternative(function(){return y},function(){return d}),g=new u.MonadPlus(function(){return P},function(){return S});n.Nothing=o,n.Just=i,n.isNothing=c,n.isJust=f,n.fromMaybe=v,n.maybe=l,n.functorMaybe=s,n.applyMaybe=m,n.applicativeMaybe=d,n.altMaybe=h,n.plusMaybe=y,n.alternativeMaybe=P,n.bindMaybe=p,n.monadMaybe=S,n.monadPlusMaybe=g}(PS["Data.Maybe"]=PS["Data.Maybe"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff.Exception"];PS.Prelude,PS["Data.Maybe"],PS["Control.Monad.Eff"];n.catchException=e.catchException}(PS["Control.Monad.Eff.Exception"]=PS["Control.Monad.Eff.Exception"]||{}),function(n){"use strict";n.newSTRef=function(n){return function(){return{value:n}}},n.readSTRef=function(n){return function(){return n.value}},n.writeSTRef=function(n){return function(e){return function(){return n.value=e}}}}(PS["Control.Monad.ST"]=PS["Control.Monad.ST"]||{}),function(n){"use strict";var e=PS["Control.Monad.ST"];PS.Prelude,PS["Control.Monad.Eff"];n.writeSTRef=e.writeSTRef,n.readSTRef=e.readSTRef,n.newSTRef=e.newSTRef}(PS["Control.Monad.ST"]=PS["Control.Monad.ST"]||{}),function(n){"use strict";n.range=function(n){return function(e){for(var t=n>e?-1:1,r=[],u=n,a=0;u!==e;u+=t)r[a++]=u;return r[a]=u,r}},n.replicate=function(n){return function(e){if(1>n)return[];for(var t=new Array(n),r=0;n>r;r++)t[r]=e;return t}},n.length=function(n){return n.length},n.cons=function(n){return function(e){return[n].concat(e)}},n.snoc=function(n){return function(e){var t=n.slice();return t.push(e),t}},n["uncons'"]=function(n){return function(e){return function(t){return 0===t.length?n({}):e(t[0])(t.slice(1))}}},n.findIndexImpl=function(n){return function(e){return function(t){return function(r){for(var u=0,a=r.length;a>u;u++)if(t(r[u]))return n(u);return e}}}},n.reverse=function(n){return n.slice().reverse()},n.concat=function(n){for(var e=[],t=0,r=n.length;r>t;t++)for(var u=n[t],a=0,o=u.length;o>a;a++)e.push(u[a]);return e},n.filter=function(n){return function(e){return e.filter(n)}},n.sortImpl=function(n){return function(e){return e.slice().sort(function(e,t){return n(e)(t)})}},n.slice=function(n){return function(e){return function(t){return t.slice(n,e)}}},n.zipWith=function(n){return function(e){return function(t){for(var r=e.length<t.length?e.length:t.length,u=new Array(r),a=0;r>a;a++)u[a]=n(e[a])(t[a]);return u}}}}(PS["Data.Array"]=PS["Data.Array"]||{}),function(n){"use strict";n.foldrArray=function(n){return function(e){return function(t){for(var r=e,u=t.length,a=u-1;a>=0;a--)r=n(t[a])(r);return r}}},n.foldlArray=function(n){return function(e){return function(t){for(var r=e,u=t.length,a=0;u>a;a++)r=n(r)(t[a]);return r}}}}(PS["Data.Foldable"]=PS["Data.Foldable"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Comonad"],PS["Control.Extend"],PS["Data.Monoid"]),r=function(n){return n},u=function(n){return new e.Semigroup(function(t){return function(r){return e.conj(n)(t)(r)}})},a=function(n){return n},o=function(n){return new t.Monoid(function(){return u(n)},e.top(n["__superclass_Prelude.Bounded_0"]()))};n.Conj=r,n.runConj=a,n.semigroupConj=u,n.monoidConj=o}(PS["Data.Monoid.Conj"]=PS["Data.Monoid.Conj"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Comonad"],PS["Control.Extend"],PS["Data.Monoid"]),r=function(n){return n},u=function(n){return new e.Semigroup(function(t){return function(r){return e.disj(n)(t)(r)}})},a=function(n){return n},o=function(n){return new t.Monoid(function(){return u(n)},e.bottom(n["__superclass_Prelude.Bounded_0"]()))};n.Disj=r,n.runDisj=a,n.semigroupDisj=u,n.monoidDisj=o}(PS["Data.Monoid.Disj"]=PS["Data.Monoid.Disj"]||{}),function(n){"use strict";var e=PS["Data.Foldable"],t=PS.Prelude,r=PS["Control.Apply"],u=(PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Maybe.Last"],PS["Data.Monoid"]),a=(PS["Data.Monoid.Additive"],PS["Data.Monoid.Conj"]),o=PS["Data.Monoid.Disj"],i=(PS["Data.Monoid.Dual"],PS["Data.Monoid.Endo"],PS["Data.Monoid.Multiplicative"],function(n,e,t){this.foldMap=n,this.foldl=e,this.foldr=t}),l=function(n){return n.foldr},c=function(n){return function(e){return function(u){return l(e)(function(e){return r["*>"](n["__superclass_Prelude.Apply_0"]())(u(e))})(t.pure(n)(t.unit))}}},f=function(n){return function(e){return t.flip(c(n)(e))}},s=function(n){return n.foldl},v=function(n){return function(e){return s(n)(t["+"](e))(t.zero(e))}},m=function(n){return function(e){return function(r){return function(a){return l(n)(function(n){return function(u){return t["<>"](e["__superclass_Prelude.Semigroup_0"]())(r(n))(u)}})(u.mempty(e))(a)}}}},p=new i(function(n){return m(p)(n)},e.foldlArray,e.foldrArray),d=function(n){return n.foldMap},S=function(n){return function(e){return function(t){return function(r){return o.runDisj(d(n)(o.monoidDisj(e))(function(n){return o.Disj(t(n))})(r))}}}},h=function(n){return function(e){return function(t){return function(r){return a.runConj(d(n)(a.monoidConj(e))(function(n){return a.Conj(t(n))})(r))}}}};n.Foldable=i,n.sum=v,n.all=h,n.any=S,n.for_=f,n.traverse_=c,n.foldMapDefaultR=m,n.foldMap=d,n.foldl=s,n.foldr=l,n.foldableArray=p}(PS["Data.Foldable"]=PS["Data.Foldable"]||{}),function(n){"use strict";n.traverseArrayImpl=function(){function n(n){this.fn=n}function e(n){return function(e){return new u(n,e)}}function t(n){for(var e=[];n!==r;)e.push(n.head),n=n.tail;return e}var r={},u=function(n,e){this.head=n,this.tail=e};return function(u){return function(a){return function(o){return function(i){var l=function(n,t){return u(a(e)(i(n)))(t)},c=function(e,t,r){if(0===t)return e;var u=r[t-1];return new n(function(){return c(l(u,e),t-1,r)})};return function(e){for(var u=c(o(r),e.length,e);u instanceof n;)u=u.fn();return a(t)(u)}}}}}}()}(PS["Data.Traversable"]=PS["Data.Traversable"]||{}),function(n){"use strict";var e=PS["Data.Traversable"],t=PS.Prelude,r=PS["Data.Foldable"],u=(PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Maybe.Last"],PS["Data.Monoid.Additive"],PS["Data.Monoid.Conj"],PS["Data.Monoid.Disj"],PS["Data.Monoid.Dual"],PS["Data.Monoid.Multiplicative"],function(n,e,t,r){this["__superclass_Data.Foldable.Foldable_1"]=n,this["__superclass_Prelude.Functor_0"]=e,this.sequence=t,this.traverse=r}),a=function(n){return n.traverse},o=function(n){return function(e){return function(r){return a(n)(e)(t.id(t.categoryFn))(r)}}},i=new u(function(){return r.foldableArray},function(){return t.functorArray},function(n){return o(i)(n)},function(n){return e.traverseArrayImpl(t.apply(n["__superclass_Prelude.Apply_0"]()))(t.map(n["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(t.pure(n))}),l=function(n){return n.sequence};n.Traversable=u,n.sequenceDefault=o,n.sequence=l,n.traverse=a,n.traversableArray=i}(PS["Data.Traversable"]=PS["Data.Traversable"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Control.Biapplicative"],PS["Control.Biapply"],PS["Control.Comonad"],PS["Control.Extend"],PS["Control.Lazy"],PS["Data.Bifoldable"],PS["Data.Bifunctor"],PS["Data.Bitraversable"],PS["Data.Foldable"],PS["Data.Functor.Invariant"],PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Monoid"],PS["Data.Traversable"],function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}()),t=function(n){return function(e){return n(e.value0)(e.value1)}},r=function(n){return n.value1},u=function(n){return n.value0};n.Tuple=e,n.uncurry=t,n.snd=r,n.fst=u}(PS["Data.Tuple"]=PS["Data.Tuple"]||{}),function(n){"use strict";n.unsafeThrow=function(n){throw new Error(n)}}(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{}),function(n){"use strict";var e=PS["Data.Maybe.Unsafe"],t=(PS.Prelude,PS["Data.Maybe"]),r=function(n){if(n instanceof t.Just)return n.value0;if(n instanceof t.Nothing)return e.unsafeThrow("Data.Maybe.Unsafe.fromJust called on Nothing");throw new Error("Failed pattern match at Data.Maybe.Unsafe line 11, column 1 - line 12, column 1: "+[n.constructor.name])};n.fromJust=r,n.unsafeThrow=e.unsafeThrow}(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{}),function(n){"use strict";var e=PS["Data.Array"],t=PS.Prelude,r=(PS["Control.Alt"],PS["Control.Alternative"],PS["Control.Lazy"],PS["Control.MonadPlus"],PS["Control.Plus"],PS["Data.Foldable"],PS["Data.Functor.Invariant"],PS["Data.Maybe"]),u=(PS["Data.Monoid"],PS["Data.Traversable"]),a=(PS["Data.Tuple"],PS["Data.Maybe.Unsafe"],e.cons),o=e.range,i=function(n){return function(t){return function(r){return function(a){return u.sequence(u.traversableArray)(n)(e.zipWith(t)(r)(a))}}}},l=e["uncons'"](t["const"](r.Nothing.value))(function(n){return function(e){return new r.Just({head:n,tail:e})}}),c=e.slice(0),f=e["uncons'"](t["const"](r.Nothing.value))(function(n){return function(n){return new r.Just(n)}}),s=function(n){var t=function(t){return function(u){for(var o=t,i=u;;){var c=l(i);{if(!(c instanceof r.Just&&n(c.value0.head)))return{init:e.reverse(o),rest:i};var f=a(c.value0.head)(o);o=f,i=c.value0.tail}}}};return t([])},v=function(n){return function(r){var u=function(e){return function(r){var u=n(e)(r);if(u instanceof t.GT)return 1;if(u instanceof t.EQ)return 0;if(u instanceof t.LT)return-1;throw new Error("Failed pattern match at Data.Array line 417, column 15 - line 422, column 1: "+[u.constructor.name])}};return e.sortImpl(u)(r)}},m=function(n){return[n]},p=function(n){return 0===e.length(n)},d=function(n){if(p(n))return r.Nothing.value;if(t.otherwise)return new r.Just(e.slice(0)(e.length(n)-1)(n));throw new Error("Failed pattern match at Data.Array line 228, column 1 - line 245, column 1: "+[n.constructor.name])},S=e["uncons'"](t["const"](r.Nothing.value))(function(n){return function(e){return new r.Just(n)}}),h=function(n){var t=function(t){return function(u){for(var o=t,i=u;;){var c=l(i);{if(!(c instanceof r.Just)){if(c instanceof r.Nothing)return e.reverse(o);throw new Error("Failed pattern match at Data.Array line 488, column 15 - line 494, column 1: "+[c.constructor.name])}var f=s(n(c.value0.head))(c.value0.tail),v=a(a(c.value0.head)(f.init))(o);o=v,i=f.rest}}}};return t([])},y=function(n){return function(e){return h(t.eq(n))(e)}},P=e.findIndexImpl(r.Just.create)(r.Nothing.value),g=function(n){return function(e){return P(function(r){return t["=="](n)(r)(e)})}},w=t.flip(t.bind(t.bindArray)),C=function(n){return w(function(e){return r.maybe([])(m)(n(e))})};n.zipWithA=i,n.groupBy=h,n.group=y,n.span=s,n.take=c,n.sortBy=v,n.mapMaybe=C,n.concatMap=w,n.findIndex=P,n.elemIndex=g,n.uncons=l,n.init=d,n.tail=f,n.head=S,n["null"]=p,n[".."]=o,n.singleton=m,n.zipWith=e.zipWith,n.slice=e.slice,n.filter=e.filter,n.reverse=e.reverse,n.snoc=e.snoc,n.length=e.length,n.replicate=e.replicate}(PS["Data.Array"]=PS["Data.Array"]||{}),function(n){"use strict";n.runSTArray=function(n){return n},n.emptySTArray=function(){return[]},n.pushAllSTArray=function(n){return function(e){return function(){return n.push.apply(n,e)}}},n.copyImpl=function(n){return function(){return n.slice()}}}(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{}),function(n){"use strict";var e=PS["Data.Array.ST"],t=(PS.Prelude,PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Data.Maybe"],e.copyImpl),r=function(n){return function(t){return e.pushAllSTArray(n)([t])}};n.thaw=t,n.pushSTArray=r,n.emptySTArray=e.emptySTArray,n.runSTArray=e.runSTArray}(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{}),function(n){"use strict";n.unsafeIndex=function(n){return function(e){return n[e]}}}(PS["Data.Array.Unsafe"]=PS["Data.Array.Unsafe"]||{}),function(n){"use strict";var e=PS["Data.Array.Unsafe"],t=(PS.Prelude,PS["Data.Array"]),r=function(n){return t.slice(1)(t.length(n))(n)},u=function(n){return e.unsafeIndex(n)(0)};n.tail=r,n.head=u}(PS["Data.Array.Unsafe"]=PS["Data.Array.Unsafe"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Control.Alt"],PS["Control.Extend"],PS["Data.Bifoldable"],PS["Data.Bifunctor"],PS["Data.Bitraversable"],PS["Data.Foldable"],PS["Data.Monoid"],PS["Data.Traversable"],function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}()),r=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),u=new e.Functor(function(n){return function(e){if(e instanceof t)return new t(e.value0);if(e instanceof r)return new r(n(e.value0));throw new Error("Failed pattern match at Data.Either line 53, column 3 - line 54, column 3: "+[n.constructor.name,e.constructor.name])}}),a=new e.Apply(function(){return u},function(n){return function(a){if(n instanceof t)return new t(n.value0);if(n instanceof r)return e["<$>"](u)(n.value0)(a);throw new Error("Failed pattern match at Data.Either line 93, column 3 - line 94, column 3: "+[n.constructor.name,a.constructor.name])}}),o=new e.Applicative(function(){return a},r.create);n.Left=t,n.Right=r,n.functorEither=u,n.applyEither=a,n.applicativeEither=o}(PS["Data.Either"]=PS["Data.Either"]||{}),function(n){"use strict";n.toForeign=function(n){return n},n.unsafeFromForeign=function(n){return n},n.typeOf=function(n){return typeof n},n.isNull=function(n){return null===n},n.isUndefined=function(n){return void 0===n}}(PS["Data.Foreign"]=PS["Data.Foreign"]||{}),function(n){"use strict";n.mkFn3=function(n){return function(e,t,r){return n(e)(t)(r)}},n.mkFn4=function(n){return function(e,t,r,u){return n(e)(t)(r)(u)}},n.mkFn5=function(n){return function(e,t,r,u,a){return n(e)(t)(r)(u)(a)}},n.mkFn6=function(n){return function(e,t,r,u,a,o){return n(e)(t)(r)(u)(a)(o)}},n.mkFn7=function(n){return function(e,t,r,u,a,o,i){return n(e)(t)(r)(u)(a)(o)(i)}},n.runFn4=function(n){return function(e){return function(t){return function(r){return function(u){return n(e,t,r,u)}}}}}}(PS["Data.Function"]=PS["Data.Function"]||{}),function(n){"use strict";var e=PS["Data.Function"],t=(PS.Prelude,function(n){return function(e){return function(t){return function(r){return n(e(t))(e(r))}}}});n.on=t,n.runFn4=e.runFn4,n.mkFn7=e.mkFn7,n.mkFn6=e.mkFn6,n.mkFn5=e.mkFn5,n.mkFn4=e.mkFn4,n.mkFn3=e.mkFn3}(PS["Data.Function"]=PS["Data.Function"]||{}),function(n){"use strict";n.fromNumberImpl=function(n){return function(e){return function(t){return(0|t)===t?n(t):e}}},n.toNumber=function(n){return n},n.fromStringImpl=function(n){return function(e){return function(t){var r=parseFloat(t);return(0|r)===r?n(r):e}}}}(PS["Data.Int"]=PS["Data.Int"]||{}),function(n){"use strict";n.ceil=Math.ceil,n.floor=Math.floor,n.sqrt=Math.sqrt}(PS.Math=PS.Math||{}),function(n){"use strict";var e=PS.Math;n.sqrt=e.sqrt,n.floor=e.floor,n.ceil=e.ceil}(PS.Math=PS.Math||{}),function(n){"use strict";var e=PS["Data.Int"],t=PS.Prelude,r=(PS["Data.Int.Bits"],PS["Data.Maybe"]),u=PS["Data.Maybe.Unsafe"],a=PS.Math,o=e.fromStringImpl(r.Just.create)(r.Nothing.value),i=e.fromNumberImpl(r.Just.create)(r.Nothing.value),l=function(n){if(n>=e.toNumber(t.top(t.boundedInt)))return t.top(t.boundedInt);if(n<=e.toNumber(t.bottom(t.boundedInt)))return t.bottom(t.boundedInt);if(t.otherwise)return u.fromJust(i(n));throw new Error("Failed pattern match at Data.Int line 49, column 1 - line 56, column 1: "+[n.constructor.name])},c=function(n){return l(a.floor(n))},f=function(n){return 0===(1&n)},s=function(n){return l(a.ceil(n))};n.even=f,n.fromString=o,n.floor=c,n.ceil=s,n.fromNumber=i,n.toNumber=e.toNumber}(PS["Data.Int"]=PS["Data.Int"]||{}),function(n){"use strict";n.joinWith=function(n){return function(e){return e.join(n)}}}(PS["Data.String"]=PS["Data.String"]||{}),function(n){"use strict";var e=PS["Data.String"];PS.Prelude,PS["Data.Char"],PS["Data.Maybe"],PS["Data.Monoid"],PS["Data.String.Unsafe"];n.joinWith=e.joinWith}(PS["Data.String"]=PS["Data.String"]||{}),function(n){"use strict";var e=PS["Data.Foreign"],t=(PS.Prelude,PS["Data.Either"],PS["Data.Maybe"],PS["Data.Function"],PS["Data.Int"],PS["Data.Int"],PS["Data.String"],function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}()),r=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}();n.TypeMismatch=t,n.ErrorAtProperty=r,n.isUndefined=e.isUndefined,n.isNull=e.isNull,n.typeOf=e.typeOf,n.unsafeFromForeign=e.unsafeFromForeign,n.toForeign=e.toForeign}(PS["Data.Foreign"]=PS["Data.Foreign"]||{}),function(n){"use strict";n.unsafeReadPropImpl=function(n,e,t,r){return null==r?n:e(r[t])},n.unsafeHasOwnProperty=function(n,e){return Object.prototype.hasOwnProperty.call(e,n)},n.unsafeHasProperty=function(n,e){return n in e}}(PS["Data.Foreign.Index"]=PS["Data.Foreign.Index"]||{}),function(n){"use strict";var e=PS["Data.Foreign.Index"],t=PS.Prelude,r=PS["Data.Either"],u=PS["Data.Foreign"],a=(PS["Data.Function"],PS["Data.Int"],function(n,e,t,r){this.errorAt=n,this.hasOwnProperty=e,this.hasProperty=t,this.ix=r}),o=function(n){return function(a){return e.unsafeReadPropImpl(new r.Left(new u.TypeMismatch("object",u.typeOf(a))),t.pure(r.applicativeEither),n,a)}},i=o,l=function(n){return n.ix},c=function(n){return function(t){return u.isNull(t)?!1:u.isUndefined(t)?!1:"object"===u.typeOf(t)||"function"===u.typeOf(t)?e.unsafeHasProperty(n,t):!1}},f=function(n){return n.hasProperty},s=function(n){return function(t){return u.isNull(t)?!1:u.isUndefined(t)?!1:"object"===u.typeOf(t)||"function"===u.typeOf(t)?e.unsafeHasOwnProperty(n,t):!1}},v=new a(u.ErrorAtProperty.create,s,c,t.flip(i)),m=function(n){return n.hasOwnProperty},p=function(n){return n.errorAt};n.Index=a,n.errorAt=p,n.hasOwnProperty=m,n.hasProperty=f,n.ix=l,n.prop=i,n.indexString=v}(PS["Data.Foreign.Index"]=PS["Data.Foreign.Index"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Data.Maybe"]),t=(PS["Data.Tuple"],PS["Data.Array.ST"]),r=(PS["Data.Traversable"],PS["Control.Monad.Eff"]),u=PS["Control.Monad.ST"],a=function(n){this.unfoldr=n},o=function(n){return n.unfoldr},i=new a(function(n){return function(a){return r.runPure(t.runSTArray(function(){var r=t.emptySTArray(),o=u.newSTRef(a)();return function(){for(;!function(){var a=u.readSTRef(o)(),i=n(a);if(i instanceof e.Nothing)return!0;if(i instanceof e.Just)return t.pushSTArray(r)(i.value0.value0)(),u.writeSTRef(o)(i.value0.value1)(),!1;throw new Error("Failed pattern match at Data.Unfoldable line 35, column 7 - line 41, column 5: "+[i.constructor.name])}(););return{}}(),r}))}});n.Unfoldable=a,n.unfoldr=o,n.unfoldableArray=i}(PS["Data.Unfoldable"]=PS["Data.Unfoldable"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Control.Alt"],r=(PS["Control.Alternative"],PS["Control.Lazy"],PS["Control.MonadPlus"],PS["Control.Plus"]),u=PS["Data.Foldable"],a=PS["Data.Maybe"],o=PS["Data.Monoid"],i=(PS["Data.Traversable"],PS["Data.Tuple"]),l=PS["Data.Unfoldable"],c=function(){function n(){}return n.value=new n,n}(),f=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),s=function(n){if(n instanceof c)return a.Nothing.value;if(n instanceof f)return new a.Just({head:n.value0,tail:n.value1});throw new Error("Failed pattern match at Data.List line 273, column 1 - line 274, column 1: "+[n.constructor.name])},v=function(n){return l.unfoldr(n)(function(n){return e["<$>"](a.functorMaybe)(function(n){return new i.Tuple(n.head,n.tail)})(s(n))})},m=function(n){if(n instanceof c)return a.Nothing.value;if(n instanceof f)return new a.Just(n.value1);throw new Error("Failed pattern match at Data.List line 254, column 1 - line 255, column 1: "+[n.constructor.name])},p=new e.Semigroup(function(n){return function(t){if(n instanceof c)return t;if(n instanceof f)return new f(n.value0,e["<>"](p)(n.value1)(t));throw new Error("Failed pattern match at Data.List line 751, column 3 - line 752, column 3: "+[n.constructor.name,t.constructor.name])}}),d=function(){var n=function(n){return function(e){for(var t=n,r=e;;){if(r instanceof c)return t;{if(!(r instanceof f))throw new Error("Failed pattern match at Data.List line 371, column 1 - line 379, column 1: "+[t.constructor.name,r.constructor.name]);var u=new f(r.value0,t),a=r.value1;t=u,r=a}}}};return n(c.value)}(),S=function(n){if(n instanceof c)return a.Nothing.value;if(n instanceof f)return new a.Just(n.value0);throw new Error("Failed pattern match at Data.List line 239, column 1 - line 240, column 1: "+[n.constructor.name])},h=new e.Functor(function(n){return function(e){var t=function(e){return function(t){for(var r=e,u=t;;){if(r instanceof c)return u;{if(!(r instanceof f))throw new Error("Failed pattern match at Data.List line 758, column 3 - line 764, column 1: "+[r.constructor.name,u.constructor.name]);var a=r.value1,o=new f(n(r.value0),u);r=a,u=o}}}};return d(t(e)(c.value))}}),y=function(n){return v(n)},P=function(n){return u.foldr(n)(f.create)(c.value)},g=function(n){return P(n)},w=new u.Foldable(function(n){return function(t){return u.foldl(w)(function(r){return function(u){return e.append(n["__superclass_Prelude.Semigroup_0"]())(r)(t(u))}})(o.mempty(n))}},function(){var n=function(n){return function(e){return function(t){for(var r=n,u=e,a=t;;){if(a instanceof c)return u;{if(!(a instanceof f))throw new Error("Failed pattern match at Data.List line 767, column 3 - line 771, column 3: "+[r.constructor.name,u.constructor.name,a.constructor.name]);var o=r,i=r(u)(a.value0),l=a.value1;r=o,u=i,a=l}}}}};return n}(),function(n){return function(e){return function(t){if(t instanceof c)return e;if(t instanceof f)return n(t.value0)(u.foldr(w)(n)(e)(t.value1));throw new Error("Failed pattern match at Data.List line 765, column 3 - line 766, column 3: "+[n.constructor.name,e.constructor.name,t.constructor.name])}}}),C=function(n){var t=function(t){return function(r){var u=t,o=r;n:for(;;){if(o instanceof f){if(n(o.value0))return new a.Just(u);if(e.otherwise){var i=u+1|0,l=o.value1;u=i,o=l;continue n}}if(o instanceof c)return a.Nothing.value;throw new Error("Failed pattern match at Data.List line 307, column 3 - line 309, column 3: "+[u.constructor.name,o.constructor.name]);
}}};return t(0)},D=function(n){return function(t){return C(function(r){return e["=="](n)(r)(t)})}},b=function(n){return function(t){if(t instanceof c)return c.value;if(t instanceof f)return e["<>"](p)(n(t.value0))(b(n)(t.value1));throw new Error("Failed pattern match at Data.List line 387, column 1 - line 388, column 1: "+[n.constructor.name,t.constructor.name])}},A=new e.Apply(function(){return h},function(n){return function(t){if(n instanceof c)return c.value;if(n instanceof f)return e["<>"](p)(e["<$>"](h)(n.value0)(t))(e["<*>"](A)(n.value1)(t));throw new Error("Failed pattern match at Data.List line 788, column 3 - line 789, column 3: "+[n.constructor.name,t.constructor.name])}}),E=new e.Bind(function(){return A},e.flip(b)),F=new e.Applicative(function(){return A},function(n){return new f(n,c.value)}),M=new t.Alt(function(){return h},e.append(p)),_=new r.Plus(function(){return M},c.value);n.Nil=c,n.Cons=f,n.fromList=y,n.toList=g,n.concatMap=b,n.reverse=d,n.findIndex=C,n.elemIndex=D,n.uncons=s,n.tail=m,n.head=S,n.fromFoldable=P,n.toUnfoldable=v,n.semigroupList=p,n.functorList=h,n.foldableList=w,n.applyList=A,n.applicativeList=F,n.bindList=E,n.altList=M,n.plusList=_}(PS["Data.List"]=PS["Data.List"]||{}),function(n){"use strict";n.unsafeThrow=function(n){throw new Error(n)}}(PS["Data.List.Unsafe"]=PS["Data.List.Unsafe"]||{}),function(n){"use strict";var e=PS["Data.List.Unsafe"],t=(PS.Prelude,PS["Data.List"]),r=function(n){if(n instanceof t.Cons)return n.value0;if(n instanceof t.Nil)return e.unsafeThrow("Data.List.Unsafe.head called on empty list");throw new Error("Failed pattern match at Data.List.Unsafe line 20, column 1 - line 21, column 1: "+[n.constructor.name])};n.head=r}(PS["Data.List.Unsafe"]=PS["Data.List.Unsafe"]||{}),function(n){"use strict";var e=PS.Prelude,t=(PS["Data.Foldable"],PS["Data.List"]),r=(PS["Data.Maybe"],PS["Data.Maybe.Unsafe"]),u=(PS["Data.Monoid"],PS["Data.Traversable"],PS["Data.Tuple"],function(){function n(){}return n.value=new n,n}()),a=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),o=function(){function n(n,e,t,r,u,a,o){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=a,this.value6=o}return n.create=function(e){return function(t){return function(r){return function(u){return function(a){return function(o){return function(i){return new n(e,t,r,u,a,o,i)}}}}}}},n}(),i=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),l=function(){function n(n,e,t){this.value0=n,this.value1=e,this.value2=t}return n.create=function(e){return function(t){return function(r){return new n(e,t,r)}}},n}(),c=function(){function n(n,e,t,r,u,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=a}return n.create=function(e){return function(t){return function(r){return function(u){return function(a){return function(o){return new n(e,t,r,u,a,o)}}}}}},n}(),f=function(){function n(n,e,t,r,u,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=a}return n.create=function(e){return function(t){return function(r){return function(u){return function(a){return function(o){return new n(e,t,r,u,a,o)}}}}}},n}(),s=function(){function n(n,e,t,r,u,a){this.value0=n,this.value1=e,this.value2=t,this.value3=r,this.value4=u,this.value5=a}return n.create=function(e){return function(t){return function(r){return function(u){return function(a){return function(o){return new n(e,t,r,u,a,o)}}}}}},n}(),v=function(){function n(n,e,t,r){this.value0=n,this.value1=e,this.value2=t,this.value3=r}return n.create=function(e){return function(t){return function(r){return function(u){return new n(e,t,r,u)}}}},n}(),m=function(n){if(n instanceof u)return t.Nil.value;if(n instanceof a)return e["++"](t.semigroupList)(m(n.value0))(e["++"](t.semigroupList)(e.pure(t.applicativeList)(n.value1))(m(n.value3)));if(n instanceof o)return e["++"](t.semigroupList)(m(n.value0))(e["++"](t.semigroupList)(e.pure(t.applicativeList)(n.value1))(e["++"](t.semigroupList)(m(n.value3))(e["++"](t.semigroupList)(e.pure(t.applicativeList)(n.value4))(m(n.value6)))));throw new Error("Failed pattern match at Data.Map line 305, column 1 - line 306, column 1: "+[n.constructor.name])},p=function(n){return function(e){return function(r){var u=n,v=e,m=r;n:for(;;){if(v instanceof t.Nil)return m;if(v instanceof t.Cons){if(v.value0 instanceof i){var p=u,d=v.value1,S=new a(m,v.value0.value0,v.value0.value1,v.value0.value2);u=p,v=d,m=S;continue n}if(v.value0 instanceof l){var p=u,d=v.value1,S=new a(v.value0.value0,v.value0.value1,v.value0.value2,m);u=p,v=d,m=S;continue n}if(v.value0 instanceof c){var p=u,d=v.value1,S=new o(m,v.value0.value0,v.value0.value1,v.value0.value2,v.value0.value3,v.value0.value4,v.value0.value5);u=p,v=d,m=S;continue n}if(v.value0 instanceof f){var p=u,d=v.value1,S=new o(v.value0.value0,v.value0.value1,v.value0.value2,m,v.value0.value3,v.value0.value4,v.value0.value5);u=p,v=d,m=S;continue n}if(v.value0 instanceof s){var p=u,d=v.value1,S=new o(v.value0.value0,v.value0.value1,v.value0.value2,v.value0.value3,v.value0.value4,v.value0.value5,m);u=p,v=d,m=S;continue n}throw new Error("Failed pattern match at Data.Map line 156, column 3 - line 163, column 1: "+[v.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map line 154, column 1 - line 155, column 1: "+[v.constructor.name,m.constructor.name])}}}},d=function(n){var r=function(e){return function(r){var u=e,m=r;n:for(;;){if(u instanceof t.Nil)return new a(m.value0,m.value1,m.value2,m.value3);if(u instanceof t.Cons){if(u.value0 instanceof i)return p(n)(u.value1)(new o(m.value0,m.value1,m.value2,m.value3,u.value0.value0,u.value0.value1,u.value0.value2));if(u.value0 instanceof l)return p(n)(u.value1)(new o(u.value0.value0,u.value0.value1,u.value0.value2,m.value0,m.value1,m.value2,m.value3));if(u.value0 instanceof c){var d=u.value1,S=new v(new a(m.value0,m.value1,m.value2,m.value3),u.value0.value0,u.value0.value1,new a(u.value0.value2,u.value0.value3,u.value0.value4,u.value0.value5));u=d,m=S;continue n}if(u.value0 instanceof f){var d=u.value1,S=new v(new a(u.value0.value0,u.value0.value1,u.value0.value2,m.value0),m.value1,m.value2,new a(m.value3,u.value0.value3,u.value0.value4,u.value0.value5));u=d,m=S;continue n}if(u.value0 instanceof s){var d=u.value1,S=new v(new a(u.value0.value0,u.value0.value1,u.value0.value2,u.value0.value3),u.value0.value4,u.value0.value5,new a(m.value0,m.value1,m.value2,m.value3));u=d,m=S;continue n}throw new Error("Failed pattern match at Data.Map line 197, column 5 - line 205, column 1: "+[u.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map line 195, column 3 - line 196, column 3: "+[u.constructor.name,m.constructor.name])}}},m=e.compare(n),d=function(d){return function(S){return function(h){return function(y){var P=d,g=S,w=h,C=y;n:for(;;){if(C instanceof u)return r(P)(new v(u.value,g,w,u.value));if(C instanceof a){var D=m(g)(C.value1);if(D instanceof e.EQ)return p(n)(P)(new a(C.value0,g,w,C.value3));if(D instanceof e.LT){var b=new t.Cons(new i(C.value1,C.value2,C.value3),P),A=g,E=w,F=C.value0;P=b,g=A,w=E,C=F;continue n}var b=new t.Cons(new l(C.value0,C.value1,C.value2),P),A=g,E=w,F=C.value3;P=b,g=A,w=E,C=F}else{if(!(C instanceof o))throw new Error("Failed pattern match at Data.Map line 173, column 3 - line 174, column 3: "+[P.constructor.name,g.constructor.name,w.constructor.name,C.constructor.name]);var M=m(g)(C.value1);if(M instanceof e.EQ)return p(n)(P)(new o(C.value0,g,w,C.value3,C.value4,C.value5,C.value6));var _=m(g)(C.value4);if(_ instanceof e.EQ)return p(n)(P)(new o(C.value0,C.value1,C.value2,C.value3,g,w,C.value6));if(M instanceof e.LT){var b=new t.Cons(new c(C.value1,C.value2,C.value3,C.value4,C.value5,C.value6),P),A=g,E=w,F=C.value0;P=b,g=A,w=E,C=F;continue n}if(M instanceof e.GT){if(_ instanceof e.LT){var b=new t.Cons(new f(C.value0,C.value1,C.value2,C.value4,C.value5,C.value6),P),A=g,E=w,F=C.value3;P=b,g=A,w=E,C=F;continue n}var b=new t.Cons(new s(C.value0,C.value1,C.value2,C.value3,C.value4,C.value5),P),A=g,E=w,F=C.value6;P=b,g=A,w=E,C=F;continue n}var b=new t.Cons(new s(C.value0,C.value1,C.value2,C.value3,C.value4,C.value5),P),A=g,E=w,F=C.value6;P=b,g=A,w=E,C=F}}}}}};return d(t.Nil.value)},S=u.value,h=function(n){var v=function(e){return function(v){for(var m=e,d=v;;){if(m instanceof t.Nil)return d;if(m instanceof t.Cons&&m.value0 instanceof i&&m.value0.value2 instanceof u&&d instanceof u)return p(n)(m.value1)(new a(u.value,m.value0.value0,m.value0.value1,u.value));if(m instanceof t.Cons&&m.value0 instanceof l&&m.value0.value0 instanceof u&&d instanceof u)return p(n)(m.value1)(new a(u.value,m.value0.value1,m.value0.value2,u.value));if(m instanceof t.Cons&&m.value0 instanceof i&&m.value0.value2 instanceof a){var S=m.value1,h=new o(d,m.value0.value0,m.value0.value1,m.value0.value2.value0,m.value0.value2.value1,m.value0.value2.value2,m.value0.value2.value3);m=S,d=h}else{if(!(m instanceof t.Cons&&m.value0 instanceof l&&m.value0.value0 instanceof a))return m instanceof t.Cons&&m.value0 instanceof i&&m.value0.value2 instanceof o?p(n)(m.value1)(new a(new a(d,m.value0.value0,m.value0.value1,m.value0.value2.value0),m.value0.value2.value1,m.value0.value2.value2,new a(m.value0.value2.value3,m.value0.value2.value4,m.value0.value2.value5,m.value0.value2.value6))):m instanceof t.Cons&&m.value0 instanceof l&&m.value0.value0 instanceof o?p(n)(m.value1)(new a(new a(m.value0.value0.value0,m.value0.value0.value1,m.value0.value0.value2,m.value0.value0.value3),m.value0.value0.value4,m.value0.value0.value5,new a(m.value0.value0.value6,m.value0.value1,m.value0.value2,d))):m instanceof t.Cons&&m.value0 instanceof c&&m.value0.value2 instanceof u&&m.value0.value5 instanceof u&&d instanceof u?p(n)(m.value1)(new o(u.value,m.value0.value0,m.value0.value1,u.value,m.value0.value3,m.value0.value4,u.value)):m instanceof t.Cons&&m.value0 instanceof f&&m.value0.value0 instanceof u&&m.value0.value5 instanceof u&&d instanceof u?p(n)(m.value1)(new o(u.value,m.value0.value1,m.value0.value2,u.value,m.value0.value3,m.value0.value4,u.value)):m instanceof t.Cons&&m.value0 instanceof s&&m.value0.value0 instanceof u&&m.value0.value3 instanceof u&&d instanceof u?p(n)(m.value1)(new o(u.value,m.value0.value1,m.value0.value2,u.value,m.value0.value4,m.value0.value5,u.value)):m instanceof t.Cons&&m.value0 instanceof c&&m.value0.value2 instanceof a?p(n)(m.value1)(new a(new o(d,m.value0.value0,m.value0.value1,m.value0.value2.value0,m.value0.value2.value1,m.value0.value2.value2,m.value0.value2.value3),m.value0.value3,m.value0.value4,m.value0.value5)):m instanceof t.Cons&&m.value0 instanceof f&&m.value0.value0 instanceof a?p(n)(m.value1)(new a(new o(m.value0.value0.value0,m.value0.value0.value1,m.value0.value0.value2,m.value0.value0.value3,m.value0.value1,m.value0.value2,d),m.value0.value3,m.value0.value4,m.value0.value5)):m instanceof t.Cons&&m.value0 instanceof f&&m.value0.value5 instanceof a?p(n)(m.value1)(new a(m.value0.value0,m.value0.value1,m.value0.value2,new o(d,m.value0.value3,m.value0.value4,m.value0.value5.value0,m.value0.value5.value1,m.value0.value5.value2,m.value0.value5.value3))):m instanceof t.Cons&&m.value0 instanceof s&&m.value0.value3 instanceof a?p(n)(m.value1)(new a(m.value0.value0,m.value0.value1,m.value0.value2,new o(m.value0.value3.value0,m.value0.value3.value1,m.value0.value3.value2,m.value0.value3.value3,m.value0.value4,m.value0.value5,d))):m instanceof t.Cons&&m.value0 instanceof c&&m.value0.value2 instanceof o?p(n)(m.value1)(new o(new a(d,m.value0.value0,m.value0.value1,m.value0.value2.value0),m.value0.value2.value1,m.value0.value2.value2,new a(m.value0.value2.value3,m.value0.value2.value4,m.value0.value2.value5,m.value0.value2.value6),m.value0.value3,m.value0.value4,m.value0.value5)):m instanceof t.Cons&&m.value0 instanceof f&&m.value0.value0 instanceof o?p(n)(m.value1)(new o(new a(m.value0.value0.value0,m.value0.value0.value1,m.value0.value0.value2,m.value0.value0.value3),m.value0.value0.value4,m.value0.value0.value5,new a(m.value0.value0.value6,m.value0.value1,m.value0.value2,d),m.value0.value3,m.value0.value4,m.value0.value5)):m instanceof t.Cons&&m.value0 instanceof f&&m.value0.value5 instanceof o?p(n)(m.value1)(new o(m.value0.value0,m.value0.value1,m.value0.value2,new a(d,m.value0.value3,m.value0.value4,m.value0.value5.value0),m.value0.value5.value1,m.value0.value5.value2,new a(m.value0.value5.value3,m.value0.value5.value4,m.value0.value5.value5,m.value0.value5.value6))):m instanceof t.Cons&&m.value0 instanceof s&&m.value0.value3 instanceof o?p(n)(m.value1)(new o(m.value0.value0,m.value0.value1,m.value0.value2,new a(m.value0.value3.value0,m.value0.value3.value1,m.value0.value3.value2,m.value0.value3.value3),m.value0.value3.value4,m.value0.value3.value5,new a(m.value0.value3.value6,m.value0.value4,m.value0.value5,d))):r.unsafeThrow("Impossible case in 'up'");var S=m.value1,h=new o(m.value0.value0.value0,m.value0.value0.value1,m.value0.value0.value2,m.value0.value0.value3,m.value0.value1,m.value0.value2,d);m=S,d=h}}}},m=function(n){return function(e){for(var i=n,c=e;;){if(c instanceof a&&c.value0 instanceof u&&c.value3 instanceof u)return v(i)(u.value);if(c instanceof a){var f=new t.Cons(new l(c.value0,c.value1,c.value2),i),m=c.value3;i=f,c=m}else{if(c instanceof o&&c.value0 instanceof u&&c.value3 instanceof u&&c.value6 instanceof u)return v(new t.Cons(new l(u.value,c.value1,c.value2),i))(u.value);if(!(c instanceof o)){if(c instanceof u)return r.unsafeThrow("Impossible case in 'removeMaxNode'");throw new Error("Failed pattern match at Data.Map line 259, column 3 - line 260, column 3: "+[i.constructor.name,c.constructor.name])}var f=new t.Cons(new s(c.value0,c.value1,c.value2,c.value3,c.value4,c.value5),i),m=c.value6;i=f,c=m}}}},d=function(n){for(var e=n;;){if(e instanceof a&&e.value3 instanceof u)return{key:e.value1,value:e.value2};if(e instanceof a){var t=e.value3;e=t}else{if(e instanceof o&&e.value6 instanceof u)return{key:e.value4,value:e.value5};if(!(e instanceof o)){if(e instanceof u)return r.unsafeThrow("Impossible case in 'maxNode'");throw new Error("Failed pattern match at Data.Map line 251, column 3 - line 252, column 3: "+[e.constructor.name])}var t=e.value6;e=t}}},S=function(r){return function(S){return function(h){var y=r,P=S,g=h;n:for(;;){if(g instanceof u)return p(n)(y)(u.value);if(g instanceof a&&g.value0 instanceof u&&g.value3 instanceof u&&e["=="](n["__superclass_Prelude.Eq_0"]())(P)(g.value1))return v(y)(u.value);if(g instanceof a){if(e["=="](n["__superclass_Prelude.Eq_0"]())(P)(g.value1)){var w=d(g.value0);return m(new t.Cons(new i(w.key,w.value,g.value3),y))(g.value0)}if(e["<"](n)(P)(g.value1)){var C=new t.Cons(new i(g.value1,g.value2,g.value3),y),D=P,b=g.value0;y=C,P=D,g=b;continue n}if(e.otherwise){var C=new t.Cons(new l(g.value0,g.value1,g.value2),y),D=P,b=g.value3;y=C,P=D,g=b;continue n}}if(g instanceof o&&g.value0 instanceof u&&g.value3 instanceof u&&g.value6 instanceof u){if(e["=="](n["__superclass_Prelude.Eq_0"]())(P)(g.value1))return p(n)(y)(new a(u.value,g.value4,g.value5,u.value));if(e["=="](n["__superclass_Prelude.Eq_0"]())(P)(g.value4))return p(n)(y)(new a(u.value,g.value1,g.value2,u.value))}if(g instanceof o){if(e["=="](n["__superclass_Prelude.Eq_0"]())(P)(g.value1)){var w=d(g.value0);return m(new t.Cons(new c(w.key,w.value,g.value3,g.value4,g.value5,g.value6),y))(g.value0)}if(e["=="](n["__superclass_Prelude.Eq_0"]())(P)(g.value4)){var w=d(g.value3);return m(new t.Cons(new f(g.value0,g.value1,g.value2,w.key,w.value,g.value6),y))(g.value3)}if(e["<"](n)(P)(g.value1)){var C=new t.Cons(new c(g.value1,g.value2,g.value3,g.value4,g.value5,g.value6),y),D=P,b=g.value0;y=C,P=D,g=b;continue n}if(e["<"](n)(g.value1)(P)&&e["<"](n)(P)(g.value4)){var C=new t.Cons(new f(g.value0,g.value1,g.value2,g.value4,g.value5,g.value6),y),D=P,b=g.value3;y=C,P=D,g=b;continue n}if(e.otherwise){var C=new t.Cons(new s(g.value0,g.value1,g.value2,g.value3,g.value4,g.value5),y),D=P,b=g.value6;y=C,P=D,g=b;continue n}}throw new Error("Failed pattern match at Data.Map line 209, column 3 - line 210, column 3: "+[y.constructor.name,P.constructor.name,g.constructor.name])}}}};return S(t.Nil.value)};n.keys=m,n["delete"]=h,n.insert=d,n.empty=S}(PS["Data.Map"]=PS["Data.Map"]||{}),function(n){"use strict";n["null"]=null,n.notNull=function(n){return n}}(PS["Data.Nullable"]=PS["Data.Nullable"]||{}),function(n){"use strict";var e=PS["Data.Nullable"],t=(PS.Prelude,PS["Data.Maybe"]),r=(PS["Data.Function"],t.maybe(e["null"])(e.notNull));n.toNullable=r}(PS["Data.Nullable"]=PS["Data.Nullable"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Foldable"],r=PS["Data.List"],u=(PS["Data.Monoid"],PS["Data.Map"]),r=(PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Control.Monad.Rec.Class"],PS["Data.Array"],PS["Data.Array.ST"],PS["Data.Array.Unsafe"],PS["Data.List"]),t=(PS["Data.Either"],PS["Data.Foldable"]),a=(PS["Data.Unfoldable"],function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}()),o=function(n){return u.keys(n.value0)},i=function(n){return function(t){return function(r){return new a(u.insert(n)(t)(e.unit)(r.value0))}}},l=new a(u.empty),c=function(n){return function(e){return function(t){return new a(u["delete"](n)(e)(t.value0))}}},f=function(n){return function(u){return function(a){return t.foldl(r.foldableList)(e.flip(c(n)))(u)(o(a))}}};n.difference=f,n.toList=o,n.insert=i,n.empty=l}(PS["Data.Set"]=PS["Data.Set"]||{}),function(n){"use strict";function e(n){return function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(n(r)(e[r]));return t}}n._copyEff=function(n){return function(){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}},n.runST=function(n){return n},n._lookup=function(n,e,t,r){return t in r?e(r[t]):n},n._collect=e}(PS["Data.StrMap"]=PS["Data.StrMap"]||{}),function(n){"use strict";n["new"]=function(){return{}},n.poke=function(n){return function(e){return function(t){return function(){return n[e]=t,n}}}},n["delete"]=function(n){return function(e){return function(){return delete n[e],n}}}}(PS["Data.StrMap.ST"]=PS["Data.StrMap.ST"]||{}),function(n){"use strict";var e=PS["Data.StrMap.ST"];PS.Prelude,PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Data.Maybe"];n["delete"]=e["delete"],n.poke=e.poke,n["new"]=e["new"]}(PS["Data.StrMap.ST"]=PS["Data.StrMap.ST"]||{}),function(n){"use strict";var e=PS["Data.StrMap"],t=(PS.Prelude,PS["Control.Monad.Eff"]),r=PS["Data.Foldable"],u=PS["Data.Function"],a=PS["Data.Maybe"],o=(PS["Data.Monoid"],PS["Data.Traversable"],PS["Data.Tuple"]),i=PS["Data.List"],l=(PS["Control.Monad.ST"],PS["Data.StrMap.ST"]),c=function(n){return i.toList(r.foldableArray)(e._collect(function(n){return function(n){return n}})(n))},f=function(n){return i.toList(r.foldableArray)(e._collect(o.Tuple.create)(n))},s=e._copyEff,v=function(n){return t.runPure(e.runST(n))},m=function(n){return function(e){return v(function(){var t=s(e)();return n(t)(),t})}},p=u.runFn4(e._lookup)(a.Nothing.value)(a.Just.create),d=function(n){return function(e){return m(function(t){return l.poke(t)(n)(e)})}},S=function(n){return function(e){return v(function(){var u=l["new"]();return r.for_(t.applicativeEff)(n)(e)(function(n){return l.poke(u)(n.value0)(n.value1)})(),u})}},h=function(n){return m(function(e){return l["delete"](e)(n)})},y=function(n){return function(e){return function(t){var r=n(p(e)(t));if(r instanceof a.Nothing)return h(e)(t);if(r instanceof a.Just)return d(e)(r.value0)(t);throw new Error("Failed pattern match at Data.StrMap line 178, column 15 - line 183, column 1: "+[r.constructor.name])}}};n.thawST=s,n.values=c,n.alter=y,n.fromFoldable=S,n.toList=f,n.lookup=p,n.insert=d}(PS["Data.StrMap"]=PS["Data.StrMap"]||{}),function(n){"use strict";n.traceAny=function(n){return function(e){return console.log(n),e({})}}}(PS["Debug.Trace"]=PS["Debug.Trace"]||{}),function(n){"use strict";var e=PS["Debug.Trace"],t=(PS.Prelude,e.traceAny);n.trace=t}(PS["Debug.Trace"]=PS["Debug.Trace"]||{}),function(n){"use strict";n.peekSTArrayUnsafe=function(n){return function(e){return function(){return n[e]}}},n.pokeSTArrayUnsafe=function(n){return function(e){return function(t){return function(){return n[e]=t,{}}}}},n.jsonStringify=function(n){return JSON.stringify(n)},n.consoleMessage=function(n){return function(e){return function(t){return 0===n?console.log(e):1===n?console.warn(e):(console.warn("Unknown level: "+n),console.warn(e)),t({})}}},n.throwWith=function(n){throw n}}(PS["KanColle.Util"]=PS["KanColle.Util"]||{}),function(n){"use strict";var e=PS["KanColle.Util"],t=PS.Prelude,r=PS["Data.Monoid"],u=PS["Data.Int"],a=(PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Data.Array"]),o=PS["Data.Array.Unsafe"],i=(PS["Data.Array.ST"],PS["Data.List"]),l=(PS["Data.Foldable"],PS["Control.Plus"]),c=PS["Data.Unfoldable"],f=e.consoleMessage(1),s=e.consoleMessage(0),v=function(n){return e.throwWith("TODO")},m=function(n){return function(e){return function(r){var a=function(e){return function(r){return function(a){for(var o=e,i=r,l=a;;)if(u.even(i)){var c=t["<>"](n)(o)(o),f=i/2|0,s=l;o=c,i=f,l=s}else{if(1===i)return t["<>"](n)(o)(l);if(!t.otherwise)throw new Error("Failed pattern match at KanColle.Util line 53, column 1 - line 65, column 1: "+[o.constructor.name,i.constructor.name,l.constructor.name]);var c=t["<>"](n)(o)(o),f=(i-1)/2|0,s=t["<>"](n)(o)(l);o=c,i=f,l=s}}}},o=function(e){return function(r){for(var o=e,i=r;;){if(!u.even(i)){if(1===i)return o;if(t.otherwise)return a(t["<>"](n)(o)(o))((i-1)/2|0)(o);throw new Error("Failed pattern match at KanColle.Util line 53, column 1 - line 65, column 1: "+[o.constructor.name,i.constructor.name])}var l=t["<>"](n)(o)(o),c=i/2|0;o=l,i=c}}};return o(r)(e+1|0)}}},p=function(n){return function(e){return function(t){return 0===e?r.mempty(n):m(n["__superclass_Prelude.Semigroup_0"]())(e-1)(t)}}},d=function(n){if(n instanceof i.Nil)return new i.Cons(i.Nil.value,i.Nil.value);if(n instanceof i.Cons)return new i.Cons(n,d(n.value1));throw new Error("Failed pattern match at KanColle.Util line 72, column 12 - line 78, column 1: "+[n.constructor.name])},S=function(n){return{left:r.mempty(n),right:r.mempty(n)}},h=function(n){return function(e){return{left:r.mempty(n),right:e}}},y=function(n){return function(e){return{left:e,right:r.mempty(n)}}},P=function(n){return function(e){return{left:n(e.left),right:n(e.right)}}},g=function(n){return function(e){return function(r){return{left:t["<>"](n["__superclass_Prelude.Semigroup_0"]())(e.left)(r.left),right:t["<>"](n["__superclass_Prelude.Semigroup_0"]())(e.right)(r.right)}}}},w=function(n){return function(t){var r=function(){if(n)return o.tail(t);if(!n)return t;throw new Error("Failed pattern match at KanColle.Util line 119, column 10 - line 122, column 5: "+[n.constructor.name])}(),u=12===a.length(r);if(u)return{left:a.slice(0)(6)(r),right:a.slice(6)(12)(r)};if(!u)return e.throwWith("fleetSplit: array length need to be 12 (or 13 on raw)");throw new Error("Failed pattern match at KanColle.Util line 114, column 25 - line 118, column 3: "+[u.constructor.name])}},C=function(n){return function(e){var r=i.toList(n)(e),u=function(n){return function(e){return 0===e?new i.Cons(i.Nil.value,i.Nil.value):t.bind(i.bindList)(d(n))(function(n){if(n instanceof i.Nil)return l.empty(i.plusList);if(n instanceof i.Cons)return t.bind(i.bindList)(u(n.value1)(e-1))(function(e){return t["return"](i.applicativeList)(new i.Cons(n.value0,e))});throw new Error("Failed pattern match at KanColle.Util line 85, column 7 - line 92, column 1: "+[n.constructor.name])})}};return function(n){return i.fromList(c.unfoldableArray)(u(r)(n))}}};n.fleetSplit=w,n.lrAppend=g,n.lrOnlyRight=h,n.lrOnlyLeft=y,n.memptyLR=S,n.lrMap=P,n.chooseN=C,n.times=p,n.traceWarn=f,n.traceLog=s,n.todo=v,n.pokeSTArrayUnsafe=e.pokeSTArrayUnsafe,n.peekSTArrayUnsafe=e.peekSTArrayUnsafe,n.jsonStringify=e.jsonStringify,n.throwWith=e.throwWith}(PS["KanColle.Util"]=PS["KanColle.Util"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=(PS["Data.Array"],PS["KanColle.Util"],function(){function n(){}return n.value=new n,n}()),u=function(){function n(){}return n.value=new n,n}(),a=new e.Show(function(n){if(n instanceof r)return"RepairTeam";if(n instanceof u)return"RepairGoddess";throw new Error("Failed pattern match at KanColle.DamageAnalysis.Types line 36, column 12 - line 40, column 1: "+[n.constructor.name])}),o=function(n){return function(e){return function(t){return{fullHp:e,hp:n,sunk:0>=n,dameCon:t}}}},i=function(n){return function(e){return{main:n(e.main),enemy:n(e.enemy)}}},l=function(n){return function(e){return{main:n(e.main),escort:n(e.escort),enemy:n(e.enemy)}}},c=function(n){return{main:n.left,enemy:n.right}},f=function(n){return function(e){return{hp:e.hp,sunk:e.hp<=0,dameConConsumed:t.isJust(n.dameCon)&&t.isNothing(e.dameCon)}}},s=new e.Eq(function(n){return function(e){return n instanceof r&&e instanceof r?!0:n instanceof u&&e instanceof u?!0:!1}}),v=function(n){return{main:n,enemy:n}},m=function(n){return{main:n,escort:n,enemy:n}},p=function(n){return function(e){return{main:n.main(e.main),enemy:n.enemy(e.enemy)}}},d=function(n){return function(e){return{main:n.main(e.main),escort:n.escort(e.escort),enemy:n.enemy(e.enemy)}}};n.RepairTeam=r,n.RepairGoddess=u,n.lrToNormal=c,n.mapCombinedBattle=l,n.appCombinedBattle=d,n.dupAsCombinedBattle=m,n.mapNormalBattle=i,n.appNormalBattle=p,n.dupAsNormalBattle=v,n.getShipResult=f,n.mkShip=o,n.eqDameCon=s,n.showDameCon=a}(PS["KanColle.DamageAnalysis.Types"]=PS["KanColle.DamageAnalysis.Types"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Monoid"],u=PS["Data.Int"],a=PS["KanColle.DamageAnalysis.Types"],o=function(n){return function(e){return function(t){return e(n(t))}}},i=new e.Semigroup(o),l=new r.Monoid(function(){return i},e.id(e.categoryFn)),c=function(n){return function(e){var r=function(){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n.sunk=!1,n.dameCon=t.Nothing.value,n}();if(n instanceof a.RepairTeam){var o={};for(var i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);return o.hp=u.floor(.2*u.toNumber(e.fullHp)),o}if(n instanceof a.RepairGoddess){var l={};for(var c in r)r.hasOwnProperty(c)&&(l[c]=r[c]);return l.hp=e.fullHp,l}throw new Error("Failed pattern match at KanColle.DamageAnalysis.Damage line 40, column 21 - line 43, column 3: "+[n.constructor.name])}},f=function(n){if(n.sunk)return t.maybe(n)(function(e){return c(e)(n)})(n.dameCon);if(!n.sunk)return n;throw new Error("Failed pattern match at KanColle.DamageAnalysis.Damage line 48, column 16 - line 54, column 1: "+[n.sunk.constructor.name])},s=function(n){return function(e){var t=e.hp-n,r={};for(var u in e)e.hasOwnProperty(u)&&(r[u]=e[u]);return r.hp=t,r.sunk=0>=t,r}},v=function(n){return 0===n?e.id(e.categoryFn):function(e){return f(s(n)(e))}},m=function(n){return n},p=function(n){var e={hp:1e4,fullHp:1e4,sunk:!1,dameCon:t.Nothing.value},r=m(n)(e);return e.hp-r.hp},d=function(n){return function(e){return o(n)(v(e))}};n.damageToInt=p,n.applyDamage=m,n.addDamage=d,n.mergeDamage=o,n.mkDamage=v,n.semigroupDamage=i,n.monoidDamage=l}(PS["KanColle.DamageAnalysis.Damage"]=PS["KanColle.DamageAnalysis.Damage"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Foreign"],u=PS["Data.Foreign.Index"],a=PS["Control.MonadPlus"],o=(PS["Data.Array.Unsafe"],function(n){return function(e){return u.hasOwnProperty(u.indexString)(n)(r.toForeign(e))}}),i=o("api_hougeki"),l=o("api_hourai_flag"),c=function(n){return o("api_stage_flag")(n)?1===n.api_stage_flag[2]:!1},f=function(n){return o("api_stage_flag2")(n)?1===n.api_stage_flag2[2]:!1},s=o("api_air_base_attack"),v=function(n){var e=o("api_support_flag")(n);if(e)return new t.Just(n.api_support_flag);if(!e)return t.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 111, column 20 - line 115, column 1: "+[e.constructor.name])},m=function(n){return e.bind(t.bindMaybe)(v(n))(function(r){return e.bind(t.bindMaybe)(a.guard(t.monadPlusMaybe)(2===r||3===r))(function(){return e["return"](t.applicativeMaybe)(n.api_support_info.api_support_hourai)})})},p=function(n){return e.bind(t.bindMaybe)(v(n))(function(r){return e.bind(t.bindMaybe)(a.guard(t.monadPlusMaybe)(1===r))(function(){return e["return"](t.applicativeMaybe)(n.api_support_info.api_support_airatack)})})},d=function(n){var e=o("api_opening_flag")(n)&&1===n.api_opening_flag;if(e)return new t.Just(n.api_opening_atack);if(!e)return t.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 145, column 5 - line 150, column 1: "+[e.constructor.name])},S=function(n){var e=s(n);if(e)return new t.Just(n.api_air_base_attack);if(!e)return t.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 202, column 28 - line 204, column 10: "+[e.constructor.name])},h=function(n){var e=f(n);if(e)return new t.Just(n.api_kouku2);if(!e)return t.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 128, column 15 - line 132, column 1: "+[e.constructor.name])},y=function(n){var e=c(n);if(e)return new t.Just(n.api_kouku);if(!e)return t.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 106, column 14 - line 110, column 1: "+[e.constructor.name])},P=function(n){var e=o("api_hourai_flag")(n);if(e)return new t.Just(n.api_hourai_flag);if(!e)return t.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 134, column 4 - line 138, column 1: "+[e.constructor.name])},g=function(n){var e=i(n);if(e)return new t.Just(n.api_hougeki);if(!e)return t.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 171, column 16 - line 178, column 1: "+[e.constructor.name])},w=function(n){return-1===n?t.Nothing.value:new t.Just(n)},C=function(n){return e.map(e.functorArray)(w)(n.api_nowhps)},D=function(n){return e.map(e.functorArray)(w)(n.api_nowhps_combined)},b=function(n){return e.map(e.functorArray)(w)(n.api_maxhps)},A=function(n){return e.map(e.functorArray)(w)(n.api_maxhps_combined)},E=function(n){return function(r){return e.bind(t.bindMaybe)(e["<$>"](t.functorMaybe)(function(e){return e[n]})(P(r)))(function(n){return a.guard(t.monadPlusMaybe)(1===n)})}},F=function(n){return e.bind(t.bindMaybe)(E(0)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_hougeki1)})},M=function(n){return e.bind(t.bindMaybe)(E(0)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_hougeki1)})},_=function(n){return e.bind(t.bindMaybe)(E(1)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_hougeki2)})},I=function(n){return e.bind(t.bindMaybe)(E(2)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_hougeki2)})},T=function(n){return e.bind(t.bindMaybe)(E(2)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_hougeki3)})},N=function(n){return e.bind(t.bindMaybe)(E(3)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_hougeki3)})},x=function(n){return e.bind(t.bindMaybe)(E(3)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_raigeki)})},K=function(n){return e.bind(t.bindMaybe)(E(1)(n))(function(){return e["return"](t.applicativeMaybe)(n.api_raigeki)})};n.getLandBasedAirStrikes=S,n.hasLandBasedAirStrikes=s,n.getHougeki3CT=N,n.getHougeki2CT=I,n.getRaigekiCT=K,n.getHougeki1CT=M,n.getHougeki=g,n.getRaigeki=x,n.getHougeki3=T,n.getHougeki2=_,n.getHougeki1=F,n.getOpeningAttack=d,n.checkHouraiFlag=E,n.getHouraiFlags=P,n.getKouku2=h,n.getSupportHouraiInfo=m,n.getSupportAirInfo=p,n.getSupportFlag=v,n.getKouku=y,n.hasHougeki=i,n.hasHourai=l,n.hasKouku2=f,n.hasKouku=c,n.hasField=o,n.getMaxHpsCombined=A,n.getMaxHps=b,n.getInitHpsCombined=D,n.getInitHps=C,n.fromRawHp=w}(PS["KanColle.KCAPI.Battle"]=PS["KanColle.KCAPI.Battle"]||{}),
function(n){"use strict";var e=PS.Prelude,t=PS["Data.Monoid"],r=PS["Data.Int"],u=PS["Data.Array"],a=PS["Data.Array.ST"],o=PS["Control.Monad.Eff"],i=(PS["Control.Monad.ST"],PS["Data.Array.Unsafe"]),l=PS["KanColle.Util"],c=PS["KanColle.DamageAnalysis.Types"],f=PS["KanColle.DamageAnalysis.Damage"],s=PS["Data.Foreign"],v=PS["Data.Foldable"],m=(PS["KanColle.KCAPI.Battle"],PS["Data.Maybe"]),p=(PS["Data.String"],function(){function n(){}return n.value=new n,n}()),d=function(){function n(){}return n.value=new n,n}(),S=function(){function n(){}return n.value=new n,n}(),h=function(){function n(){}return n.value=new n,n}(),y=function(n){return n},P=new e.Semigroup(function(n){return function(t){return u.zipWith(e["<>"](f.semigroupDamage))(n)(t)}}),g=function(n){if(n>=0)return r.floor(n);if(-1===n)return 0;if(e.otherwise){var t="invalid damage number: "+e.show(e.showNumber)(n);return l.traceWarn(t)(function(n){return 0})}throw new Error("Failed pattern match at KanColle.DamageAnalysis.DamageVector line 52, column 1 - line 60, column 1: "+[n.constructor.name])},w=new t.Monoid(function(){return P},u.replicate(6)(t.mempty(f.monoidDamage))),C=function(n){return function(e){if(n instanceof p)return{main:e.left,escort:t.mempty(w),enemy:e.right};if(n instanceof d)return{main:t.mempty(w),escort:e.left,enemy:e.right};if(n instanceof S)return{main:t.mempty(w),escort:t.mempty(w),enemy:e.right};if(n instanceof h)return{main:t.mempty(w),escort:t.mempty(w),enemy:e.right};throw new Error("Failed pattern match at KanColle.DamageAnalysis.DamageVector line 198, column 19 - line 205, column 1: "+[n.constructor.name])}},D=function(n){var e=6===u.length(n);if(e)return n;if(!e)return l.throwWith("mkDV: array size should be 6");throw new Error("Failed pattern match at KanColle.DamageAnalysis.DamageVector line 69, column 11 - line 72, column 3: "+[e.constructor.name])},b=function(n){return n},A=function(n){return e.map(e.functorArray)(function(n){return f.mkDamage(g(n))})(i.tail(n))},E=function(n){return{left:A(n.api_fdam),right:A(n.api_edam)}},F=function(n){return y(A(n.api_damage))},M=function(n){return y(A(n.api_stage3.api_edam))},_=E,I=function(n){return A(n.api_stage3.api_edam)},T=function(n){return A(n.api_stage3_combined.api_fdam)},N=function(n){return E(n.api_stage3)},x=function(n){var r=function(){var t=function(n){var t=v.sum(v.foldableArray)(e.semiringInt)(e.map(e.functorArray)(g)(n));return f.mkDamage(t)};return e.map(e.functorArray)(function(n){return t(s.unsafeFromForeign(n))})(i.tail(n.api_damage))}(),c=function(){var t=function(n){var t=u.uncons(n);if(t instanceof m.Just){var r=v.all(v.foldableArray)(e.booleanAlgebraBoolean)(function(n){return n===t.value0.head})(t.value0.tail)||v.all(v.foldableArray)(e.booleanAlgebraBoolean)(function(n){return-1===n})(t.value0.tail);if(r)return t.value0.head-1;if(!r)return l.throwWith("invalid: elements are different in api_df_list");throw new Error("Failed pattern match at KanColle.DamageAnalysis.DamageVector line 150, column 13 - line 153, column 11: "+[r.constructor.name])}if(t instanceof m.Nothing)return l.throwWith("invalid: empty api_df_list element");throw new Error("Failed pattern match at KanColle.DamageAnalysis.DamageVector line 148, column 20 - line 155, column 5: "+[t.constructor.name])};return e.map(e.functorArray)(function(n){return t(s.unsafeFromForeign(n))})(i.tail(n.api_df_list))}(),p=u.length(c)===u.length(r),d=function(n){return function(t){return function(r){return function(){var u=l.peekSTArrayUnsafe(n)(t)();return l.pokeSTArrayUnsafe(n)(t)(e["<>"](f.semigroupDamage)(u)(r))(),e.unit}}}},S=function(){var n=a.thaw(u.replicate(12)(t.mempty(f.monoidDamage)))();return u.zipWithA(o.applicativeEff)(d(n))(c)(r)(),n};if(p){var h=o.runPure(a.runSTArray(S));return l.lrMap(y)(l.fleetSplit(!1)(h))}if(!p)return l.throwWith("invalid: api_df_list and api_damage length mismatch");throw new Error("Failed pattern match at KanColle.DamageAnalysis.DamageVector line 126, column 5 - line 130, column 3: "+[p.constructor.name])},K=function(n){return function(t){var r=function(n){return function(t){return e["<$>"](m.functorMaybe)(f.applyDamage(n))(t)}};return u.zipWith(r)(b(n))(t)}},k=function(n){return function(e){return c.appNormalBattle(c.appNormalBattle(c.dupAsNormalBattle(K))(n))(e)}},B=function(n){return function(e){return c.appCombinedBattle(c.appCombinedBattle(c.dupAsCombinedBattle(K))(n))(e)}};n.FRMain=p,n.FREscort=d,n.FRSupport=S,n.FRLandBased=h,n.applyCombinedDamageVector=B,n.applyNormalDamageVector=k,n.applyDamageVector=K,n.toCombined=C,n.calcLandBasedKoukuDamage=I,n.calcRaigekiDamage=_,n.calcHougekiDamage=x,n.calcSupportHouraiDamage=F,n.calcSupportAirAttackDamage=M,n.calcKoukuDamageCombined=T,n.calcKoukuDamage=N,n.mkDV=D,n.getDV=b,n.semigroupDamageVector=P,n.monoidDamageVector=w}(PS["KanColle.DamageAnalysis.DamageVector"]=PS["KanColle.DamageAnalysis.DamageVector"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Monoid"],u=PS["Data.Foldable"],a=PS["KanColle.KCAPI.Battle"],o=PS["KanColle.Util"],i=PS["KanColle.DamageAnalysis.DamageVector"],l=PS["KanColle.DamageAnalysis.Types"],c=function(n){return{main:r.mempty(n),escort:r.mempty(n),enemy:r.mempty(n)}},f=function(n){return function(t){return u.foldl(u.foldableArray)(o.lrAppend(i.monoidDamageVector))(o.memptyLR(i.monoidDamageVector))(e["<$>"](e.functorArray)(function(n){return n(t)})(n))}},s=function(n){return function(e){return function(r){return function(u){return t.maybe(e)(r)(n(u))}}}},v=s(a.getHougeki1CT)(o.memptyLR(i.monoidDamageVector))(i.calcHougekiDamage),m=s(a.getHougeki1)(o.memptyLR(i.monoidDamageVector))(i.calcHougekiDamage),p=s(a.getHougeki2CT)(o.memptyLR(i.monoidDamageVector))(i.calcHougekiDamage),d=s(a.getHougeki2)(o.memptyLR(i.monoidDamageVector))(i.calcHougekiDamage),S=s(a.getHougeki3CT)(o.memptyLR(i.monoidDamageVector))(i.calcHougekiDamage),h=s(a.getHougeki3)(o.memptyLR(i.monoidDamageVector))(i.calcHougekiDamage),y=s(a.getHougeki)(o.memptyLR(i.monoidDamageVector))(i.calcHougekiDamage),P=function(n){return l.lrToNormal(y(n))},g=s(a.getKouku2)(r.mempty(i.monoidDamageVector))(i.calcKoukuDamageCombined),w=s(a.getKouku2)(o.memptyLR(i.monoidDamageVector))(i.calcKoukuDamage),C=s(a.getKouku)(r.mempty(i.monoidDamageVector))(i.calcKoukuDamageCombined),D=s(a.getKouku)(o.memptyLR(i.monoidDamageVector))(i.calcKoukuDamage),b=function(n){return u.foldl(u.foldableArray)(o.lrAppend(i.monoidDamageVector))(o.memptyLR(i.monoidDamageVector))(s(a.getLandBasedAirStrikes)([])(e.map(e.functorArray)(function(n){return o.lrOnlyRight(i.monoidDamageVector)(i.calcLandBasedKoukuDamage(n))}))(n))},A=s(a.getOpeningAttack)(o.memptyLR(i.monoidDamageVector))(i.calcRaigekiDamage),E=s(a.getRaigekiCT)(o.memptyLR(i.monoidDamageVector))(i.calcRaigekiDamage),F=s(a.getRaigeki)(o.memptyLR(i.monoidDamageVector))(i.calcRaigekiDamage),M=s(a.getSupportAirInfo)(r.mempty(i.monoidDamageVector))(i.calcSupportAirAttackDamage),_=s(a.getSupportHouraiInfo)(r.mempty(i.monoidDamageVector))(i.calcSupportHouraiDamage),I=function(n){return function(t){return function(r){return{main:e["<>"](n["__superclass_Prelude.Semigroup_0"]())(t.main)(r.main),escort:e["<>"](n["__superclass_Prelude.Semigroup_0"]())(t.escort)(r.escort),enemy:e["<>"](n["__superclass_Prelude.Semigroup_0"]())(t.enemy)(r.enemy)}}}},T=function(n){return function(t){return u.foldl(u.foldableArray)(I(i.monoidDamageVector))(c(i.monoidDamageVector))(e["<$>"](e.functorArray)(function(n){return n(t)})(n))}},N=T([function(n){return i.toCombined(i.FRLandBased.value)(b(n))},function(n){return i.toCombined(i.FRMain.value)(D(n))},function(n){return i.toCombined(i.FREscort.value)(o.lrOnlyLeft(i.monoidDamageVector)(C(n)))},function(n){return i.toCombined(i.FRSupport.value)(o.lrOnlyRight(i.monoidDamageVector)(M(n)))},function(n){return i.toCombined(i.FRSupport.value)(o.lrOnlyRight(i.monoidDamageVector)(_(n)))},function(n){return i.toCombined(i.FRMain.value)(w(n))},function(n){return i.toCombined(i.FREscort.value)(o.lrOnlyLeft(i.monoidDamageVector)(g(n)))},function(n){return i.toCombined(i.FREscort.value)(A(n))},function(n){return i.toCombined(i.FRMain.value)(m(n))},function(n){return i.toCombined(i.FRMain.value)(d(n))},function(n){return i.toCombined(i.FREscort.value)(h(n))},function(n){return i.toCombined(i.FREscort.value)(F(n))}]),x=function(n){return l.lrToNormal(f([b,D,w,function(n){return o.lrOnlyRight(i.monoidDamageVector)(M(n))},function(n){return o.lrOnlyRight(i.monoidDamageVector)(_(n))},A,m,d,h,F])(n))},K=T([function(n){return i.toCombined(i.FRLandBased.value)(b(n))},function(n){return i.toCombined(i.FRMain.value)(D(n))},function(n){return i.toCombined(i.FREscort.value)(o.lrOnlyLeft(i.monoidDamageVector)(C(n)))},function(n){return i.toCombined(i.FRSupport.value)(o.lrOnlyRight(i.monoidDamageVector)(M(n)))},function(n){return i.toCombined(i.FRSupport.value)(o.lrOnlyRight(i.monoidDamageVector)(_(n)))},function(n){return i.toCombined(i.FRMain.value)(w(n))},function(n){return i.toCombined(i.FREscort.value)(o.lrOnlyLeft(i.monoidDamageVector)(g(n)))},function(n){return i.toCombined(i.FREscort.value)(A(n))},function(n){return i.toCombined(i.FREscort.value)(v(n))},function(n){return i.toCombined(i.FREscort.value)(E(n))},function(n){return i.toCombined(i.FRMain.value)(p(n))},function(n){return i.toCombined(i.FRMain.value)(S(n))}]);n.battleSurfaceTaskForceDV=N,n.battleCarrierTaskForceDV=K,n.supportHouraiDV=_,n.supportAirAttackDV=M,n.nightBattleDV=P,n.battleDV=x,n.koukuCombinedDV=C,n.koukuDV=D}(PS["KanColle.DamageAnalysis.Stages"]=PS["KanColle.DamageAnalysis.Stages"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Array"],r=PS["Data.Array.Unsafe"],u=PS["Data.Maybe"],a=PS["KanColle.KCAPI.Battle"],o=PS["KanColle.Util"],i=PS["KanColle.DamageAnalysis.DamageVector"],l=PS["KanColle.DamageAnalysis.Stages"],c=PS["KanColle.DamageAnalysis.Types"],f=o.fleetSplit(!0),s=o.fleetSplit(!1),v=function(n){return function(e){var r=f(a.getInitHps(e)),o=function(n){return function(e){return n instanceof u.Just&&e instanceof u.Just?new u.Just({hp:n.value0,fullHp:e.value0,sunk:n.value0<=0,dameCon:u.Nothing.value}):u.Nothing.value}},i=f(a.getMaxHps(e)),l=t.zipWith(o)(r.right)(i.right),c=function(n){return function(e){return n instanceof u.Just?new u.Just(function(){var t={};for(var r in n.value0)n.value0.hasOwnProperty(r)&&(t[r]=n.value0[r]);return t.dameCon=e,t}()):u.Nothing.value}},s=t.zipWith(c)(t.zipWith(o)(r.left)(i.left))(n);return{main:s,enemy:l}}},m=function(n){return function(e){var o=function(n){return function(e){return n instanceof u.Just&&e instanceof u.Just?new u.Just({hp:n.value0,fullHp:e.value0,sunk:n.value0<=0,dameCon:u.Nothing.value}):u.Nothing.value}},i=r.tail(a.getInitHpsCombined(e)),l=r.tail(a.getMaxHpsCombined(e)),c=s(n),f=v(c.left)(e),m=function(n){return function(e){return n instanceof u.Just?new u.Just(function(){var t={};for(var r in n.value0)n.value0.hasOwnProperty(r)&&(t[r]=n.value0[r]);return t.dameCon=e,t}()):u.Nothing.value}},p=t.zipWith(m)(t.zipWith(o)(i)(l))(c.right);return{main:f.main,escort:p,enemy:f.enemy}}},p=function(n){return function(r){var a=m(e["<>"](e.semigroupArray)(t.replicate(6)(u.Nothing.value))(n))(r),o={main:a.escort,enemy:a.enemy},f=function(n){return function(t){return e["<*>"](u.applyMaybe)(e["<$>"](u.functorMaybe)(c.getShipResult)(n))(t)}},s=i.applyNormalDamageVector(l.nightBattleDV(r))(o);return c.appNormalBattle(c.appNormalBattle(c.dupAsNormalBattle(t.zipWith(f)))(o))(s)}},d=function(n){return function(r){return function(a){var o=m(r)(a),l=function(n){return function(t){return e["<*>"](u.applyMaybe)(e["<$>"](u.functorMaybe)(c.getShipResult)(n))(t)}},f=i.applyCombinedDamageVector(n(a))(o);return c.appCombinedBattle(c.appCombinedBattle(c.dupAsCombinedBattle(t.zipWith(l)))(o))(f)}}},S=d(l.battleSurfaceTaskForceDV),h=d(l.battleCarrierTaskForceDV),y=h,P=function(n){return function(r){return function(a){var o=v(r)(a),l=function(n){return function(t){return e["<*>"](u.applyMaybe)(e["<$>"](u.functorMaybe)(c.getShipResult)(n))(t)}},f=i.applyNormalDamageVector(n(a))(o);return c.appNormalBattle(c.appNormalBattle(c.dupAsNormalBattle(t.zipWith(l)))(o))(f)}}},g=P(l.nightBattleDV),w=P(l.battleDV);n.analyzeCombinedNightBattle=p,n.analyzeTECFBattle=y,n.analyzeCTFBattle=h,n.analyzeSTFBattle=S,n.analyzeNightBattle=g,n.analyzeBattle=w}(PS["KanColle.DamageAnalysis.DamageAnalysis"]=PS["KanColle.DamageAnalysis.DamageAnalysis"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["KanColle.Util"],r=PS["KanColle.DamageAnalysis.DamageAnalysis"],u=PS["KanColle.DamageAnalysis.Types"],a=(PS["KanColle.KCAPI.Battle"],PS["Data.Maybe"]),o=(PS["Data.Function"],PS["Data.Nullable"]),i=function(){var n=function(n){return 0===n?a.Nothing.value:1===n?new a.Just(u.RepairTeam.value):2===n?new a.Just(u.RepairGoddess.value):t.throwWith("readDameCon: invalid input: "+e.show(e.showInt)(n))};return e.map(e.functorArray)(n)}(),l=function(n){var t=function(n){return{main:e.map(e.functorArray)(o.toNullable)(n.main),enemy:e.map(e.functorArray)(o.toNullable)(n.enemy),escort:e.map(e.functorArray)(o.toNullable)(n.escort)}};return function(e,r){return t(n(i(e))(r))}},c=function(n){var t=function(n){return{main:e.map(e.functorArray)(o.toNullable)(n.main),enemy:e.map(e.functorArray)(o.toNullable)(n.enemy)}};return function(e,r){return t(n(i(e))(r))}},f=l(r.analyzeTECFBattle),s=l(r.analyzeSTFBattle),v=c(r.analyzeNightBattle),m=c(r.analyzeCombinedNightBattle),p=l(r.analyzeCTFBattle),d=c(r.analyzeBattle);n.analyzeCombinedNightBattleJS=m,n.analyzeTECFBattleJS=f,n.analyzeCTFBattleJS=p,n.analyzeSTFBattleJS=s,n.analyzeNightBattleJS=v,n.analyzeBattleJS=d}(PS["KanColle.DamageAnalysis.FFI"]=PS["KanColle.DamageAnalysis.FFI"]||{}),function(n){"use strict";var e=PS.Prelude,t=function(){function n(){}return n.value=new n,n}(),r=function(){function n(){}return n.value=new n,n}(),u=function(){function n(){}return n.value=new n,n}(),a=function(){function n(){}return n.value=new n,n}(),o=function(){function n(){}return n.value=new n,n}(),i=function(){function n(){}return n.value=new n,n}(),l=function(){function n(){}return n.value=new n,n}(),c=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}(),s=function(){function n(){}return n.value=new n,n}(),v=function(){function n(){}return n.value=new n,n}(),m=function(){function n(){}return n.value=new n,n}(),p=function(){function n(){}return n.value=new n,n}(),d=function(){function n(){}return n.value=new n,n}(),S=function(){function n(){}return n.value=new n,n}(),h=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),g=function(){function n(){}return n.value=new n,n}(),w=function(){function n(){}return n.value=new n,n}(),C=function(){function n(){}return n.value=new n,n}(),D=function(){function n(){}return n.value=new n,n}(),b=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),A=function(n){if(n instanceof t)return 1;if(n instanceof r)return 2;if(n instanceof u)return 3;if(n instanceof a)return 4;if(n instanceof o)return 5;if(n instanceof i)return 6;if(n instanceof l)return 7;if(n instanceof c)return 8;if(n instanceof f)return 9;if(n instanceof s)return 10;if(n instanceof v)return 11;if(n instanceof m)return 12;if(n instanceof p)return 13;if(n instanceof d)return 14;if(n instanceof S)return 15;if(n instanceof h)return 16;if(n instanceof y)return 17;if(n instanceof P)return 18;if(n instanceof g)return 19;if(n instanceof w)return 20;if(n instanceof C)return 21;if(n instanceof D)return 22;if(n instanceof b)return-1;throw new Error("Failed pattern match at KanColle.Generated.SType line 84, column 1 - line 85, column 1: "+[n.constructor.name])},E=function(n){if(n instanceof t)return"DDE";if(n instanceof r)return"DD";if(n instanceof u)return"CL";if(n instanceof a)return"CLT";if(n instanceof o)return"CA";if(n instanceof i)return"CAV";if(n instanceof l)return"CVL";if(n instanceof c)return"FBB";if(n instanceof f)return"BB";if(n instanceof s)return"BBV";if(n instanceof v)return"CV";if(n instanceof m)return"XBB";if(n instanceof p)return"SS";if(n instanceof d)return"SSV";if(n instanceof S)return"AP";if(n instanceof h)return"AV";if(n instanceof y)return"LHA";if(n instanceof P)return"CVB";if(n instanceof g)return"AR";if(n instanceof w)return"AS";if(n instanceof C)return"CT";if(n instanceof D)return"AO";if(n instanceof b)return"<Unknown:"+(n.value0+">");throw new Error("Failed pattern match at KanColle.Generated.SType line 9, column 1 - line 10, column 1: "+[n.constructor.name])},F=function(n){return"DDE"===n?t.value:"DD"===n?r.value:"CL"===n?u.value:"CLT"===n?a.value:"CA"===n?o.value:"CAV"===n?i.value:"CVL"===n?l.value:"FBB"===n?c.value:"BB"===n?f.value:"BBV"===n?s.value:"CV"===n?v.value:"XBB"===n?m.value:"SS"===n?p.value:"SSV"===n?d.value:"AP"===n?S.value:"AV"===n?h.value:"LHA"===n?y.value:"CVB"===n?P.value:"AR"===n?g.value:"AS"===n?w.value:"CT"===n?C.value:"AO"===n?D.value:new b(n)},M=function(n){return 1===n?t.value:2===n?r.value:3===n?u.value:4===n?a.value:5===n?o.value:6===n?i.value:7===n?l.value:8===n?c.value:9===n?f.value:10===n?s.value:11===n?v.value:12===n?m.value:13===n?p.value:14===n?d.value:15===n?S.value:16===n?h.value:17===n?y.value:18===n?P.value:19===n?g.value:20===n?w.value:21===n?C.value:22===n?D.value:new b("num "+e.show(e.showInt)(n))};n.DDE=t,n.DD=r,n.CL=u,n.CLT=a,n.CA=o,n.CAV=i,n.CVL=l,n.FBB=c,n.BB=f,n.BBV=s,n.CV=v,n.XBB=m,n.SS=p,n.SSV=d,n.AP=S,n.AV=h,n.LHA=y,n.CVB=P,n.AR=g,n.AS=w,n.CT=C,n.AO=D,n.Unknown=b,n.toInt=A,n.fromInt=M,n.readSType=F,n.showSType=E}(PS["KanColle.Generated.SType"]=PS["KanColle.Generated.SType"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["KanColle.Generated.SType"]),t=function(n){return function(t){return e.showSType(n)===e.showSType(t)}};n.eqSType=t}(PS["KanColle.SType"]=PS["KanColle.SType"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Array"],r=PS["Data.Foldable"],u=PS["Data.Maybe"],a=PS["Data.String"],o=PS["KanColle.SType"],i=PS["KanColle.Generated.SType"],l=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),c=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),f=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),s=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),v=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),m=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),p=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),d=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),S=function(n){var t=function(n){return[new p(n,[i.SS.value,i.SSV.value])]},r=function(n){return function(e){return[new p(n,[e])]}},u=function(n){return[new s(n)]},a=function(n){return function(e){return[new f(new l(n)),new d(e)]}},o=function(n){return[new p(n,[i.CV.value,i.CVL.value,i.AV.value])]};return 1===n?a(1)(2):2===n?a(2)(4):3===n?a(3)(3):4===n?e["<>"](e.semigroupArray)(a(3)(3))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(2)(i.DD.value))):5===n?e["<>"](e.semigroupArray)(a(3)(4))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(2)(i.DD.value))):6===n?a(4)(4):7===n?a(5)(6):8===n?a(6)(6):9===n?e["<>"](e.semigroupArray)(a(3)(4))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(2)(i.DD.value))):10===n?e["<>"](e.semigroupArray)(a(3)(3))(r(2)(i.CL.value)):11===n?e["<>"](e.semigroupArray)(a(6)(4))(r(2)(i.DD.value)):12===n?e["<>"](e.semigroupArray)(a(4)(4))(r(2)(i.DD.value)):13===n?e["<>"](e.semigroupArray)(a(5)(6))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(4)(i.DD.value))):14===n?e["<>"](e.semigroupArray)(a(6)(6))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(3)(i.DD.value))):15===n?e["<>"](e.semigroupArray)(a(9)(6))(e["<>"](e.semigroupArray)(o(2))(r(2)(i.DD.value))):16===n?e["<>"](e.semigroupArray)(a(11)(6))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(2)(i.DD.value))):17===n?e["<>"](e.semigroupArray)(a(20)(6))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(3)(i.DD.value))):18===n?e["<>"](e.semigroupArray)(a(15)(6))(e["<>"](e.semigroupArray)(o(3))(r(2)(i.DD.value))):19===n?e["<>"](e.semigroupArray)(a(20)(6))(e["<>"](e.semigroupArray)(r(2)(i.BBV.value))(r(2)(i.DD.value))):20===n?e["<>"](e.semigroupArray)(a(1)(2))(e["<>"](e.semigroupArray)(t(1))(r(1)(i.CL.value))):21===n?e["<>"](e.semigroupArray)(a(15)(5))(e["<>"](e.semigroupArray)(u(30))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(e["<>"](e.semigroupArray)(r(4)(i.DD.value))([new m(3)])))):22===n?e["<>"](e.semigroupArray)(a(30)(6))(e["<>"](e.semigroupArray)(u(45))(e["<>"](e.semigroupArray)(r(1)(i.CA.value))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(2)(i.DD.value))))):23===n?e["<>"](e.semigroupArray)(a(50)(6))(e["<>"](e.semigroupArray)(u(200))(e["<>"](e.semigroupArray)(r(2)(i.BBV.value))(r(2)(i.DD.value)))):24===n?e["<>"](e.semigroupArray)(a(50)(6))(e["<>"](e.semigroupArray)(u(200))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(e["<>"](e.semigroupArray)(r(4)(i.DD.value))([new f(new c([i.CL.value]))])))):25===n?e["<>"](e.semigroupArray)(a(25)(4))(e["<>"](e.semigroupArray)(r(2)(i.CA.value))(r(2)(i.DD.value))):26===n?e["<>"](e.semigroupArray)(a(30)(4))(e["<>"](e.semigroupArray)(o(1))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(2)(i.DD.value)))):27===n?e["<>"](e.semigroupArray)(a(1)(2))(t(2)):28===n?e["<>"](e.semigroupArray)(a(30)(3))(t(3)):29===n?e["<>"](e.semigroupArray)(a(50)(3))(t(3)):30===n?e["<>"](e.semigroupArray)(a(55)(4))(t(4)):31===n?e["<>"](e.semigroupArray)(a(60)(4))(e["<>"](e.semigroupArray)(u(200))(t(4))):32===n?e["<>"](e.semigroupArray)(a(5)(3))(e["<>"](e.semigroupArray)(r(1)(i.CT.value))(e["<>"](e.semigroupArray)(r(2)(i.DD.value))([new f(new c([i.CT.value]))]))):33===n?e["<>"](e.semigroupArray)(a(1)(2))(r(2)(i.DD.value)):34===n?e["<>"](e.semigroupArray)(a(1)(2))(r(2)(i.DD.value)):35===n?e["<>"](e.semigroupArray)(a(40)(6))(e["<>"](e.semigroupArray)(o(2))(e["<>"](e.semigroupArray)(r(1)(i.CA.value))(r(1)(i.DD.value)))):36===n?e["<>"](e.semigroupArray)(a(30)(6))(e["<>"](e.semigroupArray)(r(2)(i.AV.value))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(r(1)(i.DD.value)))):37===n?e["<>"](e.semigroupArray)(a(50)(6))(e["<>"](e.semigroupArray)(u(200))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(e["<>"](e.semigroupArray)(r(5)(i.DD.value))([new m(4)])))):38===n?e["<>"](e.semigroupArray)(a(65)(6))(e["<>"](e.semigroupArray)(u(240))(e["<>"](e.semigroupArray)(r(5)(i.DD.value))([new m(4),new v(8)]))):39===n?e["<>"](e.semigroupArray)(a(3)(5))(e["<>"](e.semigroupArray)(u(180))(e["<>"](e.semigroupArray)(r(1)(i.AS.value))(t(4)))):40===n?e["<>"](e.semigroupArray)(a(25)(6))(e["<>"](e.semigroupArray)(u(150))(e["<>"](e.semigroupArray)(r(1)(i.CL.value))(e["<>"](e.semigroupArray)(r(2)(i.AV.value))(e["<>"](e.semigroupArray)(r(2)(i.DD.value))([new f(new c([i.CL.value]))]))))):[]},h=function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.stype=i.readSType(n.stype),e},y=e.map(e.functorArray)(h),P=function(n){if(n instanceof l)return"ship level should be at least "+e.show(e.showInt)(n.value0);if(n instanceof c)return"ship should have one of the following type: "+a.joinWith(",")(e.map(e.functorArray)(i.showSType)(n.value0));throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 28, column 28 - line 33, column 1: "+[n.constructor.name])},g=function(n){if(n instanceof f)return"flagship: "+P(n.value0);if(n instanceof s)return"fleet level sum should be at least "+e.show(e.showInt)(n.value0);if(n instanceof v)return"fleet should have at least "+(e.show(e.showInt)(n.value0)+" drum(s)");if(n instanceof m)return"at least "+(e.show(e.showInt)(n.value0)+" ship(s) should have drum(s)");if(n instanceof p)return"require at least "+(e.show(e.showInt)(n.value0)+(" ship(s) of the following type: "+a.joinWith(",")(e.map(e.functorArray)(i.showSType)(n.value1))));if(n instanceof d)return"fleet should have at least "+(e.show(e.showInt)(n.value0)+" ship(s)");throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 34, column 29 - line 43, column 1: "+[n.constructor.name])},w=e.map(e.functorArray)(g),C=function(n){return function(t){if(n instanceof l)return t.level>=n.value0;if(n instanceof c)return r.any(r.foldableArray)(e.booleanAlgebraBoolean)(o.eqSType(t.stype))(n.value0);throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 68, column 19 - line 72, column 1: "+[n.constructor.name])}},D=function(n){return function(a){var o=function(n){return function(e){return t.length(t.filter(n)(e))}},i=t.uncons(a);if(i instanceof u.Just){if(n instanceof f)return C(n.value0)(i.value0.head);if(n instanceof s)return r.sum(r.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.level})(a))>=n.value0;if(n instanceof v)return r.sum(r.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.drumCount})(a))>=n.value0;if(n instanceof m)return o(function(n){return n.drumCount>0})(a)>=n.value0;if(n instanceof p)return o(C(new c(n.value1)))(a)>=n.value0;if(n instanceof d)return t.length(a)>=n.value0;throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 74, column 36 - line 81, column 5: "+[n.constructor.name])}if(i instanceof u.Nothing)return!1;throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 73, column 24 - line 82, column 3: "+[i.constructor.name])}},b=function(n){return function(e){var r=S(n);return t.filter(function(n){return!D(n)(e)})(r)}};n.Flagship=f,n.FleetLevel=s,n.FleetDrum=v,n.FleetShipWithDrum=m,n.FleetSTypeCount=p,n.FleetShipCount=d,n.ShipLevel=l,n.ShipTypeOneOf=c,n.explainRequirements=w,n.unsatisfiedRequirements=b,n.getExpeditionRequirement=S,n.checkFleet=D,n.checkShip=C,n.fromRawFleet=y,n.fromRawShip=h,n.explainFleetRequirement=g,n.explainShipRequirement=P}(PS["KanColle.Expedition.Requirement"]=PS["KanColle.Expedition.Requirement"]||{}),function(n){"use strict";var e=PS["Data.Array"],t=function(n){return function(e){return function(t){return{fuel:n(e.fuel)(t.fuel),ammo:n(e.ammo)(t.ammo),steel:n(e.steel)(t.steel),bauxite:n(e.bauxite)(t.bauxite)}}}},r=function(n){return{fuel:n,ammo:n,steel:n,bauxite:n}},u=function(n){return function(e){return{fuel:n(e.fuel),ammo:n(e.ammo),steel:n(e.steel),bauxite:n(e.bauxite)}}},a=e[".."](1)(40);n.allExpeditionIds=a,n.mapResourceRows=u,n.resourceRowsLiftOp=t,n.resourceRowsFill=r}(PS["KanColle.Expedition.Base"]=PS["KanColle.Expedition.Base"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["KanColle.Expedition.Base"],r=PS["Data.Monoid"],u=function(n){return n},a=u,o=new e.Semigroup(function(n){return function(r){return t.resourceRowsLiftOp(e["+"](e.semiringInt))(n)(r)}}),i=new r.Monoid(function(){return o},t.resourceRowsFill(0)),l=function(n){return function(e){return function(t){return function(r){return{fuel:n,ammo:e,steel:t,bauxite:r}}}}},c=function(n){return n},f=function(n){return 1===n?l(0)(30)(0)(0):2===n?l(0)(100)(30)(0):3===n?l(30)(30)(40)(0):4===n?l(0)(60)(0)(0):5===n?l(200)(200)(20)(20):6===n?l(0)(0)(0)(80):7===n?l(0)(0)(50)(30):8===n?l(50)(100)(50)(50):9===n?l(350)(0)(0)(0):10===n?l(0)(50)(0)(30):11===n?l(0)(0)(0)(250):12===n?l(50)(250)(200)(50):13===n?l(240)(300)(0)(0):14===n?l(0)(240)(200)(0):15===n?l(0)(0)(300)(400):16===n?l(500)(500)(200)(200):17===n?l(70)(70)(50)(0):18===n?l(0)(0)(300)(100):19===n?l(400)(0)(50)(30):20===n?l(0)(0)(150)(0):21===n?l(320)(270)(0)(0):22===n?l(0)(10)(0)(0):23===n?l(0)(20)(0)(100):24===n?l(500)(0)(0)(150):25===n?l(900)(0)(500)(0):26===n?l(0)(0)(0)(900):27===n?l(0)(0)(800)(0):28===n?l(0)(0)(900)(350):29===n?l(0)(0)(0)(100):30===n?l(0)(0)(0)(100):31===n?l(0)(30)(0)(0):32===n?l(50)(50)(50)(50):33===n?r.mempty(i):34===n?r.mempty(i):35===n?l(0)(0)(240)(280):36===n?l(480)(0)(200)(200):37===n?l(0)(380)(270)(0):38===n?l(420)(0)(200)(0):39===n?l(0)(0)(300)(0):40===n?l(300)(300)(0)(100):r.mempty(i)};n.getExpeditionIncomeBase=f,n.getIncomeBase=c,n.mkIncomeBase=a,n.incomeSemigroup=o,n.incomeMonoid=i}(PS["KanColle.Expedition.IncomeBase"]=PS["KanColle.Expedition.IncomeBase"]||{}),function(n){"use strict";var e=(PS.Prelude,PS["Data.Int"]),t={fuel:0,ammo:0,time:0},r=function(n){var r=function(n){return e.toNumber(10*n|0)/100},u=function(n){return 60*n|0},a=function(n){return function(e){return(60*n|0)+e|0}},o=function(n){return function(e){return function(t){return{fuel:r(n),ammo:r(e),time:t}}}};return 1===n?o(3)(0)(15):2===n?o(5)(0)(30):3===n?o(3)(2)(20):4===n?o(5)(0)(50):5===n?o(5)(0)(a(1)(30)):6===n?o(3)(2)(40):7===n?o(5)(0)(u(1)):8===n?o(5)(2)(u(3)):9===n?o(5)(0)(u(4)):10===n?o(3)(0)(a(1)(30)):11===n?o(5)(0)(u(5)):12===n?o(5)(0)(u(8)):13===n?o(5)(4)(u(4)):14===n?o(5)(0)(u(6)):15===n?o(5)(4)(u(12)):16===n?o(5)(4)(u(15)):17===n?o(3)(4)(45):18===n?o(5)(2)(u(5)):19===n?o(5)(4)(u(6)):20===n?o(5)(4)(u(2)):21===n?o(8)(7)(a(2)(20)):22===n?o(8)(7)(u(3)):23===n?o(8)(8)(u(4)):24===n?o(9)(6)(a(8)(20)):25===n?o(5)(8)(u(40)):26===n?o(8)(8)(u(80)):27===n?o(8)(8)(u(20)):28===n?o(8)(8)(u(25)):29===n?o(9)(4)(u(24)):30===n?o(9)(7)(u(48)):31===n?o(5)(0)(u(2)):32===n?o(9)(3)(u(24)):33===n?o(5)(8)(15):34===n?o(5)(8)(30):35===n?o(8)(8)(u(7)):36===n?o(8)(8)(u(9)):37===n?o(8)(8)(a(2)(45)):38===n?o(8)(8)(a(2)(55)):39===n?o(9)(9)(u(30)):40===n?o(8)(7)(a(6)(50)):t},u=function(n){return function(t){return{fuel:e.floor(e.toNumber(t.fuel)*n.fuel),ammo:e.floor(e.toNumber(t.ammo)*n.ammo)}}};n.getExpeditionCost=r,n.calcCost=u}(PS["KanColle.Expedition.Cost"]=PS["KanColle.Expedition.Cost"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Array"],r=PS["KanColle.Expedition.Requirement"],u=PS["KanColle.Expedition.IncomeBase"],a=PS["KanColle.Expedition.Cost"],o=PS["KanColle.Expedition.Base"],i=function(n){return!t["null"](r.getExpeditionRequirement(n))},l=function(n){return{id:n,req:r.getExpeditionRequirement(n),income:u.getExpeditionIncomeBase(n),cost:a.getExpeditionCost(n)}},c=function(n){return function(e){return i(n)&&t["null"](r.unsatisfiedRequirements(n)(e))}},f=function(n){return t.filter(function(e){return c(e)(n)})(o.allExpeditionIds)},s=e.map(e.functorArray)(l)(o.allExpeditionIds);n.allExpeditions=s,n.getExpeditionInfo=l,n.checkExpedition=c,n.getAvailableExpeditions=f,n.validExpeditionId=i}(PS["KanColle.Expedition"]=PS["KanColle.Expedition"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Monoid"],r=PS["Data.Array"],u=PS["Data.Array.Unsafe"],a=PS["Data.Foldable"],o=PS["Data.String"],i=(PS["KanColle.SType"],PS["KanColle.Expedition.Base"]),l=PS["KanColle.Expedition.Cost"],c=(PS["KanColle.Expedition.Requirement"],PS["KanColle.Util"]),f=PS["Data.Maybe"],s=PS["KanColle.Generated.SType"],v=function(n){return n},m=function(n){var t=r.mapMaybe(function(n){return n.note})(n),a=r["null"](t);if(a)return"<N/A>";if(!a){var i=function(n){return"{"+(u.head(n)+("}x"+e.show(e.showInt)(r.length(n))))},l=e.map(e.functorArray)(i)(r.group(e.eqString)(t));return o.joinWith(", ")(l)}throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 196, column 20 - line 202, column 3: "+[a.constructor.name])},p=function(n){return n},d=new e.Semigroup(function(n){return function(t){return{shipCost:e["<>"](e.semigroupArray)(n.shipCost)(t.shipCost),fleet:e["<>"](e.semigroupArray)(n.fleet)(t.fleet)}}}),S=new t.Monoid(function(){return d},{shipCost:t.mempty(t.monoidArray),fleet:t.mempty(t.monoidArray)}),h=function(n){return{ammo:400,morale:100,stype:n,level:150,drumCount:4,note:f.Nothing.value}},y=function(n){return function(e){return function(t){return{shipCost:[{fuel:e,ammo:t}],fleet:[h(n)]}}}},P=function(n){return function(e){var t={};for(var r in h(n))h(n).hasOwnProperty(r)&&(t[r]=h(n)[r]);return t.note=new f.Just(e),t}},g=function(n){return function(e){return function(t){return function(r){return{shipCost:[{fuel:e,ammo:t}],fleet:[P(n)(r)]}}}}},w=g(s.CT.value)(35)(20)(""),C=function(n){var t=g(s.SS.value)(10)(20)("SS"),r=g(s.SS.value)(10)(10)("");
return 1===n?r:e["<>"](d)(r)(c.times(S)(n-1)(t))},D=function(n){return function(t){var u=r.length(t.fleet),a=u>=n;if(a)return t;if(!a)return e["<>"](d)(t)(C(n-u));throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 140, column 25 - line 143, column 3: "+[a.constructor.name])}},b=g(s.AS.value)(35)(10)(""),A=function(n){var e=g(s.DD.value)(15)(15)("(/)");return c.times(S)(n)(e)},E=function(n){var t=g(s.CVL.value)(35)(35)(""),r=g(s.CVL.value)(25)(25)("");return 1===n?r:e["<>"](d)(r)(c.times(S)(n-1)(t))},F=function(n){var t=g(s.CL.value)(25)(20)(""),r=g(s.CL.value)(25)(25)(""),u=2>=n;if(u)return c.times(S)(n)(t);if(!u)return e["<>"](d)(c.times(S)(2)(t))(c.times(S)(n-2)(r));throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 123, column 12 - line 126, column 3: "+[u.constructor.name])},M=function(n){return c.times(S)(n)(g(s.CA.value)(35)(50)("/"))},_=function(n){var e=g(s.BBV.value)(95)(105)("/");return c.times(S)(n)(e)},I=function(n){var t=g(s.AV.value)(35)(35)("/"),r=g(s.AV.value)(50)(10)(""),u=3>=n;if(u)return c.times(S)(n)(t);if(!u)return e["<>"](d)(c.times(S)(3)(t))(r);throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 98, column 12 - line 104, column 3: "+[u.constructor.name])},T=function(n){return 1===n?D(2)(t.mempty(S)):2===n?D(4)(t.mempty(S)):3===n?D(3)(t.mempty(S)):4===n?e["<>"](d)(F(1))(A(2)):5===n?D(4)(e["<>"](d)(F(1))(A(2))):6===n?D(4)(t.mempty(S)):7===n?D(6)(t.mempty(S)):8===n?D(6)(t.mempty(S)):9===n?D(4)(e["<>"](d)(F(1))(A(2))):10===n?D(3)(F(2)):11===n?D(4)(A(2)):12===n?D(4)(A(2)):13===n?D(6)(e["<>"](d)(F(1))(A(4))):14===n?D(6)(e["<>"](d)(F(1))(A(3))):15===n?D(6)(e["<>"](d)(E(2))(A(2))):16===n?D(6)(e["<>"](d)(F(1))(A(2))):17===n?D(6)(e["<>"](d)(F(1))(A(3))):18===n?D(6)(e["<>"](d)(E(3))(A(2))):19===n?D(6)(e["<>"](d)(_(2))(A(2))):20===n?e["<>"](d)(C(1))(F(1)):21===n?e["<>"](d)(F(1))(A(4)):22===n?D(6)(e["<>"](d)(M(1))(e["<>"](d)(F(1))(A(2)))):23===n?D(6)(e["<>"](d)(_(2))(A(2))):24===n?D(6)(e["<>"](d)(F(1))(A(4))):25===n?e["<>"](d)(M(2))(A(2)):26===n?e["<>"](d)(E(1))(e["<>"](d)(F(1))(A(2))):27===n?C(2):28===n?C(3):29===n?C(3):30===n?C(4):31===n?C(4):32===n?e["<>"](d)(w)(A(2)):33===n?A(2):34===n?A(2):35===n?D(6)(e["<>"](d)(E(2))(e["<>"](d)(M(1))(A(1)))):36===n?D(6)(e["<>"](d)(I(2))(e["<>"](d)(F(1))(A(1)))):37===n?e["<>"](d)(F(1))(A(5)):38===n?D(6)(A(5)):39===n?e["<>"](d)(b)(C(4)):40===n?D(6)(e["<>"](d)(F(1))(e["<>"](d)(I(2))(A(2)))):t.mempty(S)},N=function(){var n=function(n){var t=p(T(n)),r=m(t.fleet),u=l.getExpeditionCost(n),i=e.map(e.functorArray)(function(n){return l.calcCost(u)(n)})(t.shipCost),c=a.sum(a.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.fuel})(i)),f=a.sum(a.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.ammo})(i));return o.joinWith(" | ")([e.show(e.showInt)(n),e.show(e.showInt)(c),e.show(e.showInt)(f),r])},t=e.map(e.functorArray)(n)(i.allExpeditionIds),r="Expedition Id | Fuel | Ammo | Minimal Cost Fleet Composition\n --- | --- | --- | ---";return r+("\n"+o.joinWith("\n")(t))}();n.ECost=v,n.minimalCostMarkdownTable=N,n.pprFleetNotes=m,n.getExpeditionMinCost=T,n.fillSS=D,n.katori=w,n.taigei=b,n.clCost=F,n.caCost=M,n.bbvCost=_,n.avCost=I,n.cvlCost=E,n.ssCost=C,n.ddCost=A,n.mkECostWithNote=g,n.mkECost=y,n.shipWithNote=P,n.dummyShip=h,n.getECost=p,n.eCostSemigroup=d,n.eCostMonoid=S}(PS["KanColle.Expedition.Minimal"]=PS["KanColle.Expedition.Minimal"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Array"],r=PS["Data.Int"],u=PS["Data.Function"],a=PS["Data.Foldable"],o=PS["KanColle.Expedition.Base"],i=PS["KanColle.Expedition.IncomeBase"],l=PS["KanColle.Expedition.Minimal"],c=PS["KanColle.Expedition.Cost"],f=function(n){return function(e){var t=i.getIncomeBase(e);return n(t.fuel)(t.ammo)(t.steel)(t.bauxite)}},s=function(n){var t=function(t){return e.show(e.showNumber)(r.toNumber(t)/(r.toNumber(c.getExpeditionCost(n.eId).time)/60))},u=i.getIncomeBase(n.netIncome);return"Expedition #"+(e.show(e.showInt)(n.eId)+(": "+(t(u.fuel)+(" | "+(t(u.ammo)+(" | "+(t(u.steel)+(" | "+(t(u.bauxite)+(" | "+e.show(e.showNumber)(n.score)))))))))))},v=function(n){return function(t){return function(r){var u=e[">="](n)(t)(r);if(u)return t;if(!u)return r;throw new Error("Failed pattern match at KanColle.Expedition.Evaluate line 44, column 14 - line 46, column 1: "+[u.constructor.name])}}},m=r.floor,p=function(n){return r.toNumber(n)/60},d=function(n){return function(t){return function(u){var o=i.getIncomeBase(t),l=e.map(e.functorArray)(function(e){return m(r.toNumber(e.fuel)*n.fuel)})(u.shipCost),c=e.map(e.functorArray)(function(e){return m(r.toNumber(e.ammo)*n.ammo)})(u.shipCost);return i.mkIncomeBase({fuel:o.fuel-a.sum(a.foldableArray)(e.semiringInt)(l),ammo:o.ammo-a.sum(a.foldableArray)(e.semiringInt)(c),steel:o.steel,bauxite:o.bauxite})}}},S=function(n){var e=i.getIncomeBase(n.netIncome),t=function(e){return r.toNumber(e)/p(n.time)};return{eId:n.eId,result:[t(e.fuel),t(e.ammo),t(e.steel),t(e.bauxite),n.score]}},h=function(n){return function(t){return function(r){return function(u){return e.compare(n)(t(r))(t(u))}}}},y=function(n){var u=h(e.ordNumber)(function(n){return n.score}),a=function(e){var t=c.getExpeditionCost(e),u=d(t)(i.getExpeditionIncomeBase(e))(l.getExpeditionMinCost(e)),a=r.toNumber(n(u))/p(t.time);return{eId:e,netIncome:u,time:t.time,score:a}},f=e.map(e.functorArray)(a)(o.allExpeditionIds);return t.sortBy(e.flip(u))(f)},P=function(n){return e.map(e.functorArray)(S)(y(f(u.runFn4(n))))},g=function(n){return function(u){return function(a){var f=h(e.ordNumber)(function(n){return n.score}),s=function(t){var o=c.getExpeditionCost(t),f=u*r.toNumber(v(e.ordInt)(0)(o.time-a)),s=v(e.ordInt)(o.time)(a),m=d(o)(i.getExpeditionIncomeBase(t))(l.getExpeditionMinCost(t)),S=r.toNumber(n(m))/p(s),h=S-f;return{eId:t,netIncome:m,time:s,score:h}},m=e.map(e.functorArray)(s)(o.allExpeditionIds);return t.sortBy(e.flip(f))(m)}}},w=function(n){return function(t){return function(r){return e.map(e.functorArray)(S)(g(f(u.runFn4(n)))(t)(r))}}},C=u.mkFn3(w);n.evalNetIncomeWithAfkMinutesJS=C,n["evalNetIncomeWithAfkMinutesJS'"]=w,n.evalNetIncomeHourlyJS=P,n.simpleEvalCost=f,n.evalResultToJS=S,n.showEvalResult=s,n.sortWithAfkTime=g,n.sortByHourlyGain=y,n.comparing=h,n.minToHour=p,n.ordMax=v,n.incomeDiff=d,n.nToFloor=m}(PS["KanColle.Expedition.Evaluate"]=PS["KanColle.Expedition.Evaluate"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["KanColle.Expedition.Base"],r=PS["KanColle.Expedition.IncomeBase"],u=PS["Data.Int"],a=function(n){return function(e){var a=function(){var e=n.landingCraft>=4;if(e)return 4;if(!e)return n.landingCraft;throw new Error("Failed pattern match at KanColle.Expedition.GrossIncome line 42, column 9 - line 45, column 5: "+[e.constructor.name])}(),o=1+.05*u.toNumber(a),i=r.getIncomeBase(e),l=function(){if(n.greatSuccess)return 1.5;if(!n.greatSuccess)return 1;throw new Error("Failed pattern match at KanColle.Expedition.GrossIncome line 46, column 16 - line 47, column 5: "+[n.greatSuccess.constructor.name])}(),c=function(n){return function(n){return u.floor(function(n){return n*l}(n))}(function(n){return n*o}(u.toNumber(n)))};return t.mapResourceRows(c)(i)}},o=function(n){return"GrossIncome ("+(e.show(e.showInt)(n.fuel)+(", "+(e.show(e.showInt)(n.ammo)+(", "+(e.show(e.showInt)(n.steel)+(", "+(e.show(e.showInt)(n.bauxite)+")")))))))},i=function(n){return n},l={greatSuccess:!1,landingCraft:0},c=a(l);n.showGrossIncome=o,n.toGrossIncome=c,n.withFactorToGrossIncome=a,n.getGrossIncome=i}(PS["KanColle.Expedition.GrossIncome"]=PS["KanColle.Expedition.GrossIncome"]||{}),function(n){"use strict";n.unsafeToFixed=function(n){return function(e){return function(){return e.toFixed(n)}}}}(PS["Number.Format.Unsafe"]=PS["Number.Format.Unsafe"]||{}),function(n){"use strict";var e=PS["Number.Format.Unsafe"];PS["Control.Monad.Eff"];n.unsafeToFixed=e.unsafeToFixed}(PS["Number.Format.Unsafe"]=PS["Number.Format.Unsafe"]||{}),function(n){"use strict";var e=PS["Control.Monad.Eff"],t=PS["Control.Monad.Eff.Exception"],r=PS["Data.Maybe"],u=PS["Number.Format.Unsafe"],a=PS.Prelude,o=t.catchException(function(n){return a["return"](e.applicativeEff)(a["const"](r.Nothing.value)(n))}),i=function(n){return function(t){return e.runPure(o(a["<$>"](e.functorEff)(r.Just.create)(u.unsafeToFixed(n)(t))))}};n.toFixed=i}(PS["Number.Format"]=PS["Number.Format"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["KanColle.Expedition.Evaluate"],r=PS["KanColle.Expedition.IncomeBase"],u=PS["KanColle.Expedition.Cost"],a=PS["KanColle.Expedition.Minimal"],o=PS["KanColle.Expedition.Base"],i=PS["Data.Maybe"],l=PS["Number.Format"],c=PS["Data.String"],f=PS["Data.Int"],s=PS["Data.Foldable"],v=PS["Data.Monoid"],m=function(n){var t=r.getIncomeBase(n.netIncome);return c.joinWith(" | ")([e.show(e.showInt)(n.eId),e.show(e.showInt)(t.fuel),e.show(e.showInt)(t.ammo),e.show(e.showInt)(t.steel),e.show(e.showInt)(t.bauxite)])},p=function(n){var t=function(n){return i.fromMaybe("ERR")(l.toFixed(3)(n))};return c.joinWith(" | ")([e.show(e.showInt)(n.eId),t(n.hourly.fuel),t(n.hourly.ammo),t(n.hourly.steel),t(n.hourly.bauxite)])},d=function(){var n=function(n){var e=a.getExpeditionMinCost(n),o=r.getExpeditionIncomeBase(n),i=u.getExpeditionCost(n),l=t.incomeDiff(i)(o)(e);return{eId:n,netIncome:l}};return e.map(e.functorArray)(n)(o.allExpeditionIds)}(),S=function(n){var a=function(a){var o=t.ordMax(e.ordInt)(u.getExpeditionCost(a.eId).time)(n),i=function(n){return f.toNumber(n)/(f.toNumber(o)/60)},l=r.getIncomeBase(a.netIncome);return{eId:a.eId,hourly:{fuel:i(l.fuel),ammo:i(l.ammo),steel:i(l.steel),bauxite:i(l.bauxite)}}};return e.map(e.functorArray)(a)(d)},h=function(n){return function(t){return function(r){return{eIds:s.foldMap(t)(v.monoidArray)(function(n){return[n.eId]})(r),hourly:{fuel:s.sum(t)(e.semiringNumber)(e.map(n)(function(n){return n.hourly.fuel})(r)),ammo:s.sum(t)(e.semiringNumber)(e.map(n)(function(n){return n.hourly.ammo})(r)),steel:s.sum(t)(e.semiringNumber)(e.map(n)(function(n){return n.hourly.steel})(r)),bauxite:s.sum(t)(e.semiringNumber)(e.map(n)(function(n){return n.hourly.bauxite})(r))}}}}};n.showNetHourlyIncome=p,n.netIncomeWithAfkTime=S,n.showNetIncome=m,n.netIncomeTable=d,n.mergeHNetIncome=h}(PS["KanColle.Expedition.NetIncome"]=PS["KanColle.Expedition.NetIncome"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["KanColle.Expedition.NetIncome"],r=PS["Data.Array"],u=PS["Data.Traversable"],a=PS["Data.Function"],o=PS["Data.String"],i=PS["Number.Format"],l=PS["Data.Maybe"],c=PS["KanColle.Util"],f=PS["Control.Monad.Eff.Console"],s=PS["Control.Monad.Eff"],v=PS["Data.List"],m=PS["Data.Foldable"],p=function(n){var t=function(n){return l.fromMaybe("ERR")(i.toFixed(3)(n))};return o.joinWith(" | ")([e.show(e.showArray(e.showInt))(n.eIds),t(n.hourly.fuel),t(n.hourly.ammo),t(n.hourly.steel),t(n.hourly.bauxite),t(n.resourceScore)])},d=function(n){return function(u){return function(o){return function(i){return function(f){return function(s){return function(p){var d=function(n){return l.isJust(r.elemIndex(e.eqInt)(n.eId)(p))},S=function(n){var e=n.hourly.fuel*u+n.hourly.ammo*o+n.hourly.steel*i+n.hourly.bauxite*f;return{eIds:n.eIds,hourly:n.hourly,resourceScore:e-0}},h=t.netIncomeWithAfkTime(s),y=r.filter(d)(h),P=e.map(e.functorArray)(function(n){return S(t.mergeHNetIncome(v.functorList)(v.foldableList)(n))})(c.chooseN(m.foldableArray)(y)(n));return r.sortBy(a.on(e.flip(e.compare(e.ordNumber)))(function(n){return n.resourceScore}))(P)}}}}}}},S=a.mkFn7(d),h=d(3),y=a.mkFn6(h),P=function(n){return function(u){return function(o){return function(i){return function(l){return function(f){return function(s){var p=function(n){var e=n.hourly.fuel*o+n.hourly.ammo*i+n.hourly.steel*l+n.hourly.bauxite*f;return{eIds:n.eIds,hourly:n.hourly,resourceScore:e-0*u}},d=e.map(e.functorArray)(function(n){return p(t.mergeHNetIncome(v.functorList)(v.foldableList)(n))})(c.chooseN(m.foldableArray)(t.netIncomeWithAfkTime(s))(n));return r.sortBy(a.on(e.flip(e.compare(e.ordNumber)))(function(n){return n.resourceScore}))(d)}}}}}}},g=P(3),w=function(n){return function(t){return function(a){return function(o){return function(i){return function(l){return function(){return e["void"](s.functorEff)(u.traverse(u.traversableArray)(s.applicativeEff)(function(n){return f.log(p(n))})(r.take(50)(g(l)(n)(t)(a)(o)(i))))(),e.unit}}}}}}},C=function(n){return function(e){return function(t){return function(u){return function(a){return r.take(50)(g(0)(n)(e)(t)(u)(a))}}}}},D=a.mkFn5(C);n.calcWithExpeditionIdsFleetCountJS=S,n.calcWithExpeditionIdsJS=y,n.calcWithExpeditionIdsFleetCount=d,n.calcWithExpeditionIds=h,n.quickCalcJS=D,n.quickCalc=C,n.dbg=w,n.showNI=p,n.calcNetIncomeWithFleetCount=P,n.calcNetIncome=g}(PS["KanColle.Expedition.Plan"]=PS["KanColle.Expedition.Plan"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Foldable"],r=PS["Data.Maybe"],u=PS["Data.Array"],a=PS["Data.Nullable"],o=PS["KanColle.SType"],i=PS["KanColle.Expedition.Base"],l=PS["KanColle.Expedition.Requirement"],c=PS["KanColle.Generated.SType"],f=function(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e.flagShipTypeOf=a.toNullable(n.flagShipTypeOf),e.levelCount=a.toNullable(n.levelCount),e.drumCount=a.toNullable(n.drumCount),e.drumCarrierCount=a.toNullable(n.drumCarrierCount),e},s=function(n){var t=function(n){return{stypeReqCount:n.stypeReqCount,stypeOneOf:e.map(e.functorArray)(c.showSType)(n.stypeOneOf)}};return{flagShipLevel:n.flagShipLevel,shipCount:n.shipCount,flagShipTypeOf:a.toNullable(e.map(r.functorMaybe)(e.map(e.functorArray)(c.showSType))(n.flagShipTypeOf)),levelCount:a.toNullable(n.levelCount),drumCount:a.toNullable(n.drumCount),drumCarrierCount:a.toNullable(n.drumCarrierCount),fleetSType:e.map(e.functorArray)(t)(n.fleetSType)}},v={flagShipLevel:1,shipCount:1,flagShipTypeOf:r.Nothing.value,levelCount:r.Nothing.value,drumCount:r.Nothing.value,drumCarrierCount:r.Nothing.value,fleetSType:[]},m=function(){var n=function(n){return function(e){if(e instanceof l.Flagship){if(e.value0 instanceof l.ShipLevel){var t={};for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a]);return t.flagShipLevel=e.value0.value0,t}if(e.value0 instanceof l.ShipTypeOneOf){var o={};for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i]);return o.flagShipTypeOf=new r.Just(e.value0.value0),o}throw new Error("Failed pattern match at KanColle.Expedition.RequirementObject line 72, column 11 - line 75, column 9: "+[e.value0.constructor.name])}if(e instanceof l.FleetLevel){var c={};for(var f in n)n.hasOwnProperty(f)&&(c[f]=n[f]);return c.levelCount=new r.Just(e.value0),c}if(e instanceof l.FleetDrum){var s={};for(var v in n)n.hasOwnProperty(v)&&(s[v]=n[v]);return s.drumCount=new r.Just(e.value0),s}if(e instanceof l.FleetShipWithDrum){var m={};for(var p in n)n.hasOwnProperty(p)&&(m[p]=n[p]);return m.drumCarrierCount=new r.Just(e.value0),m}if(e instanceof l.FleetSTypeCount){var d={stypeReqCount:e.value0,stypeOneOf:e.value1},S={};for(var h in n)n.hasOwnProperty(h)&&(S[h]=n[h]);return S.fleetSType=u.snoc(n.fleetSType)(d),S}if(e instanceof l.FleetShipCount){var y={};for(var P in n)n.hasOwnProperty(P)&&(y[P]=n[P]);return y.shipCount=e.value0,y}throw new Error("Failed pattern match at KanColle.Expedition.RequirementObject line 70, column 29 - line 85, column 1: "+[e.constructor.name])}};return t.foldl(t.foldableArray)(n)(v)}(),p=function(n){return m(l.getExpeditionRequirement(n))},d=function(n){return s(p(n))},S=function(n){return function(a){var i=function(n){return function(e){return u.length(u.filter(n)(e))}},l=function(n){return t.any(t.foldableArray)(e.booleanAlgebraBoolean)(o.eqSType(n))},c=u.uncons(a);if(c instanceof r.Just){var f=c.value0.head.level>=n.flagShipLevel;return{flagShipLevel:f,shipCount:u.length(a)>=n.shipCount,flagShipTypeOf:e.map(r.functorMaybe)(l(c.value0.head.stype))(n.flagShipTypeOf),levelCount:e.map(r.functorMaybe)(function(n){return t.sum(t.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.level})(a))>=n})(n.levelCount),drumCount:e.map(r.functorMaybe)(function(n){return t.sum(t.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.drumCount})(a))>=n})(n.drumCount),drumCarrierCount:e.map(r.functorMaybe)(function(n){return i(function(n){return n.drumCount>0})(a)>=n})(n.drumCarrierCount),fleetSType:e.map(e.functorArray)(function(n){return i(function(e){return l(e.stype)(n.stypeOneOf)})(a)>=n.stypeReqCount})(n.fleetSType)}}if(c instanceof r.Nothing){var s=function(n){return e.map(n)(e["const"](!1))};return{flagShipLevel:!1,shipCount:!1,flagShipTypeOf:s(r.functorMaybe)(n.flagShipTypeOf),levelCount:s(r.functorMaybe)(n.levelCount),drumCount:s(r.functorMaybe)(n.drumCount),drumCarrierCount:s(r.functorMaybe)(n.drumCarrierCount),fleetSType:s(e.functorArray)(n.fleetSType)}}throw new Error("Failed pattern match at KanColle.Expedition.RequirementObject line 116, column 38 - line 147, column 3: "+[c.constructor.name])}},h=function(){var n=function(n){return{id:n,val:d(n)}};return e.map(e.functorArray)(n)(i.allExpeditionIds)}();n.resultPackToObject=f,n.checkWithRequirementPack=S,n.getExpeditionRequirementObject=d,n.getExpeditionRequirementPack=p,n.allRequirements=h,n.requirementPackToObj=s,n.fromExpeditionRequirement=m,n.dummyRequirementPack=v}(PS["KanColle.Expedition.RequirementObject"]=PS["KanColle.Expedition.RequirementObject"]||{}),function(n){"use strict";var e=PS.Prelude,t=PS["Data.Maybe"],r=PS["Data.Array"],u=PS["Data.Maybe.Unsafe"],a=PS["Data.Int"],o=PS["Data.Foldable"],i=(PS["KanColle.KCAPI.Master"],PS["Data.StrMap"]),l=PS["Data.List"],c=PS["Data.List.Unsafe"],f=PS["Data.Set"],s=PS["Data.Tuple"],v=PS["Debug.Trace"],m=PS["Data.Unfoldable"],p=PS["Data.Monoid"],d=function(n){return function(t){if(""===n)return t(e.unit);if(e.otherwise)return v.trace(n)(t);throw new Error("Failed pattern match at KanColle.Remodel line 51, column 1 - line 56, column 1: "+[n.constructor.name,t.constructor.name])}},S=function(n){if(n instanceof t.Just)return[n.value0];if(n instanceof t.Nothing)return[];throw new Error("Failed pattern match at KanColle.Remodel line 81, column 1 - line 82, column 1: "+[n.constructor.name])},h=l.toUnfoldable(m.unfoldableArray),y=function(n){return function(a){var o=function(t){return i.lookup(e.show(e.showInt)(t))(n)},f=(u.fromJust(o(a)),function(n){return function(r){var u=n,a=r;n:for(;;){var i=l.elemIndex(e.eqInt)(a)(u);if(i instanceof t.Nothing){var c=new l.Cons(a,u),f=o(a);if(f instanceof t.Nothing)return c;if(f instanceof t.Just){u=c,a=f.value0.shipIdTo;continue n}throw new Error("Failed pattern match at KanColle.Remodel line 138, column 14 - line 141, column 9: "+[f.constructor.name])}if(i instanceof t.Just)return u;throw new Error("Failed pattern match at KanColle.Remodel line 135, column 28 - line 143, column 5: "+[i.constructor.name])}}}),s=f(l.Nil.value)(a),v=r.reverse(h(s)),m=f(l.Nil.value)(c.head(s)),p=r.reverse(h(m));return{origin:a,finalForms:p,group:v}}},P=function(n){var t=i.values(n),r=function(n){return function(t){var r=s.fst(n),u=s.snd(n);return new s.Tuple(f.insert(e.ordInt)(t.shipIdFrom)(r),f.insert(e.ordInt)(t.shipIdTo)(u))}},u=o.foldl(l.foldableList)(r)(new s.Tuple(f.empty,f.empty))(t),a=f.toList(s.uncurry(f.difference(e.ordInt))(u)),c=function(t){return new s.Tuple(e.show(e.showInt)(t),y(n)(t))};return i.fromFoldable(l.foldableList)(e.map(l.functorList)(c)(a))},g=function(n){var t=function(n){return e.map(e.functorArray)(function(t){return new s.Tuple(e.show(e.showInt)(t),n.value1.origin)})(n.value1.group)};return i.fromFoldable(o.foldableArray)(o.foldMap(l.foldableList)(p.monoidArray)(t)(i.toList(n)))},w=function(n){return function(u){var a=r.filter(function(n){return 0!==n.api_current_ship_id})(n),l=function(n){return function(r){var u=e.show(e.showInt)(r.api_current_ship_id),a=function(n){var t=function(){if(n.shipIdTo===r.api_id)return"";if(e.otherwise)return"WARNING: data inconsistent for id: "+e.show(e.showInt)(n.shipIdFrom);throw new Error("Failed pattern match at KanColle.Remodel line 104, column 13 - line 108, column 1: "+[])}();return d(t)(function(e){var t={};for(var u in n)n.hasOwnProperty(u)&&(t[u]=n[u]);return t.catapult=r.api_catapult_count,t.blueprint=r.api_drawing_count,t})};return i.alter(e.map(t.functorMaybe)(a))(u)(n)}};return o.foldl(o.foldableArray)(l)(u)(a)}},C=function(n){if(4500>n)return 0;if(5500>n)return 10;if(6500>n)return 15;if(e.otherwise)return 20;throw new Error("Failed pattern match at KanColle.Remodel line 57, column 1 - line 64, column 1: "+[n.constructor.name])},D=function(n){if(n.api_id>=500||"0"===n.api_aftershipid)return t.Nothing.value;if(e.otherwise){var r={shipIdFrom:n.api_id,shipIdTo:u.fromJust(a.fromString(n.api_aftershipid)),level:n.api_afterlv,steel:n.api_afterfuel,ammo:n.api_afterbull,catapult:0,blueprint:0,devmat:0};return new t.Just(function(){var n={};for(var e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);return n.devmat=C(r.steel),n}())}throw new Error("Failed pattern match at KanColle.Remodel line 65, column 1 - line 80, column 1: "+[n.constructor.name])},b=function(n){var t=o.foldMap(o.foldableArray)(p.monoidArray)(function(n){return S(D(n))})(n),r=function(n){return new s.Tuple(e.show(e.showInt)(n.shipIdFrom),n)};return i.fromFoldable(o.foldableArray)(e.map(e.functorArray)(r)(t))},A=function(n){var e=b(n.api_mst_ship),t=w(n.api_mst_shipupgrade)(e);return t},E=function(n){var e=A(n),t=P(e),u=g(t);return{remodelInfo:e,remodelGroups:t,origins:u,shipCount:r.length(n.api_mst_ship),upgradeCount:r.length(n.api_mst_shipupgrade)}};n.generateRemodelDb=E,n.generateOriginMap=g,n.listToArray=h,n.generateRemodelGroup=y,n.generateRemodelGroups=P,n.collectRemodelInfo=A,n.collectRemodelInfo2=w,n.collectRemodelInfo1=b,n.maybeToArray=S,n.fromMstShip=D,n.calcDevMat=C,n.optTrace=d}(PS["KanColle.Remodel"]=PS["KanColle.Remodel"]||{}),function(n){"use strict";var e=(PS.Prelude,PS.Math),t=PS["Data.Int"],r=(PS["KanColle.SType"],PS["Data.Function"]),u=PS["KanColle.Generated.SType"],a=function(n){if(n instanceof u.SS)return.5;if(n instanceof u.DD)return 1;if(n instanceof u.CL)return 1;if(n instanceof u.CLT)return 1;if(n instanceof u.CT)return 1;if(n instanceof u.AV)return 1;if(n instanceof u.SSV)return 1;if(n instanceof u.LHA)return 1;if(n instanceof u.AO)return 1;if(n instanceof u.CA)return 1.5;if(n instanceof u.CAV)return 1.5;if(n instanceof u.FBB)return 1.5;if(n instanceof u.CVL)return 1.5;if(n instanceof u.AS)return 1.5;if(n instanceof u.BB)return 2;if(n instanceof u.BBV)return 2;if(n instanceof u.CV)return 2;if(n instanceof u.CVB)return 2;if(n instanceof u.AR)return 2;if(n instanceof u.DDE)return 1;if(n instanceof u.XBB)return 2;if(n instanceof u.AP)return 2;if(n instanceof u.Unknown)return 1;throw new Error("Failed pattern match at KanColle.RepairTime line 46, column 1 - line 48, column 1: "+[n.constructor.name])},o=function(n){return function(r){return function(u){return function(o){if(u===o)return 0;var i=o-u,l=function(){var u=11>=r;if(u)return t.toNumber(10*r|0)*a(n)*t.toNumber(i);if(!u){var o=(10*t.floor(e.sqrt(t.toNumber(r-11)))|0)+50|0;return t.toNumber((5*r|0)+o|0)*a(n)*t.toNumber(i)}throw new Error("Failed pattern match at KanColle.RepairTime line 16, column 18 - line 22, column 1: "+[u.constructor.name])}();return t.floor(l)+30|0}}}},i=r.mkFn4(function(n){return o(u.readSType(n))}),l=r.mkFn4(function(n){return o(u.fromInt(n))}),c=function(n){return function(e){return function(r){return function(u){var a=1200,i=a*(u-r)|0,l=o(n)(e)(r)(u),c=t.ceil(t.toNumber(l)/t.toNumber(a))*a|0,f=c>=i;if(f)return i;if(!f)return c;throw new Error("Failed pattern match at KanColle.RepairTime line 29, column 35 - line 32, column 3: "+[f.constructor.name])}}}},f=r.mkFn4(function(n){return c(u.readSType(n))}),s=r.mkFn4(function(n){return c(u.fromInt(n))});n.stypeFactor=a,n.facilityInSecJSNum=s,n.facilityInSecJS=f,n.facilityInSec=c,n.dockingInSecJSNum=l,n.dockingInSecJS=i,n.dockingInSec=o}(PS["KanColle.RepairTime"]=PS["KanColle.RepairTime"]||{});
