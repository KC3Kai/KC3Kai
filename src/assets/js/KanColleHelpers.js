var PS={};!function(n){"use strict";n.arrayMap=function(n){return function(t){for(var e=t.length,r=new Array(e),o=0;e>o;o++)r[o]=n(t[o]);return r}},n.arrayBind=function(n){return function(t){for(var e=[],r=0,o=n.length;o>r;r++)Array.prototype.push.apply(e,t(n[r]));return e}},n.concatArray=function(n){return function(t){return n.concat(t)}},n.intAdd=function(n){return function(t){return n+t|0}},n.intMul=function(n){return function(t){return n*t|0}},n.numAdd=function(n){return function(t){return n+t}},n.numMul=function(n){return function(t){return n*t}},n.refEq=function(n){return function(t){return n===t}},n.unsafeCompareImpl=function(n){return function(t){return function(e){return function(r){return function(o){return o>r?n:r>o?e:t}}}}},n.topInt=2147483647,n.bottomInt=-2147483648,n.boolOr=function(n){return function(t){return n||t}},n.boolAnd=function(n){return function(t){return n&&t}},n.boolNot=function(n){return!n},n.showIntImpl=function(n){return n.toString()},n.showNumberImpl=function(n){return n===(0|n)?n+".0":n.toString()},n.showArrayImpl=function(n){return function(t){for(var e=[],r=0,o=t.length;o>r;r++)e[r]=n(t[r]);return"["+e.join(",")+"]"}}}(PS.Prelude=PS.Prelude||{}),function(n){"use strict";var t=PS.Prelude,e=function(){function n(){}return n.value=new n,n}(),r=function(){function n(){}return n.value=new n,n}(),o=function(){function n(){}return n.value=new n,n}(),u=function(n){this.compose=n},a=function(n,t){this["__superclass_Prelude.Semigroupoid_0"]=n,this.id=t},i=function(n){this.map=n},c=function(n,t){this["__superclass_Prelude.Functor_0"]=n,this.apply=t},l=function(n,t){this["__superclass_Prelude.Apply_0"]=n,this.pure=t},f=function(n,t){this["__superclass_Prelude.Apply_0"]=n,this.bind=t},s=function(n,t){this["__superclass_Prelude.Applicative_0"]=n,this["__superclass_Prelude.Bind_1"]=t},m=function(n){this.append=n},p=function(n,t,e,r){this.add=n,this.mul=t,this.one=e,this.zero=r},d=function(n){this.eq=n},S=function(n,t){this["__superclass_Prelude.Eq_0"]=n,this.compare=t},v=function(n,t){this.bottom=n,this.top=t},y=function(n,t,e,r){this["__superclass_Prelude.Bounded_0"]=n,this.conj=t,this.disj=e,this.not=r},P=function(n){this.show=n},h=function(n){return n.zero},g=t.unsafeCompareImpl(e.value)(o.value)(r.value),C={},b=function(n){return n.top},w=new P(t.showNumberImpl),D=new P(t.showIntImpl),A=function(n){return n.show},M=function(n){return new P(t.showArrayImpl(A(n)))},F=new p(t.numAdd,t.numMul,1,0),E=new p(t.intAdd,t.intMul,1,0),I=new u(function(n){return function(t){return function(e){return n(t(e))}}}),_=new m(t.concatArray),T=function(n){return n.pure},x=function(n){return T(n)},N=!0,k=function(n){return n.one},K=function(n){return n.not},B=function(n){return n.mul},R=function(n){return n.map},V=function(n){return R(n)},L=function(n){return n.id},q=new i(t.arrayMap),O=function(n){return function(t){return function(e){return n(e)(t)}}},U=new d(t.refEq),H=new d(function(n){return function(t){return n instanceof e&&t instanceof e?!0:n instanceof r&&t instanceof r?!0:n instanceof o&&t instanceof o?!0:!1}}),J=new d(t.refEq),j=new S(function(){return J},g),W=new d(t.refEq),z=new S(function(){return W},g),G=function(n){return n.eq},$=function(n){return G(n)},Q=function(n){return n.disj},X=function(n){return function(t){return n}},Y=function(n){return function(t){return V(n)(X(C))(t)}},Z=function(n){return n.conj},nn=function(n){return n.compose},tn=new i(nn(I)),en=function(n){return O(nn(n))},rn=function(n){return n.compare},on=function(n){return function(t){return function(r){var o=rn(n)(t)(r);return o instanceof e?!1:!0}}},un=new a(function(){return I},function(n){return n}),an=new v(t.bottomInt,t.topInt),cn=new v(!1,!0),ln=function(n){return n.bottom},fn=new y(function(){return cn},t.boolAnd,t.boolOr,t.boolNot),sn=function(n){return n.bind},mn=function(n){return sn(n)},pn=new c(function(){return tn},function(n){return function(t){return function(e){return n(e)(t(e))}}}),dn=function(n){return n.apply},Sn=function(n){return dn(n)},vn=function(n){return function(t){return function(e){return Sn(n["__superclass_Prelude.Apply_0"]())(T(n)(t))(e)}}},yn=function(n){return n.append},Pn=function(n){return yn(n)},hn=function(n){return new m(function(t){return function(e){return function(r){return Pn(n)(t(r))(e(r))}}})},gn=function(n){return function(t){return function(e){return sn(n["__superclass_Prelude.Bind_1"]())(t)(function(t){return sn(n["__superclass_Prelude.Bind_1"]())(e)(function(e){return x(n["__superclass_Prelude.Applicative_0"]())(t(e))})})}}},Cn=new s(function(){return Dn},function(){return bn}),bn=new f(function(){return wn},t.arrayBind),wn=new c(function(){return q},gn(Cn)),Dn=new l(function(){return wn},function(n){return[n]}),An=function(n){return n.add},Mn=function(n){return An(n)};n.LT=e,n.GT=r,n.EQ=o,n.Show=P,n.BooleanAlgebra=y,n.Bounded=v,n.Ord=S,n.Eq=d,n.Semiring=p,n.Semigroup=m,n.Monad=s,n.Bind=f,n.Applicative=l,n.Apply=c,n.Functor=i,n.Category=a,n.Semigroupoid=u,n.show=A,n.not=K,n.disj=Q,n.conj=Z,n.bottom=ln,n.top=b,n.unsafeCompare=g,n[">="]=on,n.compare=rn,n["=="]=$,n.eq=G,n["+"]=Mn,n.one=k,n.mul=B,n.zero=h,n.add=An,n["<>"]=Pn,n.append=yn,n.ap=gn,n["return"]=x,n[">>="]=mn,n.bind=sn,n.liftA1=vn,n.pure=T,n["<*>"]=Sn,n.apply=dn,n["void"]=Y,n["<$>"]=V,n.map=R,n.id=L,n[">>>"]=en,n.compose=nn,n.otherwise=N,n["const"]=X,n.flip=O,n.unit=C,n.semigroupoidFn=I,n.categoryFn=un,n.functorFn=tn,n.functorArray=q,n.applyFn=pn,n.applyArray=wn,n.applicativeArray=Dn,n.bindArray=bn,n.monadArray=Cn,n.semigroupFn=hn,n.semigroupArray=_,n.semiringInt=E,n.semiringNumber=F,n.eqInt=W,n.eqNumber=J,n.eqString=U,n.eqOrdering=H,n.ordInt=z,n.ordNumber=j,n.boundedBoolean=cn,n.boundedInt=an,n.booleanAlgebraBoolean=fn,n.showInt=D,n.showNumber=w,n.showArray=M}(PS.Prelude=PS.Prelude||{}),function(n){"use strict";var t=(PS.Prelude,function(n,t){this["__superclass_Prelude.Functor_0"]=n,this.alt=t}),e=function(n){return n.alt};n.Alt=t,n.alt=e}(PS["Control.Alt"]=PS["Control.Alt"]||{}),function(n){"use strict";var t=(PS.Prelude,PS["Control.Alt"],function(n,t){this["__superclass_Control.Alt.Alt_0"]=n,this.empty=t}),e=function(n){return n.empty};n.Plus=t,n.empty=e}(PS["Control.Plus"]=PS["Control.Plus"]||{}),function(n){"use strict";var t=(PS.Prelude,PS["Control.Alt"],PS["Control.Lazy"],PS["Control.Plus"],function(n,t){this["__superclass_Control.Plus.Plus_1"]=n,this["__superclass_Prelude.Applicative_0"]=t});n.Alternative=t}(PS["Control.Alternative"]=PS["Control.Alternative"]||{}),function(n){"use strict";n.returnE=function(n){return function(){return n}},n.bindE=function(n){return function(t){return function(){return t(n())()}}},n.runPure=function(n){return n()}}(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{}),function(n){"use strict";var t=PS["Control.Monad.Eff"],e=PS.Prelude,r=new e.Monad(function(){return a},function(){return o}),o=new e.Bind(function(){return u},t.bindE),u=new e.Apply(function(){return i},e.ap(r)),a=new e.Applicative(function(){return u},t.returnE),i=new e.Functor(e.liftA1(a));n.functorEff=i,n.applyEff=u,n.applicativeEff=a,n.bindEff=o,n.monadEff=r,n.runPure=t.runPure}(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{}),function(n){"use strict";n.log=function(n){return function(){return console.log(n),{}}}}(PS["Control.Monad.Eff.Console"]=PS["Control.Monad.Eff.Console"]||{}),function(n){"use strict";var t=PS["Control.Monad.Eff.Console"];PS.Prelude,PS["Control.Monad.Eff"];n.log=t.log}(PS["Control.Monad.Eff.Console"]=PS["Control.Monad.Eff.Console"]||{}),function(n){"use strict";n.catchException=function(n){return function(t){return function(){try{return t()}catch(e){return e instanceof Error||"[object Error]"===Object.prototype.toString.call(e)?n(e)():n(new Error(e.toString()))()}}}}}(PS["Control.Monad.Eff.Exception"]=PS["Control.Monad.Eff.Exception"]||{}),function(n){"use strict";var t=PS["Control.Monad.Eff.Exception"];PS.Prelude,PS["Control.Monad.Eff"];n.catchException=t.catchException}(PS["Control.Monad.Eff.Exception"]=PS["Control.Monad.Eff.Exception"]||{}),function(n){"use strict";n.newSTRef=function(n){return function(){return{value:n}}},n.readSTRef=function(n){return function(){return n.value}},n.writeSTRef=function(n){return function(t){return function(){return n.value=t}}}}(PS["Control.Monad.ST"]=PS["Control.Monad.ST"]||{}),function(n){"use strict";var t=PS["Control.Monad.ST"];PS.Prelude,PS["Control.Monad.Eff"];n.writeSTRef=t.writeSTRef,n.readSTRef=t.readSTRef,n.newSTRef=t.newSTRef}(PS["Control.Monad.ST"]=PS["Control.Monad.ST"]||{}),function(n){"use strict";var t=PS.Prelude,e=(PS["Control.Alternative"],PS["Control.Plus"]),r=function(n,t){this["__superclass_Control.Alternative.Alternative_1"]=n,this["__superclass_Prelude.Monad_0"]=t},o=function(n){return function(r){if(r)return t["return"](n["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Prelude.Applicative_0"]())(t.unit);if(!r)return e.empty(n["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Control.Plus.Plus_1"]());throw new Error("Failed pattern match at Control.MonadPlus line 35, column 1 - line 36, column 1: "+[r.constructor.name])}};n.MonadPlus=r,n.guard=o}(PS["Control.MonadPlus"]=PS["Control.MonadPlus"]||{}),function(n){"use strict";n.range=function(n){return function(t){for(var e=n>t?-1:1,r=[],o=n,u=0;o!==t;o+=e)r[u++]=o;return r[u]=o,r}},n.replicate=function(n){return function(t){if(1>n)return[];for(var e=new Array(n),r=0;n>r;r++)e[r]=t;return e}},n.length=function(n){return n.length},n.cons=function(n){return function(t){return[n].concat(t)}},n.snoc=function(n){return function(t){var e=n.slice();return e.push(t),e}},n["uncons'"]=function(n){return function(t){return function(e){return 0===e.length?n({}):t(e[0])(e.slice(1))}}},n.indexImpl=function(n){return function(t){return function(e){return function(r){return 0>r||r>=e.length?t:n(e[r])}}}},n.findIndexImpl=function(n){return function(t){return function(e){return function(r){for(var o=0,u=r.length;u>o;o++)if(e(r[o]))return n(o);return t}}}},n._updateAt=function(n){return function(t){return function(e){return function(r){return function(o){if(0>e||e>=o.length)return t;var u=o.slice();return u[e]=r,n(u)}}}}},n.reverse=function(n){return n.slice().reverse()},n.concat=function(n){for(var t=[],e=0,r=n.length;r>e;e++)for(var o=n[e],u=0,a=o.length;a>u;u++)t.push(o[u]);return t},n.filter=function(n){return function(t){return t.filter(n)}},n.sortImpl=function(n){return function(t){return t.slice().sort(function(t,e){return n(t)(e)})}},n.slice=function(n){return function(t){return function(e){return e.slice(n,t)}}},n.zipWith=function(n){return function(t){return function(e){for(var r=t.length<e.length?t.length:e.length,o=new Array(r),u=0;r>u;u++)o[u]=n(t[u])(e[u]);return o}}}}(PS["Data.Array"]=PS["Data.Array"]||{}),function(n){"use strict";n.foldrArray=function(n){return function(t){return function(e){for(var r=t,o=e.length,u=o-1;u>=0;u--)r=n(e[u])(r);return r}}},n.foldlArray=function(n){return function(t){return function(e){for(var r=t,o=e.length,u=0;o>u;u++)r=n(r)(e[u]);return r}}}}(PS["Data.Foldable"]=PS["Data.Foldable"]||{}),function(n){"use strict";var t=PS.Prelude,e=function(n,t){this["__superclass_Prelude.Semigroup_0"]=n,this.mempty=t},r=new e(function(){return t.semigroupArray},[]),o=function(n){return n.mempty},u=function(n){return new e(function(){return t.semigroupFn(n["__superclass_Prelude.Semigroup_0"]())},t["const"](o(n)))};n.Monoid=e,n.mempty=o,n.monoidFn=u,n.monoidArray=r}(PS["Data.Monoid"]=PS["Data.Monoid"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Control.Alt"],r=PS["Control.Alternative"],o=(PS["Control.Extend"],PS["Control.MonadPlus"]),u=PS["Control.Plus"],a=(PS["Data.Functor.Invariant"],PS["Data.Monoid"],function(){function n(){}return n.value=new n,n}()),i=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),c=function(n){return function(t){return function(e){if(e instanceof a)return n;if(e instanceof i)return t(e.value0);throw new Error("Failed pattern match at Data.Maybe line 26, column 1 - line 27, column 1: "+[n.constructor.name,t.constructor.name,e.constructor.name])}}},l=c(!1)(t["const"](!0)),f=new t.Functor(function(n){return function(t){return t instanceof i?new i(n(t.value0)):a.value}}),s=function(n){return c(n)(t.id(t.categoryFn))},m=new t.Apply(function(){return f},function(n){return function(e){if(n instanceof i)return t["<$>"](f)(n.value0)(e);if(n instanceof a)return a.value;throw new Error("Failed pattern match at Data.Maybe line 96, column 1 - line 120, column 1: "+[n.constructor.name,e.constructor.name])}}),p=new t.Bind(function(){return m},function(n){return function(t){if(n instanceof i)return t(n.value0);if(n instanceof a)return a.value;throw new Error("Failed pattern match at Data.Maybe line 155, column 1 - line 174, column 1: "+[n.constructor.name,t.constructor.name])}}),d=new t.Applicative(function(){return m},i.create),S=new t.Monad(function(){return d},function(){return p}),v=new e.Alt(function(){return f},function(n){return function(t){return n instanceof a?t:n}}),y=new u.Plus(function(){return v},a.value),P=new r.Alternative(function(){return y},function(){return d}),h=new o.MonadPlus(function(){return P},function(){return S});n.Nothing=a,n.Just=i,n.isJust=l,n.fromMaybe=s,n.maybe=c,n.functorMaybe=f,n.applyMaybe=m,n.applicativeMaybe=d,n.altMaybe=v,n.plusMaybe=y,n.alternativeMaybe=P,n.bindMaybe=p,n.monadMaybe=S,n.monadPlusMaybe=h}(PS["Data.Maybe"]=PS["Data.Maybe"]||{}),function(n){"use strict";var t=PS.Prelude,e=(PS["Control.Comonad"],PS["Control.Extend"],PS["Data.Monoid"]),r=function(n){return n},o=function(n){return new t.Semigroup(function(e){return function(r){return t.disj(n)(e)(r)}})},u=function(n){return n},a=function(n){return new e.Monoid(function(){return o(n)},t.bottom(n["__superclass_Prelude.Bounded_0"]()))};n.Disj=r,n.runDisj=u,n.semigroupDisj=o,n.monoidDisj=a}(PS["Data.Monoid.Disj"]=PS["Data.Monoid.Disj"]||{}),function(n){"use strict";var t=PS["Data.Foldable"],e=PS.Prelude,r=(PS["Control.Apply"],PS["Data.Maybe"]),o=(PS["Data.Maybe.First"],PS["Data.Maybe.Last"],PS["Data.Monoid"]),u=(PS["Data.Monoid.Additive"],PS["Data.Monoid.Dual"],PS["Data.Monoid.Disj"]),a=(PS["Data.Monoid.Conj"],PS["Data.Monoid.Multiplicative"],function(n,t,e){this.foldMap=n,this.foldl=t,this.foldr=e}),i=function(n){return n.foldr},c=function(n){return n.foldl},l=function(n){return function(t){return c(n)(e["<>"](t["__superclass_Prelude.Semigroup_0"]()))(o.mempty(t))}},f=function(n){return function(t){return c(n)(e["+"](t))(e.zero(t))}},s=new a(function(n){return function(t){return function(e){if(e instanceof r.Nothing)return o.mempty(n);if(e instanceof r.Just)return t(e.value0);throw new Error("Failed pattern match at Data.Foldable line 51, column 1 - line 59, column 1: "+[t.constructor.name,e.constructor.name])}}},function(n){return function(t){return function(e){if(e instanceof r.Nothing)return t;if(e instanceof r.Just)return n(t)(e.value0);throw new Error("Failed pattern match at Data.Foldable line 51, column 1 - line 59, column 1: "+[n.constructor.name,t.constructor.name,e.constructor.name])}}},function(n){return function(t){return function(e){if(e instanceof r.Nothing)return t;if(e instanceof r.Just)return n(e.value0)(t);throw new Error("Failed pattern match at Data.Foldable line 51, column 1 - line 59, column 1: "+[n.constructor.name,t.constructor.name,e.constructor.name])}}}),m=new a(function(n){return function(t){return function(r){return i(m)(function(r){return function(o){return e["<>"](n["__superclass_Prelude.Semigroup_0"]())(t(r))(o)}})(o.mempty(n))(r)}}},t.foldlArray,t.foldrArray),p=function(n){return n.foldMap},d=function(n){return function(t){return function(e){return function(r){return u.runDisj(p(n)(u.monoidDisj(t))(function(n){return u.Disj(e(n))})(r))}}}};n.Foldable=a,n.sum=f,n.any=d,n.mconcat=l,n.foldMap=p,n.foldl=c,n.foldr=i,n.foldableArray=m,n.foldableMaybe=s}(PS["Data.Foldable"]=PS["Data.Foldable"]||{}),function(n){"use strict";n.traverseArrayImpl=function(){function n(n){this.fn=n}function t(n){return function(t){return new o(n,t)}}function e(n){for(var t=[];n!==r;)t.push(n.head),n=n.tail;return t}var r={},o=function(n,t){this.head=n,this.tail=t};return function(o){return function(u){return function(a){return function(i){var c=function(n,e){return o(u(t)(i(n)))(e)},l=function(t,e,r){if(0===e)return t;var o=r[e-1];return new n(function(){return l(c(o,t),e-1,r)})};return function(t){for(var o=l(a(r),t.length,t);o instanceof n;)o=o.fn();return u(e)(o)}}}}}}()}(PS["Data.Traversable"]=PS["Data.Traversable"]||{}),function(n){"use strict";var t=PS["Data.Traversable"],e=PS.Prelude,r=PS["Data.Foldable"],o=(PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Maybe.Last"],PS["Data.Monoid.Additive"],PS["Data.Monoid.Dual"],PS["Data.Monoid.Multiplicative"],PS["Data.Monoid.Disj"],PS["Data.Monoid.Conj"],function(n,t,e,r){this["__superclass_Data.Foldable.Foldable_1"]=n,this["__superclass_Prelude.Functor_0"]=t,this.sequence=e,this.traverse=r}),u=function(n){return n.traverse},a=new o(function(){return r.foldableArray},function(){return e.functorArray},function(n){return u(a)(n)(e.id(e.categoryFn))},function(n){return t.traverseArrayImpl(e.apply(n["__superclass_Prelude.Apply_0"]()))(e.map(n["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(e.pure(n))}),i=function(n){return n.sequence};n.Traversable=o,n.sequence=i,n.traverse=u,n.traversableArray=a}(PS["Data.Traversable"]=PS["Data.Traversable"]||{}),function(n){"use strict";var t=(PS.Prelude,PS["Control.Biapplicative"],PS["Control.Biapply"],PS["Control.Comonad"],PS["Control.Extend"],PS["Control.Lazy"],PS["Data.Bifoldable"],PS["Data.Bifunctor"],PS["Data.Bitraversable"],PS["Data.Foldable"],PS["Data.Functor.Invariant"],PS["Data.Maybe"],PS["Data.Maybe.First"],PS["Data.Monoid"],PS["Data.Traversable"],function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}());n.Tuple=t}(PS["Data.Tuple"]=PS["Data.Tuple"]||{}),function(n){"use strict";var t=(PS.Prelude,PS["Data.Maybe"]),e=function(n){if(n instanceof t.Just)return n.value0;throw new Error("Failed pattern match at Data.Maybe.Unsafe line 10, column 1 - line 11, column 1: "+[n.constructor.name])};n.fromJust=e}(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{}),function(n){"use strict";var t=PS["Data.Array"],e=PS.Prelude,r=(PS["Control.Alt"],PS["Control.Alternative"],PS["Control.Lazy"],PS["Control.MonadPlus"],PS["Control.Plus"],PS["Data.Foldable"],PS["Data.Functor.Invariant"],PS["Data.Maybe"]),o=(PS["Data.Monoid"],PS["Data.Traversable"],PS["Data.Tuple"],PS["Data.Maybe.Unsafe"],t.cons),u=t.range,a=t._updateAt(r.Just.create)(r.Nothing.value),i=t["uncons'"](e["const"](r.Nothing.value))(function(n){return function(t){return new r.Just({head:n,tail:t})}}),c=t.slice(0),l=t["uncons'"](e["const"](r.Nothing.value))(function(n){return function(n){return new r.Just(n)}}),f=function(n){var e=function(e){return function(u){for(var a=e,c=u;;){var l=i(c);{if(!(l instanceof r.Just&&n(l.value0.head)))return{init:t.reverse(a),rest:c};var f=o(l.value0.head)(a);a=f,c=l.value0.tail}}}};return e([])},s=function(n){return function(r){var o=function(t){return function(r){var o=n(t)(r);if(o instanceof e.GT)return 1;if(o instanceof e.EQ)return 0;if(o instanceof e.LT)return-1;throw new Error("Failed pattern match at Data.Array line 379, column 3 - line 384, column 1: "+[o.constructor.name])}};return t.sortImpl(o)(r)}},m=function(n){return[n]},p=function(n){return 0===t.length(n)},d=function(n){if(p(n))return r.Nothing.value;if(e.otherwise)return new r.Just(t.slice(0)(t.length(n)-1)(n));throw new Error("Failed pattern match at Data.Array line 209, column 1 - line 210, column 1: "+[n.constructor.name])},S=t.indexImpl(r.Just.create)(r.Nothing.value),v=S,y=function(n){return function(t){return function(e){var o=function(r){return a(n)(t(r))(e)};return r.maybe(r.Nothing.value)(o)(v(e)(n))}}},P=t["uncons'"](e["const"](r.Nothing.value))(function(n){return function(t){return new r.Just(n)}}),h=function(n){var e=function(e){return function(u){for(var a=e,c=u;;){if(0===c.length)return t.reverse(a);var l=i(c);{if(!(l instanceof r.Just))throw new Error("Failed pattern match at Data.Array line 446, column 1 - line 447, column 1: "+[l.constructor.name]);var s=f(n(l.value0.head))(l.value0.tail),m=o(o(l.value0.head)(s.init))(a);a=m,c=s.rest}}}};return e([])},g=function(n){return function(t){return h(e.eq(n))(t)}},C=t.findIndexImpl(r.Just.create)(r.Nothing.value),b=function(n){return function(t){return C(function(r){return e["=="](n)(r)(t)})}},w=e.flip(e.bind(e.bindArray)),D=function(n){return w(function(t){return r.maybe([])(m)(n(t))})};n.groupBy=h,n.group=g,n.span=f,n.take=c,n.sortBy=s,n.mapMaybe=D,n.concatMap=w,n.modifyAt=y,n.updateAt=a,n.findIndex=C,n.elemIndex=b,n.index=S,n.uncons=i,n.init=d,n.tail=l,n.head=P,n["null"]=p,n[".."]=u,n.singleton=m,n.zipWith=t.zipWith,n.slice=t.slice,n.filter=t.filter,n.concat=t.concat,n.snoc=t.snoc,n.length=t.length,n.replicate=t.replicate}(PS["Data.Array"]=PS["Data.Array"]||{}),function(n){"use strict";n.runSTArray=function(n){return n},n.emptySTArray=function(){return[]},n.pushAllSTArray=function(n){return function(t){return function(){return n.push.apply(n,t)}}},n.copyImpl=function(n){return function(){return n.slice()}}}(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{}),function(n){"use strict";var t=PS["Data.Array.ST"],e=(PS.Prelude,PS["Control.Monad.Eff"],PS["Control.Monad.ST"],PS["Data.Maybe"],t.copyImpl),r=function(n){return function(e){return t.pushAllSTArray(n)([e])}};n.thaw=e,n.pushSTArray=r,n.emptySTArray=t.emptySTArray,n.runSTArray=t.runSTArray}(PS["Data.Array.ST"]=PS["Data.Array.ST"]||{}),function(n){"use strict";n.unsafeIndex=function(n){return function(t){return n[t]}}}(PS["Data.Array.Unsafe"]=PS["Data.Array.Unsafe"]||{}),function(n){"use strict";var t=PS["Data.Array.Unsafe"],e=(PS.Prelude,PS["Data.Array"]),r=function(n){return e.slice(1)(e.length(n))(n)},o=function(n){return t.unsafeIndex(n)(0)};n.tail=r,n.head=o}(PS["Data.Array.Unsafe"]=PS["Data.Array.Unsafe"]||{}),function(n){"use strict";var t=PS.Prelude,e=(PS["Control.Alt"],PS["Control.Extend"],PS["Data.Bifoldable"],PS["Data.Bifunctor"],PS["Data.Bitraversable"],PS["Data.Foldable"],PS["Data.Monoid"],PS["Data.Traversable"],function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}()),r=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),o=new t.Functor(function(n){return function(t){if(t instanceof e)return new e(t.value0);if(t instanceof r)return new r(n(t.value0));throw new Error("Failed pattern match at Data.Either line 52, column 1 - line 56, column 1: "+[n.constructor.name,t.constructor.name])}}),u=new t.Apply(function(){return o},function(n){return function(u){if(n instanceof e)return new e(n.value0);if(n instanceof r)return t["<$>"](o)(n.value0)(u);throw new Error("Failed pattern match at Data.Either line 92, column 1 - line 116, column 1: "+[n.constructor.name,u.constructor.name])}}),a=new t.Applicative(function(){return u},r.create);n.Left=e,n.Right=r,n.functorEither=o,n.applyEither=u,n.applicativeEither=a}(PS["Data.Either"]=PS["Data.Either"]||{}),function(n){"use strict";n.toForeign=function(n){return n},n.unsafeFromForeign=function(n){return n},n.typeOf=function(n){return typeof n},n.isNull=function(n){return null===n},n.isUndefined=function(n){return void 0===n}}(PS["Data.Foreign"]=PS["Data.Foreign"]||{}),function(n){"use strict";n.mkFn3=function(n){return function(t,e,r){return n(t)(e)(r)}},n.mkFn4=function(n){return function(t,e,r,o){return n(t)(e)(r)(o)}},n.mkFn5=function(n){return function(t,e,r,o,u){return n(t)(e)(r)(o)(u)}},n.mkFn6=function(n){return function(t,e,r,o,u,a){return n(t)(e)(r)(o)(u)(a)}},n.mkFn7=function(n){return function(t,e,r,o,u,a,i){return n(t)(e)(r)(o)(u)(a)(i)}},n.runFn4=function(n){return function(t){return function(e){return function(r){return function(o){return n(t,e,r,o)}}}}}}(PS["Data.Function"]=PS["Data.Function"]||{}),function(n){"use strict";var t=PS["Data.Function"],e=(PS.Prelude,function(n){return function(t){return function(e){return function(r){return n(t(e))(t(r))}}}});n.on=e,n.runFn4=t.runFn4,n.mkFn7=t.mkFn7,n.mkFn6=t.mkFn6,n.mkFn5=t.mkFn5,n.mkFn4=t.mkFn4,n.mkFn3=t.mkFn3}(PS["Data.Function"]=PS["Data.Function"]||{}),function(n){"use strict";n.fromNumberImpl=function(n){return function(t){return function(e){return(0|e)===e?n(e):t}}},n.toNumber=function(n){return n}}(PS["Data.Int"]=PS["Data.Int"]||{}),function(n){"use strict";n.ceil=Math.ceil,n.floor=Math.floor,n.sqrt=Math.sqrt}(PS.Math=PS.Math||{}),function(n){"use strict";var t=PS.Math;n.sqrt=t.sqrt,n.floor=t.floor,n.ceil=t.ceil}(PS.Math=PS.Math||{}),function(n){"use strict";var t=PS["Data.Int"],e=PS.Prelude,r=(PS["Data.Int.Bits"],PS["Data.Maybe"]),o=PS["Data.Maybe.Unsafe"],u=PS.Math,a=t.fromNumberImpl(r.Just.create)(r.Nothing.value),i=function(n){if(n>=t.toNumber(e.top(e.boundedInt)))return e.top(e.boundedInt);if(n<=t.toNumber(e.bottom(e.boundedInt)))return e.bottom(e.boundedInt);if(e.otherwise)return o.fromJust(a(n));throw new Error("Failed pattern match at Data.Int line 48, column 1 - line 49, column 1: "+[n.constructor.name])},c=function(n){return i(u.floor(n))},l=function(n){return 0===(1&n)},f=function(n){return i(u.ceil(n))};n.even=l,n.floor=c,n.ceil=f,n.fromNumber=a,n.toNumber=t.toNumber}(PS["Data.Int"]=PS["Data.Int"]||{}),function(n){"use strict";n.joinWith=function(n){return function(t){return t.join(n)}}}(PS["Data.String"]=PS["Data.String"]||{}),function(n){"use strict";var t=PS["Data.String"];PS.Prelude,PS["Data.Char"],PS["Data.Maybe"],PS["Data.Monoid"],PS["Data.String.Unsafe"];n.joinWith=t.joinWith}(PS["Data.String"]=PS["Data.String"]||{}),function(n){"use strict";var t=PS["Data.Foreign"],e=(PS.Prelude,PS["Data.Either"],PS["Data.Maybe"],PS["Data.Function"],PS["Data.Int"],PS["Data.String"],function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}()),r=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}();n.TypeMismatch=e,n.ErrorAtProperty=r,n.isUndefined=t.isUndefined,n.isNull=t.isNull,n.typeOf=t.typeOf,n.unsafeFromForeign=t.unsafeFromForeign,n.toForeign=t.toForeign}(PS["Data.Foreign"]=PS["Data.Foreign"]||{}),function(n){"use strict";n.unsafeReadPropImpl=function(n,t,e,r){return null==r?n:t(r[e])},n.unsafeHasOwnProperty=function(n,t){return Object.prototype.hasOwnProperty.call(t,n)},n.unsafeHasProperty=function(n,t){return n in t}}(PS["Data.Foreign.Index"]=PS["Data.Foreign.Index"]||{}),function(n){"use strict";var t=PS["Data.Foreign.Index"],e=PS.Prelude,r=PS["Data.Either"],o=PS["Data.Foreign"],u=(PS["Data.Function"],PS["Data.Int"],function(n,t,e,r){this.errorAt=n,this.hasOwnProperty=t,this.hasProperty=e,this.ix=r}),a=function(n){return function(u){return t.unsafeReadPropImpl(new r.Left(new o.TypeMismatch("object",o.typeOf(u))),e.pure(r.applicativeEither),n,u)}},i=a,c=function(n){return n.ix},l=function(n){return function(r){return o.isNull(r)?!1:o.isUndefined(r)?!1:e["=="](e.eqString)(o.typeOf(r))("object")||e["=="](e.eqString)(o.typeOf(r))("function")?t.unsafeHasProperty(n,r):!1}},f=function(n){return n.hasProperty},s=function(n){return function(r){return o.isNull(r)?!1:o.isUndefined(r)?!1:e["=="](e.eqString)(o.typeOf(r))("object")||e["=="](e.eqString)(o.typeOf(r))("function")?t.unsafeHasOwnProperty(n,r):!1}},m=new u(o.ErrorAtProperty.create,s,l,e.flip(i)),p=function(n){return n.hasOwnProperty},d=function(n){return n.errorAt};n.Index=u,n.errorAt=d,n.hasOwnProperty=p,n.hasProperty=f,n.ix=c,n.prop=i,n.indexString=m}(PS["Data.Foreign.Index"]=PS["Data.Foreign.Index"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Maybe"],r=(PS["Data.Tuple"],PS["Data.Array.ST"]),o=(PS["Data.Traversable"],PS["Control.Monad.Eff"]),u=PS["Control.Monad.ST"],a=function(n){this.unfoldr=n},i=function(n){return n.unfoldr},c=new a(function(n){return function(a){return o.runPure(r.runSTArray(function(){var i=r.emptySTArray(),c=u.newSTRef(a)();return function(){for(;!function(){var a=u.readSTRef(c)();return function(){var l=n(a);if(l instanceof e.Nothing)return t["return"](o.applicativeEff)(!0);if(l instanceof e.Just)return function(){return r.pushSTArray(i)(l.value0.value0)(),u.writeSTRef(c)(l.value0.value1)(),t["return"](o.applicativeEff)(!1)()};throw new Error("Failed pattern match at Data.Unfoldable line 29, column 1 - line 49, column 1: "+[l.constructor.name])}()()}(););return{}}(),t["return"](o.applicativeEff)(i)()}))}});n.Unfoldable=a,n.unfoldr=i,n.unfoldableArray=c}(PS["Data.Unfoldable"]=PS["Data.Unfoldable"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Maybe"],r=PS["Data.Tuple"],o=PS["Data.Monoid"],u=PS["Data.Foldable"],a=PS["Data.Unfoldable"],i=(PS["Data.Traversable"],PS["Control.Alt"]),c=(PS["Control.Lazy"],PS["Control.Plus"]),l=(PS["Control.Alternative"],PS["Control.MonadPlus"],function(){function n(){}return n.value=new n,n}()),f=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),s=function(n){if(n instanceof l)return e.Nothing.value;if(n instanceof f)return new e.Just({head:n.value0,tail:n.value1});throw new Error("Failed pattern match at Data.List line 266, column 1 - line 267, column 1: "+[n.constructor.name])},m=function(n){return u.foldr(n)(f.create)(l.value)},p=function(n){if(n instanceof l)return e.Nothing.value;if(n instanceof f)return new e.Just(n.value1);throw new Error("Failed pattern match at Data.List line 248, column 1 - line 249, column 1: "+[n.constructor.name])},d=new t.Semigroup(function(n){return function(e){if(n instanceof l)return e;if(n instanceof f)return new f(n.value0,t["<>"](d)(n.value1)(e));throw new Error("Failed pattern match: "+[n.constructor.name,e.constructor.name])}}),S=function(){var n=function(n){return function(t){for(var e=n,r=t;;){var o=e;if(r instanceof l)return o;{if(!(r instanceof f))throw new Error("Failed pattern match at Data.List line 364, column 1 - line 365, column 1: "+[e.constructor.name,r.constructor.name]);var u=new f(r.value0,e),a=r.value1;e=u,r=a}}}};return n(l.value)}(),v=function(n){if(n instanceof l)return e.Nothing.value;if(n instanceof f)return new e.Just(n.value0);throw new Error("Failed pattern match at Data.List line 233, column 1 - line 234, column 1: "+[n.constructor.name])},y=new t.Functor(function(n){return function(t){var e=function(t){return function(e){for(var r=t,o=e;;){if(r instanceof l)return o;{if(!(r instanceof f))throw new Error("Failed pattern match at Data.List line 717, column 1 - line 724, column 1: "+[r.constructor.name,o.constructor.name]);var u=r.value1,a=new f(n(r.value0),o);r=u,o=a}}}};return S(e(t)(l.value))}}),P=function(n){return a.unfoldr(n)(function(n){return t["<$>"](e.functorMaybe)(function(n){return new r.Tuple(n.head,n.tail)})(s(n))})},h=new u.Foldable(function(n){return function(e){return u.foldl(h)(function(r){return function(o){return t.append(n["__superclass_Prelude.Semigroup_0"]())(r)(e(o))}})(o.mempty(n))}},function(){var n=function(n){return function(t){return function(e){for(var r=n,o=t,u=e;;){var a=o;if(u instanceof l)return a;{if(!(u instanceof f))throw new Error("Failed pattern match: "+[r.constructor.name,o.constructor.name,u.constructor.name]);var i=r,c=r(o)(u.value0),s=u.value1;r=i,o=c,u=s}}}}};return n}(),function(n){return function(t){return function(e){if(e instanceof l)return t;if(e instanceof f)return n(e.value0)(u.foldr(h)(n)(t)(e.value1));throw new Error("Failed pattern match: "+[n.constructor.name,t.constructor.name,e.constructor.name])}}}),g=function(n){return function(e){if(e instanceof l)return l.value;if(e instanceof f)return t["<>"](d)(n(e.value0))(g(n)(e.value1));throw new Error("Failed pattern match: "+[n.constructor.name,e.constructor.name])}},C=new t.Apply(function(){return y},function(n){return function(e){if(n instanceof l)return l.value;
if(n instanceof f)return t["<>"](d)(t["<$>"](y)(n.value0)(e))(t["<*>"](C)(n.value1)(e));throw new Error("Failed pattern match: "+[n.constructor.name,e.constructor.name])}}),b=new t.Bind(function(){return C},t.flip(g)),w=new t.Applicative(function(){return C},function(n){return new f(n,l.value)}),D=new i.Alt(function(){return y},t.append(d)),A=new c.Plus(function(){return D},l.value);n.Nil=l,n.Cons=f,n.concatMap=g,n.reverse=S,n.uncons=s,n.tail=p,n.head=v,n.toList=m,n.fromList=P,n.semigroupList=d,n.functorList=y,n.foldableList=h,n.applyList=C,n.applicativeList=w,n.bindList=b,n.altList=D,n.plusList=A}(PS["Data.List"]=PS["Data.List"]||{}),function(n){"use strict";var t=PS.Prelude,e=(PS["Data.Functor.Invariant"],PS["Data.Monoid"]),r=function(n){return n},o=new t.Semigroup(function(n){return function(t){return function(e){return n(t(e))}}}),u=function(n){return n},a=new e.Monoid(function(){return o},t.id(t.categoryFn));n.Endo=r,n.runEndo=u,n.semigroupEndo=o,n.monoidEndo=a}(PS["Data.Monoid.Endo"]=PS["Data.Monoid.Endo"]||{}),function(n){"use strict";n["null"]=null,n.notNull=function(n){return n}}(PS["Data.Nullable"]=PS["Data.Nullable"]||{}),function(n){"use strict";var t=PS["Data.Nullable"],e=(PS.Prelude,PS["Data.Maybe"]),r=(PS["Data.Function"],e.maybe(t["null"])(t.notNull));n.toNullable=r}(PS["Data.Nullable"]=PS["Data.Nullable"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Maybe"],r=PS["Data.Foreign"],o=(PS["Data.Nullable"],PS["Data.Foreign.Index"]),u=PS["Control.MonadPlus"],a=(PS["Data.Array.Unsafe"],function(n){return function(t){return o.hasOwnProperty(o.indexString)(n)(r.toForeign(t))}}),i=a("api_hougeki"),c=a("api_hourai_flag"),l=function(n){return a("api_stage_flag")(n)?1===n.api_stage_flag[2]:!1},f=function(n){return a("api_stage_flag2")(n)?1===n.api_stage_flag2[2]:!1},s=function(n){var t=a("api_support_flag")(n);if(t)return new e.Just(n.api_support_flag);if(!t)return e.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 104, column 1 - line 105, column 1: "+[t.constructor.name])},m=function(n){return t.bind(e.bindMaybe)(s(n))(function(r){return t.bind(e.bindMaybe)(u.guard(e.monadPlusMaybe)(2===r||3===r))(function(){return t["return"](e.applicativeMaybe)(n.api_support_info.api_support_hourai)})})},p=function(n){return t.bind(e.bindMaybe)(s(n))(function(r){return t.bind(e.bindMaybe)(u.guard(e.monadPlusMaybe)(1===r))(function(){return t["return"](e.applicativeMaybe)(n.api_support_info.api_support_airatack)})})},d=function(n){var t=a("api_opening_flag")(n)&&1===n.api_opening_flag;if(t)return new e.Just(n.api_opening_atack);if(!t)return e.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 137, column 1 - line 138, column 1: "+[t.constructor.name])},S=function(n){var t=f(n);if(t)return new e.Just(n.api_kouku2);if(!t)return e.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 121, column 1 - line 122, column 1: "+[t.constructor.name])},v=function(n){var t=l(n);if(t)return new e.Just(n.api_kouku);if(!t)return e.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 99, column 1 - line 100, column 1: "+[t.constructor.name])},y=function(n){var r=function(n){return-1===n?e.Nothing.value:new e.Just(n)};return t.map(t.functorArray)(r)(n.api_nowhps_combined)},P=function(n){var r=function(n){return-1===n?e.Nothing.value:new e.Just(n)};return t.map(t.functorArray)(r)(n.api_nowhps)},h=function(n){var t=a("api_hourai_flag")(n);if(t)return new e.Just(n.api_hourai_flag);if(!t)return e.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 126, column 1 - line 127, column 1: "+[t.constructor.name])},g=function(n){var t=i(n);if(t)return new e.Just(n.api_hougeki);if(!t)return e.Nothing.value;throw new Error("Failed pattern match at KanColle.KCAPI.Battle line 164, column 1 - line 165, column 1: "+[t.constructor.name])},C=function(n){return function(r){return t.bind(e.bindMaybe)(t["<$>"](e.functorMaybe)(function(t){return t[n]})(h(r)))(function(n){return u.guard(e.monadPlusMaybe)(1===n)})}},b=function(n){return t.bind(e.bindMaybe)(C(0)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_hougeki1)})},w=function(n){return t.bind(e.bindMaybe)(C(0)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_hougeki1)})},D=function(n){return t.bind(e.bindMaybe)(C(1)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_hougeki2)})},A=function(n){return t.bind(e.bindMaybe)(C(2)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_hougeki2)})},M=function(n){return t.bind(e.bindMaybe)(C(2)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_hougeki3)})},F=function(n){return t.bind(e.bindMaybe)(C(3)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_hougeki3)})},E=function(n){return t.bind(e.bindMaybe)(C(3)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_raigeki)})},I=function(n){return t.bind(e.bindMaybe)(C(1)(n))(function(){return t["return"](e.applicativeMaybe)(n.api_raigeki)})};n.getHougeki3CT=F,n.getHougeki2CT=A,n.getRaigekiCT=I,n.getHougeki1CT=w,n.getHougeki=g,n.getRaigeki=E,n.getHougeki3=M,n.getHougeki2=D,n.getHougeki1=b,n.getOpeningAttack=d,n.checkHouraiFlag=C,n.getHouraiFlags=h,n.getKouku2=S,n.getSupportHouraiInfo=m,n.getSupportAirInfo=p,n.getSupportFlag=s,n.getKouku=v,n.hasHougeki=i,n.hasHourai=c,n.hasKouku2=f,n.hasKouku=l,n.hasField=a,n.getInitHpsCombined=y,n.getInitHps=P}(PS["KanColle.KCAPI.Battle"]=PS["KanColle.KCAPI.Battle"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS.Math,r=PS["Data.Array"],o=PS["Data.Array.Unsafe"],u=PS["Data.Foldable"],a=PS["Data.Int"],i=PS["Data.Maybe"],c=PS["Data.Monoid"],l=PS["Data.Monoid.Endo"],f=PS["Data.Foreign"],s=(PS["KanColle.KCAPI.Battle"],function(){function n(){}return n.value=new n,n}()),m=function(){function n(){}return n.value=new n,n}(),p=function(){function n(){}return n.value=new n,n}(),d=function(n){return n},S=function(n){return n},v=function(n){return function(t){return n(t)}},y=new t.Show(function(n){return"DV "+t.show(t.showArray(t.showInt))(n)}),P=new t.Semigroup(function(n){return function(e){return r.zipWith(t["+"](t.semiringInt))(n)(e)}}),h=new c.Monoid(function(){return P},r.replicate(13)(0)),g=function(n){return function(t){if(n instanceof s)return{main:t,escort:c.mempty(h),support:c.mempty(h)};if(n instanceof m)return{main:c.mempty(h),escort:t,support:c.mempty(h)};if(n instanceof p)return{main:c.mempty(h),escort:c.mempty(h),support:t};throw new Error("Failed pattern match at KanColle.DamageAnalysis.DamageVector line 130, column 1 - line 131, column 1: "+[n.constructor.name])}},C=function(){var n=function(n){return n>=0?i.fromMaybe(0)(a.fromNumber(e.floor(n))):0};return t.map(t.functorArray)(n)}(),b=function(n){return t["<>"](t.semigroupArray)([0])(t["<>"](t.semigroupArray)(C(o.tail(n.api_fdam)))(C(o.tail(n.api_edam))))},w=new t.Semigroup(function(n){return function(e){return{main:t["<>"](P)(n.main)(e.main),escort:t["<>"](P)(n.escort)(e.escort),support:t["<>"](P)(n.support)(e.support)}}}),D=new c.Monoid(function(){return w},{main:c.mempty(h),escort:c.mempty(h),support:c.mempty(h)}),A=function(n){return d(t["<>"](t.semigroupArray)([-1])(t["<>"](t.semigroupArray)(r.replicate(6)(0))(C(o.tail(n.api_damage)))))},M=function(n){return d(t["<>"](t.semigroupArray)([-1])(t["<>"](t.semigroupArray)(r.replicate(6)(0))(C(o.tail(n.api_stage3.api_edam)))))},F=b,E=function(n){var e=function(n){return t["<>"](t.semigroupArray)([0])(t["<>"](t.semigroupArray)(C(o.tail(n.api_fdam)))(r.replicate(6)(0)))};return e(n.api_stage3_combined)},I=function(n){return b(n.api_stage3)},_=function(n){var e=function(n){return function(t){return function(e){return i.fromMaybe(e)(r.modifyAt(n)(function(n){return n+t|0})(e))}}},a=C(r.concat(t.map(t.functorArray)(f.unsafeFromForeign)(o.tail(n.api_damage)))),s=r.concat(t.map(t.functorArray)(f.unsafeFromForeign)(o.tail(n.api_df_list))),m=u.foldMap(u.foldableArray)(l.monoidEndo)(l.Endo)(r.zipWith(e)(s)(a));return v(l.runEndo(m))(c.mempty(h))};n.FRMain=s,n.FREscort=m,n.FRSupport=p,n.CDV=S,n.DV=d,n.toCombined=g,n.calcSupportHouraiDamage=A,n.calcSupportAirAttackDamage=M,n.calcRaigekiDamage=F,n.calcHougekiDamage=_,n.calcKoukuDamageCombined=E,n.calcKoukuDamage=I,n.damageVectorSemigroup=P,n.damageVectorMonoid=h,n.damageVectorShow=y,n.combinedDamageVectorSemigroup=w,n.combinedDamageVectorMonoid=D}(PS["KanColle.DamageAnalysis.DamageVector"]=PS["KanColle.DamageAnalysis.DamageVector"]||{}),function(n){"use strict";var t=(PS.Prelude,PS["Data.Maybe"],PS["Data.Monoid"]),e=PS["Data.Foldable"],r=PS["KanColle.KCAPI.Battle"],o=PS["KanColle.DamageAnalysis.DamageVector"],u=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcSupportHouraiDamage)(r.getSupportHouraiInfo(n))},a=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcSupportAirAttackDamage)(r.getSupportAirInfo(n))},i=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcRaigekiDamage)(r.getRaigeki(n))},c=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcRaigekiDamage)(r.getRaigekiCT(n))},l=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcRaigekiDamage)(r.getOpeningAttack(n))},f=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcKoukuDamage)(r.getKouku(n))},s=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcKoukuDamageCombined)(r.getKouku(n))},m=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcKoukuDamage)(r.getKouku2(n))},p=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcKoukuDamageCombined)(r.getKouku2(n))},d=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcHougekiDamage)(r.getHougeki(n))},S=d,v=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcHougekiDamage)(r.getHougeki3(n))},y=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcHougekiDamage)(r.getHougeki3CT(n))},P=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcHougekiDamage)(r.getHougeki2(n))},h=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcHougekiDamage)(r.getHougeki2CT(n))},g=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcHougekiDamage)(r.getHougeki1(n))},C=function(n){return e.foldMap(e.foldableMaybe)(o.damageVectorMonoid)(o.calcHougekiDamage)(r.getHougeki1CT(n))},b=e.mconcat(e.foldableArray)(t.monoidFn(o.combinedDamageVectorMonoid))([function(n){return o.toCombined(o.FRMain.value)(f(n))},function(n){return o.toCombined(o.FREscort.value)(s(n))},function(n){return o.toCombined(o.FRSupport.value)(a(n))},function(n){return o.toCombined(o.FRSupport.value)(u(n))},function(n){return o.toCombined(o.FRMain.value)(m(n))},function(n){return o.toCombined(o.FREscort.value)(p(n))},function(n){return o.toCombined(o.FREscort.value)(l(n))},function(n){return o.toCombined(o.FRMain.value)(g(n))},function(n){return o.toCombined(o.FRMain.value)(P(n))},function(n){return o.toCombined(o.FREscort.value)(v(n))},function(n){return o.toCombined(o.FREscort.value)(i(n))}]),w=e.mconcat(e.foldableArray)(t.monoidFn(o.damageVectorMonoid))([f,m,a,u,l,g,P,v,i]),D=e.mconcat(e.foldableArray)(t.monoidFn(o.combinedDamageVectorMonoid))([function(n){return o.toCombined(o.FRMain.value)(f(n))},function(n){return o.toCombined(o.FREscort.value)(s(n))},function(n){return o.toCombined(o.FRSupport.value)(a(n))},function(n){return o.toCombined(o.FRSupport.value)(u(n))},function(n){return o.toCombined(o.FRMain.value)(m(n))},function(n){return o.toCombined(o.FREscort.value)(p(n))},function(n){return o.toCombined(o.FREscort.value)(l(n))},function(n){return o.toCombined(o.FREscort.value)(C(n))},function(n){return o.toCombined(o.FREscort.value)(c(n))},function(n){return o.toCombined(o.FRMain.value)(h(n))},function(n){return o.toCombined(o.FRMain.value)(y(n))}]);n.battleCarrierTaskForceDV=D,n.battleSurfaceTaskForceDV=b,n.nightBattleDV=S,n.battleDV=w,n.hougekiDV=d,n.hougeki3CTDV=y,n.hougeki2CTDV=h,n.raigekiCTDV=c,n.hougeki1CTDV=C,n.raigekiDV=i,n.hougeki3DV=v,n.hougeki2DV=P,n.hougeki1DV=g,n.openingDV=l,n.kouku2DV=m,n.supportHouraiDV=u,n.supportAirAttackDV=a,n.kouku2CombinedDV=p,n.koukuCombinedDV=s,n.koukuDV=f}(PS["KanColle.DamageAnalysis.Stages"]=PS["KanColle.DamageAnalysis.Stages"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Maybe"],r=(PS["Data.Maybe.Unsafe"],PS["KanColle.KCAPI.Battle"]),o=PS["Data.Array"],u=PS["Data.Foreign"],a=(PS["Data.Int"],PS["Data.Monoid"],PS["Data.Monoid.Endo"],PS["Data.Nullable"]),i=(PS["Data.Foldable"],PS["Data.String"]),c=(PS.Math,PS["Data.Array.Unsafe"]),l=(PS["KanColle.DamageAnalysis.DamageVector"],PS["KanColle.DamageAnalysis.Stages"]),f=function(n){return"DamageInfoNight {currentHp="+(t.show(t.showInt)(n.currentHp)+"}")},s=function(n){return i.joinWith(" | ")(t.map(t.functorArray)(e.maybe("<N/A>")(f))(n))},m=function(n){return"DamageInfo {currentHp="+(t.show(t.showInt)(n.currentHp)+"}")},p=function(n){return i.joinWith(" | ")(t.map(t.functorArray)(e.maybe("<N/A>")(m))(n))},d=function(n){return t.map(t.functorArray)(t.map(e.functorMaybe)(function(n){return{currentHp:n}}))(r.getInitHps(n))},S=function(n){var u=function(n){return t["<>"](t.semigroupArray)([e.Nothing.value])(t.map(t.functorArray)(t.map(e.functorMaybe)(function(n){return{currentHp:n}}))(n))},a=r.getInitHps(n),i=c.tail(r.getInitHpsCombined(n));return{main:u(o.slice(1)(7)(a)),escort:u(i),enemy:u(o.slice(7)(13)(a))}},v=function(n){var r=function(n){return t.map(e.functorMaybe)(function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e.currentHp=t.currentHp-n,e})};return o.zipWith(r)(n)},y=function(n){return function(r){var u=t["<>"](t.semigroupArray)([e.Nothing.value])(t["<>"](t.semigroupArray)(c.tail(r.main))(c.tail(r.enemy))),a=v(n.main)(u),i=t["<>"](t.semigroupArray)([e.Nothing.value])(o.slice(7)(13)(a)),l=t["<>"](t.semigroupArray)([e.Nothing.value])(t["<>"](t.semigroupArray)(c.tail(r.escort))(c.tail(i))),f=v(n.escort)(l),s=t["<>"](t.semigroupArray)([e.Nothing.value])(o.slice(7)(13)(f)),m=t["<>"](t.semigroupArray)([e.Nothing.value])(t["<>"](t.semigroupArray)(o.replicate(6)(e.Nothing.value))(c.tail(s))),p=v(n.support)(m),d=t["<>"](t.semigroupArray)([e.Nothing.value])(o.slice(7)(13)(p)),S=t["<>"](t.semigroupArray)([e.Nothing.value])(o.slice(1)(7)(f)),y=t["<>"](t.semigroupArray)([e.Nothing.value])(o.slice(1)(7)(a));return{main:y,escort:S,enemy:d}}},P=t["<*>"](t.applyFn)(t["<$>"](t.functorFn)(y)(l.battleSurfaceTaskForceDV))(S),h=function(n){return P(u.unsafeFromForeign(n))},g=function(){var n=t.map(t.functorArray)(a.toNullable),e=function(t){return{main:n(t.main),escort:n(t.escort),enemy:n(t.enemy)}};return function(n){return e(h(n))}}(),C=function(n){var r=S(n),o=t["<>"](t.semigroupArray)([e.Nothing.value])(t["<>"](t.semigroupArray)(c.tail(r.escort))(c.tail(r.enemy)));return v(l.nightBattleDV(n))(o)},b=function(n){return C(u.unsafeFromForeign(n))},w=function(n){return t.map(t.functorArray)(a.toNullable)(b(n))},D=t["<*>"](t.applyFn)(t["<$>"](t.functorFn)(v)(l.nightBattleDV))(d),A=function(n){return D(u.unsafeFromForeign(n))},M=function(n){return t.map(t.functorArray)(a.toNullable)(A(n))},F=t["<*>"](t.applyFn)(t["<$>"](t.functorFn)(y)(l.battleCarrierTaskForceDV))(S),E=function(n){return F(u.unsafeFromForeign(n))},I=function(){var n=t.map(t.functorArray)(a.toNullable),e=function(t){return{main:n(t.main),escort:n(t.escort),enemy:n(t.enemy)}};return function(n){return e(E(n))}}(),_=t["<*>"](t.applyFn)(t["<$>"](t.functorFn)(v)(l.battleDV))(d),T=function(n){return _(u.unsafeFromForeign(n))},x=function(n){return t.map(t.functorArray)(a.toNullable)(T(n))};n.analyzeRawNightBattleCombinedJS=w,n.analyzeRawNightBattleCombined=b,n.analyzeNightBattleCombined=C,n.analyzeRawCarrierTaskForceBattleJS=I,n.analyzeRawCarrierTaskForceBattle=E,n.analyzeCarrierTaskForceBattle=F,n.analyzeRawSurfaceTaskForceBattleJS=g,n.analyzeRawSurfaceTaskForceBattle=h,n.analyzeSurfaceTaskForceBattle=P,n.applyCombinedDamageVector=y,n.applyDamageVector=v,n.analyzeRawNightBattleJS=M,n.analyzeRawBattleJS=x,n.analyzeRawNightBattle=A,n.analyzeRawBattle=T,n.analyzeNightBattle=D,n.analyzeBattle=_,n.battleCombinedStart=S,n.battleStart=d,n.pprFleetDamageTookInfoNight=s,n.pprFleetDamageTookInfo=p,n.pprDamageTookInfoNight=f,n.pprDamageTookInfo=m}(PS["KanColle.DamageAnalysis"]=PS["KanColle.DamageAnalysis"]||{}),function(n){"use strict";var t=PS.Prelude,e=function(){function n(){}return n.value=new n,n}(),r=function(){function n(){}return n.value=new n,n}(),o=function(){function n(){}return n.value=new n,n}(),u=function(){function n(){}return n.value=new n,n}(),a=function(){function n(){}return n.value=new n,n}(),i=function(){function n(){}return n.value=new n,n}(),c=function(){function n(){}return n.value=new n,n}(),l=function(){function n(){}return n.value=new n,n}(),f=function(){function n(){}return n.value=new n,n}(),s=function(){function n(){}return n.value=new n,n}(),m=function(){function n(){}return n.value=new n,n}(),p=function(){function n(){}return n.value=new n,n}(),d=function(){function n(){}return n.value=new n,n}(),S=function(){function n(){}return n.value=new n,n}(),v=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),P=function(){function n(){}return n.value=new n,n}(),h=function(){function n(){}return n.value=new n,n}(),g=function(){function n(){}return n.value=new n,n}(),C=function(){function n(){}return n.value=new n,n}(),b=function(){function n(){}return n.value=new n,n}(),w=function(){function n(){}return n.value=new n,n}(),D=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),A=function(n){if(n instanceof e)return 1;if(n instanceof r)return 2;if(n instanceof o)return 3;if(n instanceof u)return 4;if(n instanceof a)return 5;if(n instanceof i)return 6;if(n instanceof c)return 7;if(n instanceof l)return 8;if(n instanceof f)return 9;if(n instanceof s)return 10;if(n instanceof m)return 11;if(n instanceof p)return 12;if(n instanceof d)return 13;if(n instanceof S)return 14;if(n instanceof v)return 15;if(n instanceof y)return 16;if(n instanceof P)return 17;if(n instanceof h)return 18;if(n instanceof g)return 19;if(n instanceof C)return 20;if(n instanceof b)return 21;if(n instanceof w)return 22;if(n instanceof D)return-1;throw new Error("Failed pattern match at KanColle.Generated.SType line 83, column 1 - line 84, column 1: "+[n.constructor.name])},M=function(n){if(n instanceof e)return"DDE";if(n instanceof r)return"DD";if(n instanceof o)return"CL";if(n instanceof u)return"CLT";if(n instanceof a)return"CA";if(n instanceof i)return"CAV";if(n instanceof c)return"CVL";if(n instanceof l)return"FBB";if(n instanceof f)return"BB";if(n instanceof s)return"BBV";if(n instanceof m)return"CV";if(n instanceof p)return"XBB";if(n instanceof d)return"SS";if(n instanceof S)return"SSV";if(n instanceof v)return"AP";if(n instanceof y)return"AV";if(n instanceof P)return"LHA";if(n instanceof h)return"CVB";if(n instanceof g)return"AR";if(n instanceof C)return"AS";if(n instanceof b)return"CT";if(n instanceof w)return"AO";if(n instanceof D)return"<Unknown:"+(n.value0+">");throw new Error("Failed pattern match at KanColle.Generated.SType line 8, column 1 - line 9, column 1: "+[n.constructor.name])},F=function(n){return"DDE"===n?e.value:"DD"===n?r.value:"CL"===n?o.value:"CLT"===n?u.value:"CA"===n?a.value:"CAV"===n?i.value:"CVL"===n?c.value:"FBB"===n?l.value:"BB"===n?f.value:"BBV"===n?s.value:"CV"===n?m.value:"XBB"===n?p.value:"SS"===n?d.value:"SSV"===n?S.value:"AP"===n?v.value:"AV"===n?y.value:"LHA"===n?P.value:"CVB"===n?h.value:"AR"===n?g.value:"AS"===n?C.value:"CT"===n?b.value:"AO"===n?w.value:new D(n)},E=function(n){return 1===n?e.value:2===n?r.value:3===n?o.value:4===n?u.value:5===n?a.value:6===n?i.value:7===n?c.value:8===n?l.value:9===n?f.value:10===n?s.value:11===n?m.value:12===n?p.value:13===n?d.value:14===n?S.value:15===n?v.value:16===n?y.value:17===n?P.value:18===n?h.value:19===n?g.value:20===n?C.value:21===n?b.value:22===n?w.value:new D("num "+t.show(t.showInt)(n))};n.DDE=e,n.DD=r,n.CL=o,n.CLT=u,n.CA=a,n.CAV=i,n.CVL=c,n.FBB=l,n.BB=f,n.BBV=s,n.CV=m,n.XBB=p,n.SS=d,n.SSV=S,n.AP=v,n.AV=y,n.LHA=P,n.CVB=h,n.AR=g,n.AS=C,n.CT=b,n.AO=w,n.Unknown=D,n.toInt=A,n.fromInt=E,n.readSType=F,n.showSType=M}(PS["KanColle.Generated.SType"]=PS["KanColle.Generated.SType"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["KanColle.Generated.SType"],r=function(n){return function(r){return t["=="](t.eqString)(e.showSType(n))(e.showSType(r))}};n.eqSType=r}(PS["KanColle.SType"]=PS["KanColle.SType"]||{}),function(n){"use strict";var t=PS["KanColle.Generated.SType"],e=PS.Prelude,r=PS["Data.Array"],o=PS["Data.Foldable"],u=PS["Data.Maybe"],a=(PS["Data.Monoid"],PS["Data.String"]),i=PS["KanColle.SType"],c=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),l=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),f=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),s=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),m=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),p=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),d=function(){function n(n,t){this.value0=n,this.value1=t}return n.create=function(t){return function(e){return new n(t,e)}},n}(),S=function(){function n(n){this.value0=n}return n.create=function(t){return new n(t)},n}(),v=function(n){var r=function(n){return[new d(n,[t.SS.value,t.SSV.value])]},o=function(n){return function(t){return[new d(n,[t])]}},u=function(n){return[new s(n)]},a=function(n){return function(t){return[new f(new c(n)),new S(t)]}},i=function(n){return[new d(n,[t.CV.value,t.CVL.value,t.AV.value])]};return 1===n?a(1)(2):2===n?a(2)(4):3===n?a(3)(3):4===n?e["<>"](e.semigroupArray)(a(3)(3))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(2)(t.DD.value))):5===n?e["<>"](e.semigroupArray)(a(3)(4))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(2)(t.DD.value))):6===n?a(4)(4):7===n?a(5)(6):8===n?a(6)(6):9===n?e["<>"](e.semigroupArray)(a(3)(4))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(2)(t.DD.value))):10===n?e["<>"](e.semigroupArray)(a(3)(3))(o(2)(t.CL.value)):11===n?e["<>"](e.semigroupArray)(a(6)(4))(o(2)(t.DD.value)):12===n?e["<>"](e.semigroupArray)(a(4)(4))(o(2)(t.DD.value)):13===n?e["<>"](e.semigroupArray)(a(5)(6))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(4)(t.DD.value))):14===n?e["<>"](e.semigroupArray)(a(6)(6))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(3)(t.DD.value))):15===n?e["<>"](e.semigroupArray)(a(9)(6))(e["<>"](e.semigroupArray)(i(2))(o(2)(t.DD.value))):16===n?e["<>"](e.semigroupArray)(a(11)(6))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(2)(t.DD.value))):17===n?e["<>"](e.semigroupArray)(a(20)(6))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(3)(t.DD.value))):18===n?e["<>"](e.semigroupArray)(a(15)(6))(e["<>"](e.semigroupArray)(i(3))(o(2)(t.DD.value))):19===n?e["<>"](e.semigroupArray)(a(20)(6))(e["<>"](e.semigroupArray)(o(2)(t.BBV.value))(o(2)(t.DD.value))):20===n?e["<>"](e.semigroupArray)(a(1)(2))(e["<>"](e.semigroupArray)(r(1))(o(1)(t.CL.value))):21===n?e["<>"](e.semigroupArray)(a(15)(5))(e["<>"](e.semigroupArray)(u(30))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(e["<>"](e.semigroupArray)(o(4)(t.DD.value))([new p(3)])))):22===n?e["<>"](e.semigroupArray)(a(30)(6))(e["<>"](e.semigroupArray)(u(45))(e["<>"](e.semigroupArray)(o(1)(t.CA.value))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(2)(t.DD.value))))):23===n?e["<>"](e.semigroupArray)(a(50)(6))(e["<>"](e.semigroupArray)(u(200))(e["<>"](e.semigroupArray)(o(2)(t.BBV.value))(o(2)(t.DD.value)))):24===n?e["<>"](e.semigroupArray)(a(50)(6))(e["<>"](e.semigroupArray)(u(200))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(e["<>"](e.semigroupArray)(o(4)(t.DD.value))([new f(new l([t.CL.value]))])))):25===n?e["<>"](e.semigroupArray)(a(25)(4))(e["<>"](e.semigroupArray)(o(2)(t.CA.value))(o(2)(t.DD.value))):26===n?e["<>"](e.semigroupArray)(a(30)(4))(e["<>"](e.semigroupArray)(i(1))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(2)(t.DD.value)))):27===n?e["<>"](e.semigroupArray)(a(1)(2))(r(2)):28===n?e["<>"](e.semigroupArray)(a(30)(3))(r(3)):29===n?e["<>"](e.semigroupArray)(a(50)(3))(r(3)):30===n?e["<>"](e.semigroupArray)(a(55)(4))(r(4)):31===n?e["<>"](e.semigroupArray)(a(60)(4))(e["<>"](e.semigroupArray)(u(200))(r(4))):32===n?e["<>"](e.semigroupArray)(a(5)(3))(e["<>"](e.semigroupArray)(o(1)(t.CT.value))(e["<>"](e.semigroupArray)(o(2)(t.DD.value))([new f(new l([t.CT.value]))]))):33===n?e["<>"](e.semigroupArray)(a(1)(2))(o(2)(t.DD.value)):34===n?e["<>"](e.semigroupArray)(a(1)(2))(o(2)(t.DD.value)):35===n?e["<>"](e.semigroupArray)(a(40)(6))(e["<>"](e.semigroupArray)(i(2))(e["<>"](e.semigroupArray)(o(1)(t.CA.value))(o(1)(t.DD.value)))):36===n?e["<>"](e.semigroupArray)(a(30)(6))(e["<>"](e.semigroupArray)(o(2)(t.AV.value))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(o(1)(t.DD.value)))):37===n?e["<>"](e.semigroupArray)(a(50)(6))(e["<>"](e.semigroupArray)(u(200))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(e["<>"](e.semigroupArray)(o(5)(t.DD.value))([new p(4)])))):38===n?e["<>"](e.semigroupArray)(a(65)(6))(e["<>"](e.semigroupArray)(u(240))(e["<>"](e.semigroupArray)(o(5)(t.DD.value))([new p(4),new m(8)]))):39===n?e["<>"](e.semigroupArray)(a(3)(5))(e["<>"](e.semigroupArray)(u(180))(e["<>"](e.semigroupArray)(o(1)(t.AS.value))(r(4)))):40===n?e["<>"](e.semigroupArray)(a(25)(6))(e["<>"](e.semigroupArray)(u(150))(e["<>"](e.semigroupArray)(o(1)(t.CL.value))(e["<>"](e.semigroupArray)(o(2)(t.AV.value))(e["<>"](e.semigroupArray)(o(2)(t.DD.value))([new f(new l([t.CL.value]))]))))):[]},y=function(n){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.stype=t.readSType(n.stype),e},P=e.map(e.functorArray)(y),h=function(n){if(n instanceof c)return"ship level should be at least "+e.show(e.showInt)(n.value0);if(n instanceof l)return"ship should have one of the following type: "+a.joinWith(",")(e.map(e.functorArray)(t.showSType)(n.value0));throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 28, column 1 - line 29, column 1: "+[n.constructor.name])},g=function(n){if(n instanceof f)return"flagship: "+h(n.value0);if(n instanceof s)return"fleet level sum should be at least "+e.show(e.showInt)(n.value0);if(n instanceof m)return"fleet should have at least "+(e.show(e.showInt)(n.value0)+" drum(s)");if(n instanceof p)return"at least "+(e.show(e.showInt)(n.value0)+" ship(s) should have drum(s)");if(n instanceof d)return"require at least "+(e.show(e.showInt)(n.value0)+(" ship(s) of the following type: "+a.joinWith(",")(e.map(e.functorArray)(t.showSType)(n.value1))));if(n instanceof S)return"fleet should have at least "+(e.show(e.showInt)(n.value0)+" ship(s)");throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 34, column 1 - line 35, column 1: "+[n.constructor.name])},C=e.map(e.functorArray)(g),b=function(n){return function(t){if(n instanceof c)return t.level>=n.value0;if(n instanceof l)return o.any(o.foldableArray)(e.booleanAlgebraBoolean)(i.eqSType(t.stype))(n.value0);throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 68, column 1 - line 69, column 1: "+[n.constructor.name])}},w=function(n){return function(t){var a=function(n){return function(t){return r.length(r.filter(n)(t))}},i=r.uncons(t);if(i instanceof u.Just){if(n instanceof f)return b(n.value0)(i.value0.head);if(n instanceof s)return o.sum(o.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.level})(t))>=n.value0;if(n instanceof m)return o.sum(o.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.drumCount})(t))>=n.value0;if(n instanceof p)return a(function(n){return n.drumCount>0})(t)>=n.value0;if(n instanceof d)return a(b(new l(n.value1)))(t)>=n.value0;if(n instanceof S)return r.length(t)>=n.value0;throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 73, column 1 - line 74, column 1: "+[n.constructor.name])}if(i instanceof u.Nothing)return!1;throw new Error("Failed pattern match at KanColle.Expedition.Requirement line 73, column 1 - line 74, column 1: "+[i.constructor.name])}},D=function(n){return function(t){var e=v(n);return r.filter(function(n){return!w(n)(t)})(e)}};n.Flagship=f,n.FleetLevel=s,n.FleetDrum=m,n.FleetShipWithDrum=p,n.FleetSTypeCount=d,n.FleetShipCount=S,n.ShipLevel=c,n.ShipTypeOneOf=l,n.explainRequirements=C,n.unsatisfiedRequirements=D,n.getExpeditionRequirement=v,n.checkFleet=w,n.checkShip=b,n.fromRawFleet=P,n.fromRawShip=y,n.explainFleetRequirement=g,n.explainShipRequirement=h}(PS["KanColle.Expedition.Requirement"]=PS["KanColle.Expedition.Requirement"]||{}),function(n){"use strict";var t=(PS.Prelude,PS["Data.Array"]),e=(PS["Data.Monoid"],function(n){return function(t){return function(e){return{fuel:n(t.fuel)(e.fuel),ammo:n(t.ammo)(e.ammo),steel:n(t.steel)(e.steel),bauxite:n(t.bauxite)(e.bauxite)}}}}),r=function(n){return{fuel:n,ammo:n,steel:n,bauxite:n}},o=function(n){return function(t){return{fuel:n(t.fuel),ammo:n(t.ammo),steel:n(t.steel),bauxite:n(t.bauxite)}}},u=t[".."](1)(40);n.allExpeditionIds=u,n.mapResourceRows=o,n.resourceRowsLiftOp=e,n.resourceRowsFill=r}(PS["KanColle.Expedition.Base"]=PS["KanColle.Expedition.Base"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Monoid"],r=(PS["Data.Int"],PS["KanColle.Expedition.Base"]),o=function(n){return n},u=o,a=new t.Semigroup(function(n){return function(e){return r.resourceRowsLiftOp(t["+"](t.semiringInt))(n)(e)}}),i=new e.Monoid(function(){return a},r.resourceRowsFill(0)),c=function(n){return function(t){return function(e){return function(r){return{fuel:n,ammo:t,steel:e,bauxite:r}}}}},l=function(n){return n},f=function(n){return 1===n?c(0)(30)(0)(0):2===n?c(0)(100)(30)(0):3===n?c(30)(30)(40)(0):4===n?c(0)(60)(0)(0):5===n?c(200)(200)(20)(20):6===n?c(0)(0)(0)(80):7===n?c(0)(0)(50)(30):8===n?c(50)(100)(50)(50):9===n?c(350)(0)(0)(0):10===n?c(0)(50)(0)(30):11===n?c(0)(0)(0)(250):12===n?c(50)(250)(200)(50):13===n?c(240)(300)(0)(0):14===n?c(0)(240)(200)(0):15===n?c(0)(0)(300)(400):16===n?c(500)(500)(200)(200):17===n?c(70)(70)(50)(0):18===n?c(0)(0)(300)(100):19===n?c(400)(0)(50)(30):20===n?c(0)(0)(150)(0):21===n?c(320)(270)(0)(0):22===n?c(0)(10)(0)(0):23===n?c(0)(20)(0)(100):24===n?c(500)(0)(0)(150):25===n?c(900)(0)(500)(0):26===n?c(0)(0)(0)(900):27===n?c(0)(0)(800)(0):28===n?c(0)(0)(900)(350):29===n?c(0)(0)(0)(100):30===n?c(0)(0)(0)(100):31===n?c(0)(30)(0)(0):32===n?c(50)(50)(50)(50):33===n?e.mempty(i):34===n?e.mempty(i):35===n?c(0)(0)(240)(280):36===n?c(480)(0)(200)(200):37===n?c(0)(380)(270)(0):38===n?c(420)(0)(200)(0):39===n?c(0)(0)(300)(0):40===n?c(300)(300)(0)(100):e.mempty(i)};n.getExpeditionIncomeBase=f,n.getIncomeBase=l,n.mkIncomeBase=u,n.incomeSemigroup=a,n.incomeMonoid=i}(PS["KanColle.Expedition.IncomeBase"]=PS["KanColle.Expedition.IncomeBase"]||{}),function(n){"use strict";var t=(PS.Prelude,PS["Data.Int"]),e=(PS["Data.Maybe"],{fuel:0,ammo:0,time:0}),r=function(n){var r=function(n){return t.toNumber(10*n|0)/100},o=function(n){return 60*n|0},u=function(n){return function(t){return(60*n|0)+t|0}},a=function(n){return function(t){return function(e){return{fuel:r(n),ammo:r(t),time:e}}}};return 1===n?a(3)(0)(15):2===n?a(5)(0)(30):3===n?a(3)(2)(20):4===n?a(5)(0)(50):5===n?a(5)(0)(u(1)(30)):6===n?a(3)(2)(40):7===n?a(5)(0)(o(1)):8===n?a(5)(2)(o(3)):9===n?a(5)(0)(o(4)):10===n?a(3)(0)(u(1)(30)):11===n?a(5)(0)(o(5)):12===n?a(5)(0)(o(8)):13===n?a(5)(4)(o(4)):14===n?a(5)(0)(o(6)):15===n?a(5)(4)(o(12)):16===n?a(5)(4)(o(15)):17===n?a(3)(4)(45):18===n?a(5)(2)(o(5)):19===n?a(5)(4)(o(6)):20===n?a(5)(4)(o(2)):21===n?a(8)(7)(u(2)(20)):22===n?a(8)(7)(o(3)):23===n?a(8)(8)(o(4)):24===n?a(9)(6)(u(8)(20)):25===n?a(5)(8)(o(40)):26===n?a(8)(8)(o(80)):27===n?a(8)(8)(o(20)):28===n?a(8)(8)(o(25)):29===n?a(9)(4)(o(24)):30===n?a(9)(7)(o(48)):31===n?a(5)(0)(o(2)):32===n?a(9)(3)(o(24)):33===n?a(5)(8)(15):34===n?a(5)(8)(30):35===n?a(8)(8)(o(7)):36===n?a(8)(8)(o(9)):37===n?a(8)(8)(u(2)(45)):38===n?a(8)(8)(u(2)(55)):39===n?a(9)(9)(o(30)):40===n?a(8)(7)(u(6)(50)):e;
},o=function(n){return function(e){return{fuel:t.floor(t.toNumber(e.fuel)*n.fuel),ammo:t.floor(t.toNumber(e.ammo)*n.ammo)}}};n.getExpeditionCost=r,n.calcCost=o}(PS["KanColle.Expedition.Cost"]=PS["KanColle.Expedition.Cost"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Array"],r=(PS["Data.Foldable"],PS["Data.Monoid"],PS["Data.Monoid.Endo"],PS["Data.Map"],PS["KanColle.Expedition.Requirement"]),o=PS["KanColle.Expedition.IncomeBase"],u=PS["KanColle.Expedition.Cost"],a=PS["KanColle.Expedition.Base"],i=t[">>>"](t.semigroupoidFn)(r.getExpeditionRequirement)(t[">>>"](t.semigroupoidFn)(e["null"])(t.not(t.booleanAlgebraBoolean))),c=function(n){return{id:n,req:r.getExpeditionRequirement(n),income:o.getExpeditionIncomeBase(n),cost:u.getExpeditionCost(n)}},l=function(n){return function(t){return i(n)&&e["null"](r.unsatisfiedRequirements(n)(t))}},f=function(n){return e.filter(function(t){return l(t)(n)})(a.allExpeditionIds)},s=t.map(t.functorArray)(c)(a.allExpeditionIds);n.allExpeditions=s,n.getExpeditionInfo=c,n.checkExpedition=l,n.getAvailableExpeditions=f,n.validExpeditionId=i}(PS["KanColle.Expedition"]=PS["KanColle.Expedition"]||{}),function(n){"use strict";n.peekSTArrayUnsafe=function(n){return function(t){return function(){return n[t]}}},n.pokeSTArrayUnsafe=function(n){return function(t){return function(e){return function(){return n[t]=e,{}}}}}}(PS["KanColle.Util"]=PS["KanColle.Util"]||{}),function(n){"use strict";var t=PS["KanColle.Util"],e=PS.Prelude,r=PS["Data.Monoid"],o=PS["Data.Int"],u=PS["Control.Monad.Eff"],a=(PS["Control.Monad.ST"],PS["Control.MonadPlus"],PS["Control.Apply"],PS["Data.Traversable"]),i=(PS["Data.Maybe.Unsafe"],PS["Data.Array"]),c=PS["Data.Array.ST"],l=PS["Data.Maybe"],f=PS["Data.List"],s=(PS["Data.Foldable"],PS["Control.Plus"]),m=PS["Data.Unfoldable"],p=function(n){return function(t){return function(r){var u=function(t){return function(r){return function(u){for(var a=t,i=r,c=u;;)if(o.even(i)){var l=e["<>"](n)(a)(a),f=i/2|0,s=c;a=l,i=f,c=s}else{if(1===i)return e["<>"](n)(a)(c);if(!e.otherwise)throw new Error("Failed pattern match at KanColle.Util line 22, column 1 - line 23, column 1: "+[a.constructor.name,i.constructor.name,c.constructor.name]);var l=e["<>"](n)(a)(a),f=(i-1)/2|0,s=e["<>"](n)(a)(c);a=l,i=f,c=s}}}},a=function(t){return function(r){for(var a=t,i=r;;){if(!o.even(i)){if(1===i)return a;if(e.otherwise)return u(e["<>"](n)(a)(a))((i-1)/2|0)(a);throw new Error("Failed pattern match at KanColle.Util line 22, column 1 - line 23, column 1: "+[a.constructor.name,i.constructor.name])}var c=e["<>"](n)(a)(a),l=i/2|0;a=c,i=l}}};return a(r)(t+1|0)}}},d=function(n){return function(t){return function(e){return 0===t?r.mempty(n):p(n["__superclass_Prelude.Semigroup_0"]())(t-1)(e)}}},S=function(n){if(n instanceof f.Nil)return new f.Cons(f.Nil.value,f.Nil.value);if(n instanceof f.Cons)return new f.Cons(n,S(n.value1));throw new Error("Failed pattern match: "+[n.constructor.name])},v=function(n){return function(t){return e[">>>"](e.semigroupoidFn)(i.sortBy(n))(i.take(t))}},y=function(n){return function(r){return function(o){var a=function(i){return function(c){var f=(2*i|0)+2|0,s=(2*i|0)+1|0,m=function(a){return a>=o?e["return"](u.applicativeEff)(l.Nothing.value):function(){var o=t.peekSTArrayUnsafe(r)(a)();return e["return"](u.applicativeEff)(function(){var t=e["=="](e.eqOrdering)(n(o)(c))(e.GT.value);if(t)return new l.Just(o);if(!t)return l.Nothing.value;throw new Error("Failed pattern match at KanColle.Util line 71, column 1 - line 72, column 1: "+[t.constructor.name])}())()}};return function(){var o=m(s)(),p=m(f)();return function(){var m=function(n){return function(e){return function(){return t.pokeSTArrayUnsafe(r)(i)(n)(),t.pokeSTArrayUnsafe(r)(e)(c)(),a(e)(c)()}}};if(p instanceof l.Just){if(o instanceof l.Just){var d=e["=="](e.eqOrdering)(n(o.value0)(p.value0))(e.EQ.value)||e["=="](e.eqOrdering)(n(o.value0)(p.value0))(e.GT.value);if(d)return m(o.value0)(s);if(!d)return m(p.value0)(f);throw new Error("Failed pattern match at KanColle.Util line 71, column 1 - line 72, column 1: "+[d.constructor.name])}if(o instanceof l.Nothing)return m(p.value0)(f);throw new Error("Failed pattern match at KanColle.Util line 71, column 1 - line 72, column 1: "+[o.constructor.name])}if(p instanceof l.Nothing){if(o instanceof l.Just)return m(o.value0)(s);if(o instanceof l.Nothing)return e["return"](u.applicativeEff)(e.unit);throw new Error("Failed pattern match at KanColle.Util line 71, column 1 - line 72, column 1: "+[o.constructor.name])}throw new Error("Failed pattern match at KanColle.Util line 71, column 1 - line 72, column 1: "+[p.constructor.name])}()()}}};return a}}},P=function(n){return function(r){return function(o){return function(a){return e[">>="](u.bindEff)(t.peekSTArrayUnsafe(r)(a))(y(n)(r)(o)(a))}}}},h=function(n){return function(t){return function(){var r=c.thaw(t)();return function(){var o=i.length(t);return function(){return a.traverse(a.traversableArray)(u.applicativeEff)(P(n)(r)(o))(i[".."]((o/2|0)-1)(0))(),e["return"](u.applicativeEff)(r)()}}()()}}},g=function(n){return function(r){return function(o){var a=o-1;return function(){var i=t.peekSTArrayUnsafe(r)(0)(),c=t.peekSTArrayUnsafe(r)(a)();return t.pokeSTArrayUnsafe(r)(0)(c)(),t.pokeSTArrayUnsafe(r)(a)(i)(),P(n)(r)(o-1)(0)(),e["return"](u.applicativeEff)(i)()}}}},C=function(n){return function(t){return u.runPure(c.runSTArray(function(){var r=i.length(t);return function(){var o=h(n)(t)();return a.traverse(a.traversableArray)(u.applicativeEff)(g(n)(o))(i[".."](r)(2))(),e["return"](u.applicativeEff)(o)()}}()))}},b=function(n){return function(t){if(i.length(t)<2)return t;if(e.otherwise)return C(n)(t);throw new Error("Failed pattern match at KanColle.Util line 115, column 1 - line 116, column 1: "+[n.constructor.name,t.constructor.name])}},w=function(n){return function(t){return function(r){var o=i.length(r),c=e.flip(n),l=2>o||0>=t;if(l)return e[">>>"](e.semigroupoidFn)(i.sortBy(n))(i.take(t))(r);if(!l){var f=t>=o;if(f)return i.sortBy(n)(r);if(!f)return u.runPure(function(){var n=h(c)(r)();return a.traverse(a.traversableArray)(u.applicativeEff)(g(c)(n))(i[".."](o)(o-t+1|0))()});throw new Error("Failed pattern match: "+[f.constructor.name])}throw new Error("Failed pattern match at KanColle.Util line 123, column 1 - line 124, column 1: "+[l.constructor.name])}}},D=function(n){return function(t){var r=f.toList(n)(t),o=function(n){return function(t){return 0===t?new f.Cons(f.Nil.value,f.Nil.value):e.bind(f.bindList)(S(n))(function(n){if(n instanceof f.Nil)return s.empty(f.plusList);if(n instanceof f.Cons)return e.bind(f.bindList)(o(n.value1)(t-1))(function(t){return e["return"](f.applicativeList)(new f.Cons(n.value0,t))});throw new Error("Failed pattern match at KanColle.Util line 45, column 1 - line 46, column 1: "+[n.constructor.name])})}};return function(n){return f.fromList(m.unfoldableArray)(o(r)(n))}}};n.sortByThenTakeQuick=w,n.sortByThenTake=v,n.heapSortSafe=b,n.heapSort=C,n.deleteMax=g,n.heapifyDown=y,n.startHeapifyDown=P,n.heapify=h,n.chooseN=D,n.tails=S,n.times=d,n.times1p=p,n.pokeSTArrayUnsafe=t.pokeSTArrayUnsafe,n.peekSTArrayUnsafe=t.peekSTArrayUnsafe}(PS["KanColle.Util"]=PS["KanColle.Util"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Monoid"],r=PS["Data.Array"],o=PS["Data.Array.Unsafe"],u=PS["Data.Foldable"],a=PS["Data.String"],i=(PS["KanColle.SType"],PS["KanColle.Expedition"],PS["KanColle.Expedition.Base"]),c=PS["KanColle.Expedition.Cost"],l=(PS["KanColle.Expedition.Requirement"],PS["KanColle.Util"]),f=PS["Data.Maybe"],s=PS["KanColle.Generated.SType"],m=function(n){return n},p=function(n){var e=r.mapMaybe(function(n){return n.note})(n),u=r["null"](e);if(u)return"<N/A>";if(!u){var i=function(n){return"{"+(o.head(n)+("}x"+t.show(t.showInt)(r.length(n))))},c=t.map(t.functorArray)(i)(r.group(t.eqString)(e));return a.joinWith(", ")(c)}throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 196, column 1 - line 197, column 1: "+[u.constructor.name])},d=function(n){return n},S=new t.Semigroup(function(n){return function(e){return{shipCost:t["<>"](t.semigroupArray)(n.shipCost)(e.shipCost),fleet:t["<>"](t.semigroupArray)(n.fleet)(e.fleet)}}}),v=new e.Monoid(function(){return S},{shipCost:e.mempty(e.monoidArray),fleet:e.mempty(e.monoidArray)}),y=function(n){return{ammo:400,morale:100,stype:n,level:150,drumCount:4,note:f.Nothing.value}},P=function(n){return function(t){return function(e){return{shipCost:[{fuel:t,ammo:e}],fleet:[y(n)]}}}},h=function(n){return function(t){var e={};for(var r in y(n))y(n).hasOwnProperty(r)&&(e[r]=y(n)[r]);return e.note=new f.Just(t),e}},g=function(n){return function(t){return function(e){return function(r){return{shipCost:[{fuel:t,ammo:e}],fleet:[h(n)(r)]}}}}},C=g(s.CT.value)(35)(20)(""),b=function(n){var e=g(s.SS.value)(10)(20)("SS"),r=g(s.SS.value)(10)(10)("");return 1===n?r:t["<>"](S)(r)(l.times(v)(n-1)(e))},w=function(n){return function(e){var o=r.length(e.fleet),u=o>=n;if(u)return e;if(!u)return t["<>"](S)(e)(b(n-o));throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 140, column 1 - line 141, column 1: "+[u.constructor.name])}},D=g(s.AS.value)(35)(10)(""),A=function(n){var t=g(s.DD.value)(15)(15)("(/)");return l.times(v)(n)(t)},M=function(n){var e=g(s.CVL.value)(35)(35)(""),r=g(s.CVL.value)(25)(25)("");return 1===n?r:t["<>"](S)(r)(l.times(v)(n-1)(e))},F=function(n){var e=g(s.CL.value)(25)(20)(""),r=g(s.CL.value)(25)(25)(""),o=2>=n;if(o)return l.times(v)(n)(e);if(!o)return t["<>"](S)(l.times(v)(2)(e))(l.times(v)(n-2)(r));throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 123, column 1 - line 124, column 1: "+[o.constructor.name])},E=function(n){return l.times(v)(n)(g(s.CA.value)(35)(50)("/"))},I=function(n){var t=g(s.BBV.value)(95)(105)("/");return l.times(v)(n)(t)},_=function(n){var e=g(s.AV.value)(35)(35)("/"),r=g(s.AV.value)(50)(10)(""),o=3>=n;if(o)return l.times(v)(n)(e);if(!o)return t["<>"](S)(l.times(v)(3)(e))(r);throw new Error("Failed pattern match at KanColle.Expedition.Minimal line 98, column 1 - line 99, column 1: "+[o.constructor.name])},T=function(n){return 1===n?w(2)(e.mempty(v)):2===n?w(4)(e.mempty(v)):3===n?w(3)(e.mempty(v)):4===n?t["<>"](S)(F(1))(A(2)):5===n?w(4)(t["<>"](S)(F(1))(A(2))):6===n?w(4)(e.mempty(v)):7===n?w(6)(e.mempty(v)):8===n?w(6)(e.mempty(v)):9===n?w(4)(t["<>"](S)(F(1))(A(2))):10===n?w(3)(F(2)):11===n?w(4)(A(2)):12===n?w(4)(A(2)):13===n?w(6)(t["<>"](S)(F(1))(A(4))):14===n?w(6)(t["<>"](S)(F(1))(A(3))):15===n?w(6)(t["<>"](S)(M(2))(A(2))):16===n?w(6)(t["<>"](S)(F(1))(A(2))):17===n?w(6)(t["<>"](S)(F(1))(A(3))):18===n?w(6)(t["<>"](S)(M(3))(A(2))):19===n?w(6)(t["<>"](S)(I(2))(A(2))):20===n?t["<>"](S)(b(1))(F(1)):21===n?t["<>"](S)(F(1))(A(4)):22===n?w(6)(t["<>"](S)(E(1))(t["<>"](S)(F(1))(A(2)))):23===n?w(6)(t["<>"](S)(I(2))(A(2))):24===n?w(6)(t["<>"](S)(F(1))(A(4))):25===n?t["<>"](S)(E(2))(A(2)):26===n?t["<>"](S)(M(1))(t["<>"](S)(F(1))(A(2))):27===n?b(2):28===n?b(3):29===n?b(3):30===n?b(4):31===n?b(4):32===n?t["<>"](S)(C)(A(2)):33===n?A(2):34===n?A(2):35===n?w(6)(t["<>"](S)(M(2))(t["<>"](S)(E(1))(A(1)))):36===n?w(6)(t["<>"](S)(_(2))(t["<>"](S)(F(1))(A(1)))):37===n?t["<>"](S)(F(1))(A(5)):38===n?w(6)(A(5)):39===n?t["<>"](S)(D)(b(4)):40===n?w(6)(t["<>"](S)(F(1))(t["<>"](S)(_(2))(A(2)))):e.mempty(v)},x=function(){var n=function(n){var e=d(T(n)),r=p(e.fleet),o=c.getExpeditionCost(n),i=t.map(t.functorArray)(function(n){return c.calcCost(o)(n)})(e.shipCost),l=u.sum(u.foldableArray)(t.semiringInt)(t.map(t.functorArray)(function(n){return n.fuel})(i)),f=u.sum(u.foldableArray)(t.semiringInt)(t.map(t.functorArray)(function(n){return n.ammo})(i));return a.joinWith(" | ")([t.show(t.showInt)(n),t.show(t.showInt)(l),t.show(t.showInt)(f),r])},e=t.map(t.functorArray)(n)(i.allExpeditionIds),r="Expedition Id | Fuel | Ammo | Minimal Cost Fleet Composition\n --- | --- | --- | ---";return r+("\n"+a.joinWith("\n")(e))}();n.ECost=m,n.minimalCostMarkdownTable=x,n.pprFleetNotes=p,n.getExpeditionMinCost=T,n.fillSS=w,n.katori=C,n.taigei=D,n.clCost=F,n.caCost=E,n.bbvCost=I,n.avCost=_,n.cvlCost=M,n.ssCost=b,n.ddCost=A,n.mkECostWithNote=g,n.mkECost=P,n.shipWithNote=h,n.dummyShip=y,n.getECost=d,n.eCostSemigroup=S,n.eCostMonoid=v}(PS["KanColle.Expedition.Minimal"]=PS["KanColle.Expedition.Minimal"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["Data.Array"],r=(PS["Data.String"],PS["Data.Int"]),o=(PS["Data.Maybe"],PS.Math,PS["Data.Function"]),u=PS["Data.Foldable"],a=PS["KanColle.Expedition.Base"],i=PS["KanColle.Expedition.IncomeBase"],c=PS["KanColle.Expedition.Minimal"],l=PS["KanColle.Expedition.Cost"],f=function(n){return function(t){var e=i.getIncomeBase(t);return n(e.fuel)(e.ammo)(e.steel)(e.bauxite)}},s=function(n){var e=function(e){return t.show(t.showNumber)(r.toNumber(e)/(r.toNumber(l.getExpeditionCost(n.eId).time)/60))},o=i.getIncomeBase(n.netIncome);return"Expedition #"+(t.show(t.showInt)(n.eId)+(": "+(e(o.fuel)+(" | "+(e(o.ammo)+(" | "+(e(o.steel)+(" | "+(e(o.bauxite)+(" | "+t.show(t.showNumber)(n.score)))))))))))},m=function(n){return function(e){return function(r){var o=t[">="](n)(e)(r);if(o)return e;if(!o)return r;throw new Error("Failed pattern match at KanColle.Expedition.Evaluate line 46, column 1 - line 47, column 1: "+[o.constructor.name])}}},p=r.floor,d=function(n){return r.toNumber(n)/60},S=function(n){return function(e){return function(o){var a=i.getIncomeBase(e),c=t.map(t.functorArray)(function(t){return p(r.toNumber(t.fuel)*n.fuel)})(o.shipCost),l=t.map(t.functorArray)(function(t){return p(r.toNumber(t.ammo)*n.ammo)})(o.shipCost);return i.mkIncomeBase({fuel:a.fuel-u.sum(u.foldableArray)(t.semiringInt)(c),ammo:a.ammo-u.sum(u.foldableArray)(t.semiringInt)(l),steel:a.steel,bauxite:a.bauxite})}}},v=function(n){var t=i.getIncomeBase(n.netIncome),e=function(t){return r.toNumber(t)/d(n.time)};return{eId:n.eId,result:[e(t.fuel),e(t.ammo),e(t.steel),e(t.bauxite),n.score]}},y=function(n){return function(e){return function(r){return function(o){return t.compare(n)(e(r))(e(o))}}}},P=function(n){var o=y(t.ordNumber)(function(n){return n.score}),u=function(t){var e=l.getExpeditionCost(t),o=S(e)(i.getExpeditionIncomeBase(t))(c.getExpeditionMinCost(t)),u=r.toNumber(n(o))/d(e.time);return{eId:t,netIncome:o,time:e.time,score:u}},f=t.map(t.functorArray)(u)(a.allExpeditionIds);return e.sortBy(t.flip(o))(f)},h=function(n){return t.map(t.functorArray)(v)(P(f(o.runFn4(n))))},g=function(n){return function(o){return function(u){var f=y(t.ordNumber)(function(n){return n.score}),s=function(e){var a=l.getExpeditionCost(e),f=o*r.toNumber(m(t.ordInt)(0)(a.time-u)),s=m(t.ordInt)(a.time)(u),p=S(a)(i.getExpeditionIncomeBase(e))(c.getExpeditionMinCost(e)),v=r.toNumber(n(p))/d(s),y=v-f;return{eId:e,netIncome:p,time:s,score:y}},p=t.map(t.functorArray)(s)(a.allExpeditionIds);return e.sortBy(t.flip(f))(p)}}},C=function(n){return function(e){return function(r){return t.map(t.functorArray)(v)(g(f(o.runFn4(n)))(e)(r))}}},b=o.mkFn3(C);n.evalNetIncomeWithAfkMinutesJS=b,n["evalNetIncomeWithAfkMinutesJS'"]=C,n.evalNetIncomeHourlyJS=h,n.simpleEvalCost=f,n.evalResultToJS=v,n.showEvalResult=s,n.sortWithAfkTime=g,n.sortByHourlyGain=P,n.comparing=y,n.minToHour=d,n.ordMax=m,n.incomeDiff=S,n.nToFloor=p}(PS["KanColle.Expedition.Evaluate"]=PS["KanColle.Expedition.Evaluate"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["KanColle.Expedition.Base"],r=PS["KanColle.Expedition.IncomeBase"],o=PS["Data.Int"],u=function(n){return function(u){var a=function(){var t=n.landingCraft>=4;if(t)return 4;if(!t)return n.landingCraft;throw new Error("Failed pattern match at KanColle.Expedition.GrossIncome line 47, column 5 - line 54, column 1: "+[t.constructor.name])}(),i=1+.05*o.toNumber(a),c=r.getIncomeBase(u),l=function(){if(n.greatSuccess)return 1.5;if(!n.greatSuccess)return 1;throw new Error("Failed pattern match at KanColle.Expedition.GrossIncome line 37, column 1 - line 38, column 1: "+[n.greatSuccess.constructor.name])}(),f=t[">>>"](t.semigroupoidFn)(o.toNumber)(t[">>>"](t.semigroupoidFn)(function(n){return n*i})(t[">>>"](t.semigroupoidFn)(function(n){return n*l})(o.floor)));return e.mapResourceRows(f)(c)}},a=function(n){return"GrossIncome ("+(t.show(t.showInt)(n.fuel)+(", "+(t.show(t.showInt)(n.ammo)+(", "+(t.show(t.showInt)(n.steel)+(", "+(t.show(t.showInt)(n.bauxite)+")")))))))},i=function(n){return n},c={greatSuccess:!1,landingCraft:0},l=u(c);n.showGrossIncome=a,n.toGrossIncome=l,n.withFactorToGrossIncome=u,n.getGrossIncome=i}(PS["KanColle.Expedition.GrossIncome"]=PS["KanColle.Expedition.GrossIncome"]||{}),function(n){"use strict";n.unsafeToFixed=function(n){return function(t){return function(){return t.toFixed(n)}}}}(PS["Number.Format.Unsafe"]=PS["Number.Format.Unsafe"]||{}),function(n){"use strict";var t=PS["Number.Format.Unsafe"];PS["Control.Monad.Eff"];n.unsafeToFixed=t.unsafeToFixed}(PS["Number.Format.Unsafe"]=PS["Number.Format.Unsafe"]||{}),function(n){"use strict";var t=PS["Control.Monad.Eff"],e=PS["Control.Monad.Eff.Exception"],r=PS["Data.Maybe"],o=PS["Number.Format.Unsafe"],u=PS.Prelude,a=e.catchException(function(n){return u["return"](t.applicativeEff)(u["const"](r.Nothing.value)(n))}),i=function(n){return function(e){return t.runPure(a(u["<$>"](t.functorEff)(r.Just.create)(o.unsafeToFixed(n)(e))))}};n.toFixed=i}(PS["Number.Format"]=PS["Number.Format"]||{}),function(n){"use strict";var t=PS.Prelude,e=PS["KanColle.Expedition.Evaluate"],r=PS["KanColle.Expedition.IncomeBase"],o=PS["KanColle.Expedition.Cost"],u=PS["KanColle.Expedition.Minimal"],a=PS["KanColle.Expedition.Base"],i=(PS["Data.Array"],PS["Data.Maybe"]),c=PS["Data.Monoid"],l=PS["Number.Format"],f=PS["Data.String"],s=PS["Data.Int"],m=PS["Data.Foldable"],p=function(n){var e=r.getIncomeBase(n.netIncome);return f.joinWith(" | ")([t.show(t.showInt)(n.eId),t.show(t.showInt)(e.fuel),t.show(t.showInt)(e.ammo),t.show(t.showInt)(e.steel),t.show(t.showInt)(e.bauxite)])},d=function(n){var e=function(n){return i.fromMaybe("ERR")(l.toFixed(3)(n))};return f.joinWith(" | ")([t.show(t.showInt)(n.eId),e(n.hourly.fuel),e(n.hourly.ammo),e(n.hourly.steel),e(n.hourly.bauxite)])},S=function(){var n=function(n){var t=u.getExpeditionMinCost(n),a=r.getExpeditionIncomeBase(n),i=o.getExpeditionCost(n),c=e.incomeDiff(i)(a)(t);return{eId:n,netIncome:c}};return t.map(t.functorArray)(n)(a.allExpeditionIds)}(),v=function(n){var u=function(u){var a=e.ordMax(t.ordInt)(o.getExpeditionCost(u.eId).time)(n),i=function(n){return s.toNumber(n)/(s.toNumber(a)/60)},c=r.getIncomeBase(u.netIncome);return{eId:u.eId,hourly:{fuel:i(c.fuel),ammo:i(c.ammo),steel:i(c.steel),bauxite:i(c.bauxite)}}};return t.map(t.functorArray)(u)(S)},y=function(n){return function(e){return function(r){return{eIds:m.foldMap(e)(c.monoidArray)(function(n){return[n.eId]})(r),hourly:{fuel:m.sum(e)(t.semiringNumber)(t.map(n)(function(n){return n.hourly.fuel})(r)),ammo:m.sum(e)(t.semiringNumber)(t.map(n)(function(n){return n.hourly.ammo})(r)),steel:m.sum(e)(t.semiringNumber)(t.map(n)(function(n){return n.hourly.steel})(r)),bauxite:m.sum(e)(t.semiringNumber)(t.map(n)(function(n){return n.hourly.bauxite})(r))}}}}};n.showNetHourlyIncome=d,n.netIncomeWithAfkTime=v,n.showNetIncome=p,n.netIncomeTable=S,n.mergeHNetIncome=y}(PS["KanColle.Expedition.NetIncome"]=PS["KanColle.Expedition.NetIncome"]||{}),function(n){"use strict";var t=PS.Prelude,e=(PS["KanColle.Expedition.Evaluate"],PS["KanColle.Expedition.Cost"],PS["KanColle.Expedition.Minimal"],PS["KanColle.Expedition.NetIncome"]),r=(PS["KanColle.Expedition"],PS["Control.Plus"],PS["Data.Array"]),o=PS["Data.List"],u=PS["Data.Foldable"],a=PS["Data.Traversable"],i=PS["Data.Function"],c=PS["Data.String"],l=PS["Number.Format"],f=PS["Data.Maybe"],s=(PS.Math,PS["KanColle.Util"]),m=PS["Control.Monad.Eff.Console"],p=PS["Control.Monad.Eff"],d=function(n){var e=function(n){return f.fromMaybe("ERR")(l.toFixed(3)(n))};return c.joinWith(" | ")([t.show(t.showArray(t.showInt))(n.eIds),e(n.hourly.fuel),e(n.hourly.ammo),e(n.hourly.steel),e(n.hourly.bauxite),e(n.resourceScore)])},S=function(n){return function(a){return function(c){return function(l){return function(m){return function(p){return function(d){var S=function(n){return f.isJust(r.elemIndex(t.eqInt)(n.eId)(d))},v=function(n){var t=n.hourly.fuel*a+n.hourly.ammo*c+n.hourly.steel*l+n.hourly.bauxite*m;return{eIds:n.eIds,hourly:n.hourly,resourceScore:t-0}},y=e.netIncomeWithAfkTime(p),P=r.filter(S)(y),h=t.map(t.functorArray)(function(n){return v(e.mergeHNetIncome(o.functorList)(o.foldableList)(n))})(s.chooseN(u.foldableArray)(P)(n));return r.sortBy(i.on(t.flip(t.compare(t.ordNumber)))(function(n){return n.resourceScore}))(h)}}}}}}},v=i.mkFn7(S),y=S(3),P=i.mkFn6(y),h=function(n){return function(a){return function(c){return function(l){return function(f){return function(m){return function(p){var d=function(n){var t=n.hourly.fuel*c+n.hourly.ammo*l+n.hourly.steel*f+n.hourly.bauxite*m;return{eIds:n.eIds,hourly:n.hourly,resourceScore:t-0*a}},S=t.map(t.functorArray)(function(n){return d(e.mergeHNetIncome(o.functorList)(o.foldableList)(n))})(s.chooseN(u.foldableArray)(e.netIncomeWithAfkTime(p))(n));return r.sortBy(i.on(t.flip(t.compare(t.ordNumber)))(function(n){return n.resourceScore}))(S)}}}}}}},g=h(3),C=function(n){return function(e){return function(o){return function(u){return function(i){return function(c){return function(){return t["void"](p.functorEff)(a.traverse(a.traversableArray)(p.applicativeEff)(t[">>>"](t.semigroupoidFn)(d)(m.log))(r.take(50)(g(c)(n)(e)(o)(u)(i))))(),t["return"](p.applicativeEff)(t.unit)()}}}}}}},b=function(n){return function(t){return function(e){return function(o){return function(u){return r.take(50)(g(0)(n)(t)(e)(o)(u))}}}}},w=i.mkFn5(b);n.calcWithExpeditionIdsFleetCountJS=v,n.calcWithExpeditionIdsJS=P,n.calcWithExpeditionIdsFleetCount=S,n.calcWithExpeditionIds=y,n.quickCalcJS=w,n.quickCalc=b,n.dbg=C,n.showNI=d,n.calcNetIncomeWithFleetCount=h,n.calcNetIncome=g}(PS["KanColle.Expedition.Plan"]=PS["KanColle.Expedition.Plan"]||{}),function(n){"use strict";var t=PS["KanColle.Generated.SType"],e=PS.Prelude,r=PS["Data.Foldable"],o=PS["Data.Maybe"],u=PS["Data.Array"],a=(PS["Data.Monoid"],PS["Data.Nullable"]),i=PS["KanColle.SType"],c=PS["KanColle.Expedition.Base"],l=PS["KanColle.Expedition.Requirement"],f=function(n){var t={};for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t.flagShipTypeOf=a.toNullable(n.flagShipTypeOf),t.levelCount=a.toNullable(n.levelCount),t.drumCount=a.toNullable(n.drumCount),t.drumCarrierCount=a.toNullable(n.drumCarrierCount),t},s=function(n){var r=function(n){return{stypeReqCount:n.stypeReqCount,stypeOneOf:e.map(e.functorArray)(t.showSType)(n.stypeOneOf)}};return{flagShipLevel:n.flagShipLevel,shipCount:n.shipCount,flagShipTypeOf:a.toNullable(e[">>>"](e.semigroupoidFn)(e.map(e.functorArray))(e.map(o.functorMaybe))(t.showSType)(n.flagShipTypeOf)),levelCount:a.toNullable(n.levelCount),drumCount:a.toNullable(n.drumCount),drumCarrierCount:a.toNullable(n.drumCarrierCount),fleetSType:e.map(e.functorArray)(r)(n.fleetSType)}},m={flagShipLevel:1,shipCount:1,flagShipTypeOf:o.Nothing.value,levelCount:o.Nothing.value,drumCount:o.Nothing.value,drumCarrierCount:o.Nothing.value,fleetSType:[]},p=function(){var n=function(n){return function(t){if(t instanceof l.Flagship){if(t.value0 instanceof l.ShipLevel){var e={};for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e.flagShipLevel=t.value0.value0,e}if(t.value0 instanceof l.ShipTypeOneOf){var a={};for(var i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);return a.flagShipTypeOf=new o.Just(t.value0.value0),a}throw new Error("Failed pattern match at KanColle.Expedition.RequirementObject line 71, column 5 - line 86, column 1: "+[t.value0.constructor.name])}if(t instanceof l.FleetLevel){var c={};for(var f in n)n.hasOwnProperty(f)&&(c[f]=n[f]);return c.levelCount=new o.Just(t.value0),c}if(t instanceof l.FleetDrum){var s={};for(var m in n)n.hasOwnProperty(m)&&(s[m]=n[m]);return s.drumCount=new o.Just(t.value0),s}if(t instanceof l.FleetShipWithDrum){var p={};for(var d in n)n.hasOwnProperty(d)&&(p[d]=n[d]);return p.drumCarrierCount=new o.Just(t.value0),p}if(t instanceof l.FleetSTypeCount){var S={stypeReqCount:t.value0,stypeOneOf:t.value1},v={};for(var y in n)n.hasOwnProperty(y)&&(v[y]=n[y]);return v.fleetSType=u.snoc(n.fleetSType)(S),v}if(t instanceof l.FleetShipCount){var P={};for(var h in n)n.hasOwnProperty(h)&&(P[h]=n[h]);return P.shipCount=t.value0,P}throw new Error("Failed pattern match at KanColle.Expedition.RequirementObject line 71, column 5 - line 86, column 1: "+[t.constructor.name])}};return r.foldl(r.foldableArray)(n)(m)}(),d=function(n){return p(l.getExpeditionRequirement(n))},S=function(n){return s(d(n))},v=function(n){return function(t){var a=function(n){return function(t){return u.length(u.filter(n)(t))}},c=function(n){return r.any(r.foldableArray)(e.booleanAlgebraBoolean)(i.eqSType(n))},l=u.uncons(t);if(l instanceof o.Just){var f=l.value0.head.level>=n.flagShipLevel;return{flagShipLevel:f,shipCount:u.length(t)>=n.shipCount,flagShipTypeOf:e.map(o.functorMaybe)(c(l.value0.head.stype))(n.flagShipTypeOf),levelCount:e.map(o.functorMaybe)(function(n){return r.sum(r.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.level})(t))>=n})(n.levelCount),drumCount:e.map(o.functorMaybe)(function(n){return r.sum(r.foldableArray)(e.semiringInt)(e.map(e.functorArray)(function(n){return n.drumCount})(t))>=n})(n.drumCount),drumCarrierCount:e.map(o.functorMaybe)(function(n){return a(function(n){return n.drumCount>0})(t)>=n})(n.drumCarrierCount),fleetSType:e.map(e.functorArray)(function(n){return a(function(t){return c(t.stype)(n.stypeOneOf)})(t)>=n.stypeReqCount})(n.fleetSType)}}if(l instanceof o.Nothing){var s=function(n){return e.map(n)(e["const"](!1))};return{flagShipLevel:!1,shipCount:!1,flagShipTypeOf:s(o.functorMaybe)(n.flagShipTypeOf),levelCount:s(o.functorMaybe)(n.levelCount),drumCount:s(o.functorMaybe)(n.drumCount),drumCarrierCount:s(o.functorMaybe)(n.drumCarrierCount),fleetSType:s(e.functorArray)(n.fleetSType)}}throw new Error("Failed pattern match at KanColle.Expedition.RequirementObject line 116, column 1 - line 117, column 1: "+[l.constructor.name])}},y=function(){var n=function(n){return{id:n,val:S(n)}};return e.map(e.functorArray)(n)(c.allExpeditionIds)}();n.resultPackToObject=f,n.checkWithRequirementPack=v,n.getExpeditionRequirementObject=S,n.getExpeditionRequirementPack=d,n.allRequirements=y,n.requirementPackToObj=s,n.fromExpeditionRequirement=p,n.dummyRequirementPack=m}(PS["KanColle.Expedition.RequirementObject"]=PS["KanColle.Expedition.RequirementObject"]||{}),function(n){"use strict";var t=PS["KanColle.Generated.SType"],e=(PS.Prelude,PS.Math),r=PS["Data.Int"],o=(PS["KanColle.SType"],PS["Data.Maybe"],PS["Data.Function"]),u=function(n){if(n instanceof t.SS)return.5;if(n instanceof t.DD)return 1;if(n instanceof t.CL)return 1;if(n instanceof t.CLT)return 1;if(n instanceof t.CT)return 1;if(n instanceof t.AV)return 1;if(n instanceof t.SSV)return 1;if(n instanceof t.LHA)return 1;if(n instanceof t.AO)return 1;if(n instanceof t.CA)return 1.5;if(n instanceof t.CAV)return 1.5;if(n instanceof t.FBB)return 1.5;if(n instanceof t.CVL)return 1.5;if(n instanceof t.AS)return 1.5;if(n instanceof t.BB)return 2;if(n instanceof t.BBV)return 2;if(n instanceof t.CV)return 2;if(n instanceof t.CVB)return 2;if(n instanceof t.AR)return 2;if(n instanceof t.DDE)return 1;if(n instanceof t.XBB)return 2;if(n instanceof t.AP)return 2;if(n instanceof t.Unknown)return 1;throw new Error("Failed pattern match at KanColle.RepairTime line 46, column 1 - line 47, column 1: "+[n.constructor.name])},a=function(n){return function(t){return function(o){return function(a){if(o===a)return 0;var i=a-o,c=function(){var o=11>=t;if(o)return r.toNumber(10*t|0)*u(n)*r.toNumber(i);if(!o){var a=(10*r.floor(e.sqrt(r.toNumber(t-11)))|0)+50|0;return r.toNumber((5*t|0)+a|0)*u(n)*r.toNumber(i)}throw new Error("Failed pattern match at KanColle.RepairTime line 10, column 1 - line 11, column 1: "+[o.constructor.name])}();return r.floor(c)+30|0}}}},i=o.mkFn4(function(n){return a(t.readSType(n))}),c=o.mkFn4(function(n){return a(t.fromInt(n))}),l=function(n){return function(t){return function(e){return function(o){var u=1200,i=u*(o-e)|0,c=a(n)(t)(e)(o),l=r.ceil(r.toNumber(c)/r.toNumber(u))*u|0,f=l>=i;if(f)return i;if(!f)return l;throw new Error("Failed pattern match at KanColle.RepairTime line 29, column 1 - line 30, column 1: "+[f.constructor.name])}}}},f=o.mkFn4(function(n){return l(t.readSType(n))}),s=o.mkFn4(function(n){return l(t.fromInt(n))});n.stypeFactor=u,n.facilityInSecJSNum=s,n.facilityInSecJS=f,n.facilityInSec=l,n.dockingInSecJSNum=c,n.dockingInSecJS=i,n.dockingInSec=a}(PS["KanColle.RepairTime"]=PS["KanColle.RepairTime"]||{});
